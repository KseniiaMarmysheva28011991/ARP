Id,TaskNo,ResponseId,Difficulty,Optimized query,avg_rows_optimized,Initial Query,avg_rows_initial,avg_rows_diff_deepseek_initial,Queries equal with order on test dataset,Queries equil without order on test dataset,ORDER BY clause in initial query,ORDER BY clause in optimazed query,Leetcode equivalence status,Final equivalence status,Status,Comment
1,175,3,Easy,"SELECT firstname, lastname, address.city, address.state FROM schema_175.person LEFT JOIN schema_175.address USING (personid);",136887,"select firstname, lastname, address.city, address.state from schema_175.person left outer join schema_175.address on person.personid = address.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
2,175,5,Easy,"SELECT firstname, lastname, city, state FROM schema_175.person LEFT JOIN schema_175.address USING (personid)",136887,"select firstname, lastname, city, state from schema_175.person left outer join schema_175.address on person.personid = address.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
3,175,8,Easy,"SELECT firstname, lastname, city, state FROM schema_175.person p LEFT JOIN schema_175.address a ON p.personid = a.personid",136887,"select firstname, lastname, city, state from schema_175.person as p left outer join schema_175.address as a on p.personid = a.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
4,175,11,Easy,"SELECT firstname, lastname, city, state FROM schema_175.person LEFT JOIN schema_175.address USING (personid)",136887,"select firstname, lastname, city, state from schema_175.person left outer join schema_175.address on address.personid = person.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
5,175,25,Easy,"SELECT firstname, lastname, city, state FROM schema_175.person t1 LEFT JOIN schema_175.address t2 ON t1.personid = t2.personid",136887,"select firstname, lastname, city, state from schema_175.person as t1 left outer join schema_175.address as t2 on t1.personid = t2.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
6,175,26,Easy,"SELECT a.firstname, a.lastname, b.city, b.state 
FROM schema_175.person a 
LEFT JOIN schema_175.address b ON a.personid = b.personid;",136887,"select firstname, lastname, city, state from schema_175.person as a left outer join schema_175.address as b on a.personid = b.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
7,175,47,Easy,"SELECT p.firstname, p.lastname, a.city, a.state 
FROM schema_175.person p 
LEFT JOIN schema_175.address a USING (personid);",136887,"select p.firstname, p.lastname, a.city, a.state from schema_175.person as p left outer join schema_175.address as a on p.personid = a.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
8,175,49,Easy,"SELECT p.firstname, p.lastname, a.city, a.state 
FROM schema_175.person p 
LEFT JOIN schema_175.address a ON p.personid = a.personid",136887,"select p.firstname, p.lastname, a.city, a.state from schema_175.address as a right outer join schema_175.person as p on a.personid = p.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
9,175,56,Easy,"SELECT person.firstname, person.lastname, address.city, address.state 
FROM schema_175.person 
LEFT OUTER JOIN schema_175.address ON person.personid = address.personid",136887,"select person.firstname, person.lastname, address.city, address.state from schema_175.person left outer join schema_175.address on person.personid = address.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
10,175,57,Easy,"SELECT p.firstname, p.lastname, a.city, a.state 
FROM schema_175.person p 
LEFT JOIN schema_175.address a ON p.personid = a.personid",136887,"select person.firstname as firstname, person.lastname as lastname, address.city as city, address.state as state from schema_175.person left outer join schema_175.address on person.personid = address.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
11,175,58,Easy,"SELECT person.firstname, person.lastname, address.city, address.state 
FROM schema_175.person 
LEFT JOIN schema_175.address ON person.personid = address.personid;",136887,"select person.firstname, person.lastname, address.city, address.state from schema_175.address right outer join schema_175.person on person.personid = address.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
12,175,69,Easy,"SELECT a.firstname, a.lastname, b.city, b.state 
FROM schema_175.person a 
LEFT JOIN schema_175.address b ON a.personid = b.personid",136887,"select a.firstname, a.lastname, b.city, b.state from schema_175.person as a left outer join schema_175.address as b on a.personid = b.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
13,175,79,Easy,"SELECT p.firstname, p.lastname, address.city, address.state 
FROM schema_175.person AS p 
LEFT OUTER JOIN schema_175.address ON p.personid = address.personid",136887,"select p.firstname, p.lastname, address.city, address.state from schema_175.person as p left outer join schema_175.address on p.personid = address.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
14,175,82,Easy,"SELECT p.firstname, p.lastname, a.city, a.state 
FROM schema_175.person p 
LEFT JOIN schema_175.address a ON a.personid = p.personid",136887,"select p.firstname, p.lastname, a.city, a.state from schema_175.person as p left outer join schema_175.address as a on a.personid = p.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
15,175,91,Easy,"SELECT p.lastname, p.firstname, a.city, a.state 
FROM schema_175.person p 
LEFT JOIN schema_175.address a USING (personid)",136887,"select p.lastname, p.firstname, a.city, a.state from schema_175.person as p left outer join schema_175.address as a on p.personid = a.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
16,175,96,Easy,"SELECT firstname, lastname, city, state FROM schema_175.person LEFT JOIN schema_175.address ON person.personid = address.personid;",136887,"select firstname, lastname, city, state from schema_175.address right outer join schema_175.person on person.personid = address.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
17,175,114,Easy,"SELECT p.firstname, p.lastname, a.city, a.state 
FROM schema_175.person p 
LEFT JOIN schema_175.address a ON p.personid = a.personid",136887,"select firstname, lastname, city, state from schema_175.person as p left outer join schema_175.address as a on (1 = 1 and p.personid = a.personid)",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
18,175,137,Easy,"SELECT firstname, lastname, city, state FROM schema_175.person p LEFT JOIN schema_175.address a USING (personid)",136887,"select firstname, lastname, city, state from schema_175.person as p left outer join schema_175.address as a on a.personid = p.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
19,175,141,Easy,"SELECT firstname, lastname, city, state FROM schema_175.person p LEFT JOIN schema_175.address ad ON p.personid = ad.personid",136887,"select firstname, lastname, city, state from schema_175.person as p left outer join schema_175.address as ad on p.personid = ad.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
20,175,142,Easy,"SELECT b.firstname, b.lastname, a.city, a.state FROM schema_175.person b LEFT JOIN schema_175.address a ON b.personid = a.personid;",136887,"select firstname, lastname, city, state from schema_175.address as a right outer join schema_175.person as b on a.personid = b.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
21,175,162,Easy,"SELECT person.firstname, person.lastname, address.city, address.state 
FROM schema_175.person 
LEFT JOIN schema_175.address ON person.personid = address.personid",136887,"select person.firstname, person.lastname, address.city, address.state from schema_175.address right outer join schema_175.person on address.personid = person.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
22,175,164,Easy,"SELECT person.firstname, person.lastname, address.city, address.state 
FROM schema_175.person 
LEFT JOIN schema_175.address USING (personid);",136887,"select person.firstname, person.lastname, address.city, address.state from schema_175.person left outer join schema_175.address on address.personid = person.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
23,175,184,Easy,"SELECT city, firstname, lastname, state 
FROM schema_175.address 
RIGHT OUTER JOIN schema_175.person ON address.personid = person.personid",136887,"select city, firstname, lastname, state from schema_175.person left outer join schema_175.address on person.personid = address.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
24,175,186,Easy,"SELECT p.firstname, p.lastname, a.city, a.state 
FROM schema_175.person p 
LEFT JOIN schema_175.address a ON a.personid = p.personid",136887,"select firstname, lastname, a.city as city, a.state as state from schema_175.person as p left outer join schema_175.address as a on a.personid = p.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
25,175,195,Easy,"SELECT p.firstname, p.lastname, a.city, a.state 
FROM schema_175.person p 
LEFT JOIN schema_175.address a USING (personid)",136887,"select p.firstname, p.lastname, city, state from schema_175.person as p left outer join schema_175.address as a on p.personid = a.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
26,175,197,Easy,"SELECT p.firstname, p.lastname, a.city, a.state 
FROM schema_175.person p 
LEFT JOIN schema_175.address a USING (personid)",136887,"select p.firstname as firstname, p.lastname as lastname, a.city as city, a.state as state from schema_175.person as p left outer join schema_175.address as a on p.personid = a.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
27,175,219,Easy,"SELECT p.firstname, p.lastname, e.city, e.state 
FROM schema_175.person p 
LEFT JOIN schema_175.address e USING (personid);",136887,"select p.firstname, p.lastname, e.city, e.state from schema_175.person as p left outer join schema_175.address as e on p.personid = e.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
28,175,225,Easy,"SELECT person.firstname, person.lastname, address.city, address.state 
FROM schema_175.person 
LEFT OUTER JOIN (
    SELECT DISTINCT ON (personid) personid, city, state 
    FROM schema_175.address
) address ON person.personid = address.personid 
ORDER BY person.personid",100000,"select person.firstname, person.lastname, address.city, address.state from schema_175.person left outer join schema_175.address on person.personid = address.personid order by person.personid",136887,-36887,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,Non-equivalent queries,"These two queries may return different results if multiple address records exist for the same person. The initial query returns all matching addresses, while the optimized uses DISTINCT ON to return only one address per person, which may vary depending on the internal row order unless explicitly ordered."
29,175,226,Easy,"SELECT t1.firstname, t1.lastname, t2.city, t2.state 
FROM schema_175.person t1 
LEFT JOIN schema_175.address t2 ON t1.personid = t2.personid",136887,"select t1.firstname, t1.lastname, t2.city, t2.state from schema_175.person as t1 left outer join schema_175.address as t2 on t1.personid = t2.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
30,175,228,Easy,"SELECT x.firstname, x.lastname, y.city, y.state 
FROM schema_175.person x 
LEFT JOIN schema_175.address y ON x.personid = y.personid;",136887,"select x.firstname, x.lastname, y.city, y.state from schema_175.person as x left outer join schema_175.address as y on x.personid = y.personid",136887,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
33,178,113,Medium,"SELECT 
    a.score, 
    (SELECT COUNT(DISTINCT b.score) + 1 
     FROM schema_178.scores b 
     WHERE b.score > a.score) AS rank 
FROM schema_178.scores a 
ORDER BY rank",100000,"select a.score, b.count as rank from schema_178.scores as a left outer join (select t1.score, count(distinct t2.score) as count from schema_178.scores as t1 left outer join schema_178.scores as t2 on t2.score >= t1.score group by t1.score) as b on a.score = b.score order by b.count",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
40,178,237,Medium,"SELECT 
    score,
    DENSE_RANK() OVER (ORDER BY score DESC) AS rank
FROM 
    schema_178.scores",100000,"select s1.score as score, count(distinct s2.score) as rank from schema_178.scores as s1 join schema_178.scores as s2 on s1.score <= s2.score group by s1.id, s1.score order by s1.score desc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
43,178,326,Medium,"SELECT 
    s.score, 
    (SELECT COUNT(DISTINCT s2.score) FROM schema_178.scores s2 WHERE s2.score >= s.score) AS rank 
FROM 
    schema_178.scores s 
ORDER BY 
    s.score DESC;",100000,"select s.score, count(distinct s2.score) as rank from schema_178.scores as s join schema_178.scores as s2 on s2.score >= s.score group by s.id, s.score order by s.score desc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
44,178,334,Medium,"SELECT 
    s1.score, 
    (SELECT COUNT(DISTINCT s2.score) 
     FROM schema_178.scores s2 
     WHERE s2.score >= s1.score) AS rank 
FROM schema_178.scores s1 
ORDER BY s1.score DESC, s1.id",100000,"select s1.score, count(distinct s2.score) as rank from schema_178.scores as s1 join schema_178.scores as s2 on s1.score <= s2.score group by s1.id, s1.score order by s1.score desc, s1.id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
46,181,1,Easy,"SELECT a.name AS employee 
FROM schema_181.employee a 
JOIN schema_181.employee b ON a.managerid = b.id AND a.salary > b.salary;",49842,select a.name as employee from schema_181.employee as a join schema_181.employee as b on a.managerid = b.id where a.salary > b.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
47,181,4,Easy,"SELECT a.name AS employee 
FROM schema_181.employee a 
JOIN schema_181.employee b ON a.managerid = b.id 
WHERE a.salary > b.salary;",49842,select a.name as employee from schema_181.employee as a join schema_181.employee as b on (a.managerid = b.id and a.salary > b.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
48,181,11,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee b ON e.managerid = b.id AND e.salary > b.salary;",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as b on e.managerid = b.id where e.salary > b.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
49,181,12,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee m ON e.managerid = m.id AND e.salary > m.salary;",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as m on e.managerid = m.id where e.salary > m.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
50,181,19,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id 
WHERE e1.salary > e2.salary",49842,select e1.name as employee from schema_181.employee as e1 join schema_181.employee as e2 on (e1.managerid = e2.id and e1.salary > e2.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
51,181,22,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id AND e1.salary > e2.salary",49842,select e1.name as employee from schema_181.employee as e1 join schema_181.employee as e2 on e1.managerid = e2.id where e1.salary > e2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
52,181,26,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id 
WHERE e1.salary > e2.salary",49842,select e1.name as employee from schema_181.employee as e1 join schema_181.employee as e2 on (e2.id = e1.managerid and e1.salary > e2.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
53,181,28,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id AND e1.salary > e2.salary",49842,select e1.name as employee from schema_181.employee as e1 left outer join schema_181.employee as e2 on e1.managerid = e2.id where e1.salary > e2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
54,181,29,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id 
WHERE e1.salary > e2.salary",49842,select e1.name as employee from schema_181.employee as e1 right outer join schema_181.employee as e2 on e1.managerid = e2.id where e1.salary > e2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
55,181,31,Easy,"SELECT e2.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e2.managerid = e1.id 
WHERE e2.salary > e1.salary",49842,select e2.name as employee from schema_181.employee as e1 join schema_181.employee as e2 on (e2.managerid = e1.id and e2.salary > e1.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
56,181,33,Easy,"SELECT e2.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e2.managerid = e1.id AND e1.salary < e2.salary",49842,select e2.name as employee from schema_181.employee as e1 join schema_181.employee as e2 on e2.managerid = e1.id where e1.salary < e2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
57,181,35,Easy,"SELECT emp1.name AS employee 
FROM schema_181.employee emp1 
JOIN schema_181.employee emp2 ON emp1.managerid = emp2.id AND emp1.salary > emp2.salary",49842,select emp1.name as employee from schema_181.employee as emp1 join schema_181.employee as emp2 on emp1.managerid = emp2.id where emp1.salary > emp2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
58,181,37,Easy,"SELECT e1.name AS employee
FROM schema_181.employee e1
JOIN schema_181.employee e2 ON e1.managerid = e2.id AND e1.salary > e2.salary;",49842,"select employee from (select e1.id, e1.name as employee, e1.salary, e2.name as managername, e2.salary as managersalary from schema_181.employee as e1 left outer join schema_181.employee as e2 on e1.managerid = e2.id) as new_tab where salary > managersalary",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
59,181,38,Easy,"SELECT employee.name AS employee 
FROM schema_181.employee 
JOIN schema_181.employee AS managers ON employee.managerid = managers.id AND employee.salary > managers.salary",49842,select employee.name as employee from schema_181.employee join schema_181.employee as managers on employee.managerid = managers.id where employee.salary > managers.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
60,181,39,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee m ON e.managerid = m.id AND e.salary > m.salary",49842,select employee.name as employee from schema_181.employee join schema_181.employee as manager on employee.managerid = manager.id where employee.salary > manager.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
61,181,40,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee m ON m.id = e.managerid AND e.salary > m.salary",49842,select employee.name as employee from schema_181.employee join schema_181.employee as manager on manager.id = employee.managerid where employee.salary > manager.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
62,181,42,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id AND e1.salary > e2.salary",49842,select employee.name as employee from schema_181.employee join schema_181.employee as e on employee.managerid = e.id where employee.salary > e.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
63,181,45,Easy,"SELECT a.name AS employee
FROM schema_181.employee a
JOIN schema_181.employee b ON a.managerid = b.id AND a.salary > b.salary;",49842,"select employee_name as employee from (select a.name as employee_name, a.salary as employee_salary, b.salary as manager_salary from schema_181.employee as a left outer join schema_181.employee as b on a.managerid = b.id) as sub where employee_salary > manager_salary",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
64,181,50,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id 
WHERE e2.salary < e1.salary;",49842,"select name as employee from schema_181.employee join (select id, salary as m_sal from schema_181.employee) as t2 on employee.managerid = t2.id where m_sal < salary",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
65,181,54,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id 
WHERE e1.salary > e2.salary",49842,"select name as employee from schema_181.employee as e1 left outer join (select id, salary as m_salary from schema_181.employee) as e2 on e1.managerid = e2.id where salary > m_salary",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
66,181,56,Easy,"SELECT a.name AS employee 
FROM schema_181.employee a 
JOIN schema_181.employee b ON a.managerid = b.id AND a.salary > b.salary",49842,"select name as employee from schema_181.employee as a left outer join (select id, salary as msalary from schema_181.employee) as b on a.managerid = b.id where a.salary > b.msalary",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
67,181,66,Easy,"SELECT t1.name AS employee 
FROM schema_181.employee t1 
JOIN schema_181.employee t2 ON t1.managerid = t2.id AND t1.salary > t2.salary",49842,select t1.name as employee from schema_181.employee as t1 join schema_181.employee as t2 on t1.managerid = t2.id where t1.salary > t2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
68,181,67,Easy,"SELECT x.name AS employee 
FROM schema_181.employee x 
JOIN schema_181.employee y ON x.managerid = y.id AND x.salary > y.salary;",49842,select x.name as employee from schema_181.employee as x join schema_181.employee as y on x.managerid = y.id where x.salary > y.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
69,181,73,Easy,"SELECT a.name AS employee 
FROM schema_181.employee AS a 
JOIN schema_181.employee AS b ON a.managerid = b.id AND a.salary > b.salary",49842,select a.name as employee from schema_181.employee as a join schema_181.employee as b on (a.salary > b.salary and a.managerid = b.id),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
70,181,82,Easy,"SELECT a.name AS employee 
FROM schema_181.employee a 
JOIN schema_181.employee b ON a.managerid = b.id AND a.salary > b.salary;",49842,select a.name as employee from schema_181.employee as a left outer join schema_181.employee as b on a.managerid = b.id where a.salary > b.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
71,181,121,Easy,"SELECT b.name AS employee 
FROM schema_181.employee AS a 
INNER JOIN schema_181.employee AS b ON a.id = b.managerid AND a.salary < b.salary",49842,select b.name as employee from schema_181.employee as a left outer join schema_181.employee as b on a.id = b.managerid where a.salary < b.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
72,181,131,Easy,"SELECT e.name AS employee 
FROM schema_181.employee AS e 
INNER JOIN schema_181.employee AS m ON e.managerid = m.id AND e.salary > m.salary",49842,select e.name as employee from schema_181.employee as e left outer join schema_181.employee as m on e.managerid = m.id where e.salary > m.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
73,181,139,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee e2 ON e.managerid = e2.id AND e.salary > e2.salary;",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as e2 on e.managerid = e2.id where e.salary > e2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
74,181,140,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee m ON m.id = e.managerid AND m.salary < e.salary",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as m on m.id = e.managerid where m.salary < e.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
75,181,147,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
INNER JOIN schema_181.employee e2 ON e.managerid = e2.id 
WHERE e.salary > e2.salary",49842,select e.name as employee from schema_181.employee as e left outer join schema_181.employee as e2 on e2.id = e.managerid where e.salary > e2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
76,181,149,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e2.id = e1.managerid AND e1.salary > e2.salary",49842,select e1.name as employee from schema_181.employee as e1 join schema_181.employee as e2 on e2.id = e1.managerid where e1.salary > e2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
77,181,166,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e2.id = e1.managerid AND e1.salary > e2.salary",49842,"select e1.name as employee from schema_181.employee as e1 left outer join (select id, salary, managerid from schema_181.employee) as e2 on e2.id = e1.managerid where e1.salary > e2.salary",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
78,181,169,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e2.id = e1.managerid AND e1.salary > e2.salary",49842,select e1.name as employee from schema_181.employee as e1 left outer join schema_181.employee as e2 on e2.id = e1.managerid where e1.salary > e2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
79,181,173,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id AND e1.salary > e2.salary",49842,select e1.name as employee from schema_181.employee as e1 join schema_181.employee as e2 on e1.managerid = e2.id where (e1.managerid = e2.id and e1.salary > e2.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
80,181,196,Easy,"SELECT emp.name AS employee 
FROM schema_181.employee emp 
JOIN schema_181.employee man ON emp.managerid = man.id AND emp.salary > man.salary",49842,select emp.name as employee from schema_181.employee as emp join schema_181.employee as man on emp.managerid = man.id where emp.salary > man.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
81,181,200,Easy,"SELECT emp.name AS employee 
FROM schema_181.employee emp 
JOIN schema_181.employee mgr ON emp.managerid = mgr.id AND emp.salary > mgr.salary",49842,select emp.name as employee from schema_181.employee as emp join schema_181.employee as mgr on emp.managerid = mgr.id where emp.salary > mgr.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
82,181,204,Easy,"SELECT employee.name AS employee 
FROM schema_181.employee AS employee 
JOIN schema_181.employee AS manager ON employee.managerid = manager.id 
WHERE employee.salary > manager.salary",49842,select employee.name as employee from schema_181.employee as employee join schema_181.employee as manager on (employee.managerid = manager.id and employee.salary > manager.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
83,181,206,Easy,"SELECT f.name AS employee 
FROM schema_181.employee AS e 
JOIN schema_181.employee AS f ON e.id = f.managerid AND f.salary > e.salary",49842,select f.name as employee from schema_181.employee as e join schema_181.employee as f on e.id = f.managerid where f.salary > e.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
84,181,207,Easy,"SELECT f1.name AS employee 
FROM schema_181.employee AS f1 
JOIN schema_181.employee AS f2 ON f1.managerid = f2.id AND f1.salary > f2.salary",49842,select f1.name as employee from schema_181.employee as f1 join schema_181.employee as f2 on f1.managerid = f2.id where f1.salary > f2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
85,181,212,Easy,"SELECT t1.name AS employee 
FROM schema_181.employee t1 
JOIN schema_181.employee t2 ON t1.managerid = t2.id 
WHERE t1.salary > t2.salary;",49842,select t1.name as employee from schema_181.employee as t1 join schema_181.employee as t2 on (t1.managerid = t2.id and t1.salary > t2.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
86,181,214,Easy,"SELECT t1.name AS employee 
FROM schema_181.employee AS t1 
JOIN schema_181.employee AS t2 ON t1.managerid = t2.id 
WHERE t1.salary > t2.salary",49842,select t1.name as employee from schema_181.employee as t1 left outer join schema_181.employee as t2 on t1.managerid = t2.id where t1.salary > t2.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
87,181,219,Easy,"SELECT te.name AS employee 
FROM schema_181.employee te 
JOIN schema_181.employee tm ON te.managerid = tm.id AND tm.salary < te.salary",49842,select te.name as employee from schema_181.employee as te join schema_181.employee as tm on te.managerid = tm.id where tm.salary < te.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
88,181,226,Easy,"SELECT e.name AS employee
FROM schema_181.employee e
JOIN schema_181.employee a ON e.managerid = a.id AND e.salary > a.salary",49842,"select employee from (select e.name as employee, e.salary as salary, a.name as manager, a.salary as managersalary from schema_181.employee as e join schema_181.employee as a on e.managerid = a.id) as x where salary > managersalary",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
89,181,239,Easy,"SELECT b.name AS employee 
FROM schema_181.employee AS a 
JOIN schema_181.employee AS b ON b.managerid = a.id AND b.salary > a.salary",49842,select b.name as employee from schema_181.employee as a join schema_181.employee as b on b.managerid = a.id where b.salary > a.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
90,181,242,Easy,"SELECT e.name AS employee 
FROM schema_181.employee AS e 
JOIN schema_181.employee AS f ON e.managerid = f.id 
WHERE e.salary > f.salary",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as f on (e.managerid = f.id and e.salary > f.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
91,181,245,Easy,"SELECT e.name AS employee 
FROM schema_181.employee AS e 
JOIN schema_181.employee AS f ON e.managerid = f.id AND e.salary > f.salary",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as f on e.managerid = f.id where e.salary > f.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
92,181,261,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee f ON e.managerid = f.id AND e.salary > f.salary;",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as f on (e.salary > f.salary and e.managerid = f.id),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
93,181,264,Easy,"SELECT e.name AS employee 
FROM schema_181.employee AS e 
JOIN schema_181.employee AS m ON e.managerid = m.id 
WHERE e.salary > m.salary",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as m on (e.managerid = m.id and e.salary > m.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
94,181,272,Easy,"SELECT e2.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.id = e2.managerid AND e2.salary > e1.salary",49842,select e2.name as employee from schema_181.employee as e1 left outer join schema_181.employee as e2 on e1.id = e2.managerid where e2.salary > e1.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
95,181,273,Easy,"SELECT e.name AS employee
FROM schema_181.employee e
JOIN schema_181.employee m ON e.managerid = m.id AND e.salary > m.salary;",49842,"select employee from (select e.name as employee, e.salary as salary, m.name as manager_name, m.salary as manager_salary from schema_181.employee as e left outer join schema_181.employee as m on e.managerid = m.id) as temp where salary > manager_salary",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
96,181,280,Easy,"SELECT e.name AS employee
FROM schema_181.employee e
JOIN schema_181.employee m ON e.managerid = m.id
WHERE e.salary > m.salary;",49842,"select name as employee from schema_181.employee join (select distinct e1.id as manid, e1.salary as mansalary from schema_181.employee as e1 join schema_181.employee as e2 on e1.id = e2.managerid) as manager on employee.managerid = manager.manid where employee.salary > manager.mansalary",49842,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
97,181,289,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee m ON e.managerid = m.id 
WHERE e.salary > m.salary",49842,"select x.employeename as employee from (select e.name as employeename, e.salary as employeesalary, m.salary as managersalary from schema_181.employee as e left outer join schema_181.employee as m on e.managerid = m.id) as x where x.employeesalary > x.managersalary",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
98,181,294,Easy,"SELECT a.name AS employee 
FROM schema_181.employee a 
JOIN schema_181.employee b ON b.id = a.managerid AND a.salary > b.salary;",49842,select a.name as employee from schema_181.employee as a join schema_181.employee as b on b.id = a.managerid where a.salary > b.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
99,181,316,Easy,"SELECT a.name AS employee 
FROM schema_181.employee AS a 
JOIN schema_181.employee AS b ON b.id = a.managerid 
WHERE b.salary < a.salary",49842,select a.name as employee from schema_181.employee as a join schema_181.employee as b on (b.id = a.managerid and b.salary < a.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
100,181,329,Easy,"SELECT a.name AS employee 
FROM schema_181.employee a 
JOIN schema_181.employee b ON a.managerid = b.id AND a.salary > b.salary",49842,"select a.name as employee from (select a.id, a.name, a.salary, a.managerid, b.salary as managersalary from schema_181.employee as a join schema_181.employee as b on a.managerid = b.id where a.salary > b.salary) as a",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
101,181,339,Easy,"SELECT a.name AS employee 
FROM schema_181.employee a 
JOIN schema_181.employee b ON a.managerid = b.id AND b.salary < a.salary",49842,select a.name as employee from schema_181.employee as a join schema_181.employee as b on a.managerid = b.id where b.salary < a.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
102,181,346,Easy,"SELECT ang.name AS employee 
FROM schema_181.employee AS ang 
JOIN schema_181.employee AS mng ON ang.managerid = mng.id AND ang.salary > mng.salary",49842,select ang.name as employee from schema_181.employee as ang join schema_181.employee as mng on ang.managerid = mng.id where ang.salary > mng.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
103,181,350,Easy,"SELECT c.name AS employee 
FROM schema_181.employee c 
JOIN schema_181.employee d ON d.id = c.managerid AND c.salary > d.salary;",49842,select c.name as employee from schema_181.employee as c join schema_181.employee as d on d.id = c.managerid where c.salary > d.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
104,181,355,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee ee ON e.managerid = ee.id AND e.salary > ee.salary",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as ee on e.managerid = ee.id where e.salary > ee.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
105,181,359,Easy,"SELECT e.name AS employee 
FROM schema_181.employee AS e 
JOIN schema_181.employee AS m ON m.id = e.managerid AND m.salary < e.salary",49842,select e.name as employee from schema_181.employee as e left outer join schema_181.employee as m on m.id = e.managerid where m.salary < e.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
106,181,367,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee m ON m.id = e.managerid AND e.salary > m.salary",49842,select e.name as employee from schema_181.employee as e right outer join schema_181.employee as m on m.id = e.managerid where e.salary > m.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
107,181,370,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee e1 ON e.managerid = e1.id AND e.salary > e1.salary",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as e1 on e.managerid = e1.id where e.salary > e1.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
108,181,372,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee m ON e.managerid = m.id AND m.salary < e.salary;",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as m on e.managerid = m.id where m.salary < e.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
109,181,383,Easy,"SELECT e.name AS employee 
FROM schema_181.employee AS e 
JOIN schema_181.employee AS d ON e.managerid = d.id AND e.salary > d.salary",49842,select e.name as employee from schema_181.employee as e left outer join schema_181.employee as d on e.managerid = d.id where e.salary > d.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
110,181,384,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee m ON m.id = e.managerid AND e.salary > m.salary;",49842,select e.name as employee from schema_181.employee as e left outer join schema_181.employee as m on m.id = e.managerid where e.salary > m.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
111,181,394,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee m ON m.id = e.managerid AND e.salary > m.salary",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as m on m.id = e.managerid where e.salary > m.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
112,181,400,Easy,"SELECT e.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee s ON s.id = e.managerid 
WHERE e.salary > s.salary",49842,select e.name as employee from schema_181.employee as e join schema_181.employee as s on (s.id = e.managerid and e.salary > s.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
113,181,459,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id 
WHERE e2.salary < e1.salary;",49842,select e1.name as employee from schema_181.employee as e1 join schema_181.employee as e2 on (e2.id = e1.managerid and e2.salary < e1.salary),49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
114,181,467,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id AND e2.salary < e1.salary",49842,select e1.name as employee from schema_181.employee as e1 join schema_181.employee as e2 on e1.managerid = e2.id where e2.salary < e1.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
115,181,477,Easy,"SELECT e2.name AS employee 
FROM schema_181.employee e2 
JOIN schema_181.employee e1 ON e1.id = e2.managerid 
WHERE e2.salary > e1.salary",49842,select e2.name as employee from schema_181.employee as e1 right outer join schema_181.employee as e2 on e1.id = e2.managerid where e2.salary > e1.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
116,181,478,Easy,"SELECT ee.name AS employee 
FROM schema_181.employee e 
JOIN schema_181.employee ee ON e.id = ee.managerid AND ee.salary > e.salary;",49842,select ee.name as employee from schema_181.employee as e join schema_181.employee as ee on e.id = ee.managerid where ee.salary > e.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
117,181,480,Easy,"SELECT emp.name AS employee 
FROM schema_181.employee emp 
JOIN schema_181.employee mang ON emp.managerid = mang.id AND mang.salary < emp.salary",49842,select emp.name as employee from schema_181.employee as emp join schema_181.employee as mang on emp.managerid = mang.id where mang.salary < emp.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
118,181,482,Easy,"SELECT a.name AS employee 
FROM schema_181.employee a 
JOIN schema_181.employee b ON a.managerid = b.id 
WHERE a.salary > b.salary;",49842,"select empname as employee from (select a.name as empname, a.salary as empsalary, b.name as asmanname, b.salary as mansalary from schema_181.employee as a join schema_181.employee as b on a.managerid = b.id) as t where empsalary > mansalary",49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
119,181,485,Easy,"SELECT m.name AS employee 
FROM schema_181.employee AS m 
JOIN schema_181.employee AS s ON m.managerid = s.id AND m.salary > s.salary",49842,select m.name as employee from schema_181.employee as m left outer join schema_181.employee as s on m.managerid = s.id where m.salary > s.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
120,181,499,Easy,"SELECT e1.name AS employee 
FROM schema_181.employee e1 
JOIN schema_181.employee e2 ON e1.managerid = e2.id AND e1.salary > e2.salary;",49842,select temp.employee from (select e1.name as employee from schema_181.employee as e1 join schema_181.employee as e2 on e1.managerid = e2.id where e1.salary > e2.salary) as temp,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
121,181,500,Easy,"SELECT x.name AS employee 
FROM schema_181.employee x 
JOIN schema_181.employee y ON x.managerid = y.id AND x.salary > y.salary;",49842,select x.name as employee from schema_181.employee as x left outer join schema_181.employee as y on x.managerid = y.id where x.salary > y.salary,49842,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
122,182,1,Easy,"SELECT email FROM (
    SELECT email, COUNT(*) as cnt 
    FROM schema_182.person 
    GROUP BY email
) t WHERE cnt >= 2;",29537,select distinct email from schema_182.person group by email having count(email) >= 2,29537,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
123,182,2,Easy,"SELECT email FROM (SELECT email, COUNT(id) AS cnt FROM schema_182.person GROUP BY email) t WHERE cnt > 1",29537,select distinct email from schema_182.person group by email having count(id) > 1,29537,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
124,182,20,Easy,"SELECT email FROM (
    SELECT email, COUNT(*) AS cnt 
    FROM schema_182.person 
    GROUP BY email
) t WHERE cnt > 1;",29537,select distinct email from schema_182.person group by email having count(email) > 1,29537,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
125,182,24,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as num from schema_182.person group by email) as statistic where num > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
126,182,25,Easy,"SELECT DISTINCT p1.email 
FROM schema_182.person p1 
JOIN schema_182.person p2 ON p1.email = p2.email AND p1.id <> p2.id",29537,select email from schema_182.person group by email having count(email) > 1,29537,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
127,182,28,Easy,"SELECT email FROM (SELECT email, COUNT(*) AS cnt FROM schema_182.person GROUP BY email) AS subq WHERE cnt > 1",29537,select email as email from schema_182.person group by email having count(email) > 1,29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
128,182,29,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select count(email) as c, email from schema_182.person group by email) as dupe where c > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
129,182,30,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as number from schema_182.person group by email) as number_emails where number > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
130,182,31,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as emailcount from schema_182.person group by email) as countemail where countemail.emailcount > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
131,182,32,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as count from schema_182.person group by email) as e where e.count > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
132,182,36,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as occurences from schema_182.person group by email) as sub where occurences > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
133,182,37,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as num from schema_182.person group by email) as new where num > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
134,182,48,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(*) > 1,29537,select email from schema_182.person group by email having count(distinct id) > 1,29537,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
135,182,52,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(*) > 1,29537,select email from schema_182.person group by email having count(id) > 1,29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
136,182,65,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(*) > 1 ORDER BY email,29537,select email from schema_182.person group by email having count(email) > 1 order by email,29537,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
137,182,69,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(*) > 1,29537,select email from schema_182.person as a group by email having count(email) > 1,29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
138,182,75,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(*) >= 2,29537,select email from schema_182.person group by email having count(email) >= 2,29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
139,182,76,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as num from schema_182.person group by email) as statictic where num > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
140,182,77,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as cnt from schema_182.person group by email) as data where cnt > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
141,182,83,Easy,"SELECT email FROM (SELECT email, COUNT(*) as cnt FROM schema_182.person GROUP BY email) t WHERE cnt > 1",29537,select person.email from schema_182.person group by person.email having count(email) > 1,29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
142,182,86,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(*) > 1,29537,select a.email from schema_182.person as a group by email having count(id) > 1,29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
143,182,87,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(id) > 1,29537,"select a.email as email from (select email, count(id) as countt from schema_182.person group by email) as a where a.countt > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
144,182,89,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as c from schema_182.person group by email) as temp where c > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
145,182,100,Easy,"SELECT email FROM (SELECT email, COUNT(*) as cnt FROM schema_182.person GROUP BY email) AS subq WHERE cnt > 1",29537,select p.email from schema_182.person as p group by p.email having count(p.email) > 1,29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
146,182,113,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as num from schema_182.person group by email) as statistics where num > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
147,182,131,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as number from schema_182.person group by 1 having count(email) > 1) as a",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
148,182,134,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as num from schema_182.person group by email) as statistic where statistic.num > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
149,182,136,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as c from schema_182.person group by email) as email where c > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
150,182,137,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(id) > 1,29537,"select email from (select email, count(id) as countofemail from schema_182.person group by email) as t where t.countofemail > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
151,182,140,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as cnt from schema_182.person group by 1) as x where cnt > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
152,182,141,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as count_ from schema_182.person group by person.email) as foo where count_ > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
153,182,142,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as num from schema_182.person group by email) as t where num > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
154,182,146,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as email_quantity from schema_182.person group by email) as table_info where email_quantity > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
155,182,152,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(*) > 1,29537,select email from schema_182.person group by 1 having count(email) > 1,29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
156,182,183,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(*) > 1,29537,select distinct email from (select email from schema_182.person group by email having count(email) > 1) as p,29537,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
157,182,196,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(id) > 1,29537,"select distinct email from (select email, count(id) as cnt from schema_182.person group by email) as tb1 where cnt > 1",29537,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
158,182,198,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as a from schema_182.person group by email) as t where a > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
159,182,200,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as cnt from schema_182.person group by email) as temp where cnt > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
160,182,206,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as countemail from schema_182.person group by email) as c where countemail > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
161,182,207,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as num from schema_182.person group by email) as segregation where num > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
162,182,209,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select email from (select email, count(email) as num from schema_182.person group by email) as derived where num > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
163,182,227,Easy,"SELECT email FROM (SELECT email, COUNT(*) as cnt FROM schema_182.person GROUP BY email) AS subq WHERE cnt > 1",29537,select email from schema_182.person as s group by email having count(email) > 1,29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
164,182,231,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(id) > 1,29537,"select tab.email from (select email, count(id) as num from schema_182.person group by email having count(id) > 1) as tab",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
165,182,232,Easy,SELECT email FROM schema_182.person GROUP BY email HAVING COUNT(email) > 1,29537,"select tmp.email from (select email, count(email) as cnt from schema_182.person group by email) as tmp where tmp.cnt > 1",29537,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
166,184,17,Medium,"WITH max_salaries AS (
    SELECT departmentid, MAX(salary) AS maxsalary 
    FROM schema_184.employee 
    GROUP BY departmentid
)
SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN max_salaries m ON e.departmentid = m.departmentid AND e.salary = m.maxsalary
JOIN schema_184.department d ON e.departmentid = d.id",100000,"select d.name as department, e.name as employee, salary from schema_184.employee as e join (select departmentid, max(salary) as maxsalary from schema_184.employee group by departmentid) as m on e.departmentid = m.departmentid join schema_184.department as d on e.departmentid = d.id where e.salary = m.maxsalary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
167,184,18,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN (
    SELECT departmentid, MAX(salary) AS salary 
    FROM schema_184.employee 
    GROUP BY departmentid
) maxsal ON e.departmentid = maxsal.departmentid AND e.salary = maxsal.salary
JOIN schema_184.department d ON e.departmentid = d.id;",100000,"select d.name as department, e2.name as employee, e2.salary from schema_184.employee as e2 join (select e1.departmentid, max(salary) as salary from schema_184.employee as e1 group by departmentid) as maxsalary on (e2.departmentid = maxsalary.departmentid and e2.salary = maxsalary.salary) join schema_184.department as d on e2.departmentid = d.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
168,184,30,Medium,"WITH department_max_salary AS (
    SELECT e.departmentid, MAX(e.salary) AS max_salary
    FROM schema_184.employee e
    GROUP BY e.departmentid
)
SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
JOIN department_max_salary dms ON e.departmentid = dms.departmentid AND e.salary = dms.max_salary
ORDER BY e.salary",100000,"select department, employee, salary from (select d.name as department, e.name as employee, e.salary as salary, max(e.salary) over (partition by e.departmentid) as maxsalary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id) as max_salary where maxsalary = salary order by salary",100000,0,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
169,184,35,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE e.salary = (SELECT MAX(salary) FROM schema_184.employee WHERE departmentid = d.id)",100000,"select department, employee, salary from (select d.name as department, e.name as employee, e.salary, max(e.salary) over (partition by d.id order by e.salary desc) as maxsalary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id) as t where salary = maxsalary",100000,0,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,Equivalent query,
170,184,51,Medium,"WITH maxsalary AS (
    SELECT departmentid, MAX(salary) AS msalary
    FROM schema_184.employee
    GROUP BY departmentid
)
SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN maxsalary m ON e.departmentid = m.departmentid AND e.salary = m.msalary
JOIN schema_184.department d ON e.departmentid = d.id;",100000,"select department.name as department, employee.name as employee, employee.salary from schema_184.employee join (select max(salary) as msalary, departmentid from schema_184.employee group by departmentid) as maxsalary on employee.departmentid = maxsalary.departmentid join schema_184.department on employee.departmentid = department.id where employee.salary = maxsalary.msalary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
171,184,56,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.department d
JOIN (
    SELECT e1.departmentid, e1.name, e1.salary
    FROM schema_184.employee e1
    JOIN (
        SELECT departmentid, MAX(salary) AS max_salary
        FROM schema_184.employee
        GROUP BY departmentid
    ) e2 ON e1.departmentid = e2.departmentid AND e1.salary = e2.max_salary
) e ON d.id = e.departmentid;",100000,"select department.name as department, temp.employee, temp.salary from schema_184.department join (select temp.departmentid, employee.name as employee, employee.salary as salary from schema_184.employee join (select max(salary) as maxsalary, departmentid from schema_184.employee group by departmentid) as temp on (employee.salary = temp.maxsalary and employee.departmentid = temp.departmentid)) as temp on temp.departmentid = department.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
172,184,77,Medium,"WITH dept_max_salaries AS (
    SELECT 
        e.departmentid,
        MAX(e.salary) AS max_salary
    FROM 
        schema_184.employee e
    GROUP BY 
        e.departmentid
)
SELECT 
    e.name AS employee,
    d.name AS department,
    e.salary
FROM 
    schema_184.employee e
JOIN 
    schema_184.department d ON e.departmentid = d.id
JOIN 
    dept_max_salaries dms ON e.departmentid = dms.departmentid AND e.salary = dms.max_salary;",100000,"select employee, department, salary from (select e.name as employee, d.name as department, salary, max(salary) over (partition by e.departmentid) as m from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id) as r where salary = m",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
173,184,78,Medium,"WITH dept_max_sal AS (
    SELECT e.departmentid, MAX(e.salary) AS max_salary
    FROM schema_184.employee e
    GROUP BY e.departmentid
)
SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON d.id = e.departmentid
JOIN dept_max_sal dms ON e.departmentid = dms.departmentid AND e.salary = dms.max_salary",100000,"select r.d_name as department, r.name as employee, r.salary from (select e.id, e.salary, e.name, d.name as d_name, max(e.salary) over (partition by e.departmentid) as max_sal from schema_184.employee as e join schema_184.department as d on d.id = e.departmentid) as r where r.salary = r.max_sal",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
174,184,93,Medium,"WITH dep_max_salaries AS (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
)
SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN dep_max_salaries dms ON e.departmentid = dms.departmentid AND e.salary = dms.max_salary
JOIN schema_184.department d ON d.id = e.departmentid;",100000,"select d.name as department, e1.name as employee, e1.salary from (select id, name, salary, departmentid, max(salary) over (partition by departmentid) as dep_max from schema_184.employee) as e1 join schema_184.department as d on d.id = e1.departmentid where e1.salary = e1.dep_max",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
175,184,115,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary",100000,"select d.name as department, e.name as employee, m.salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id join (select max(salary) as salary, departmentid from schema_184.employee group by departmentid) as m on m.departmentid = e.departmentid where m.salary = e.salary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
176,184,118,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.department d
JOIN (
    SELECT departmentid, name, salary,
           DENSE_RANK() OVER (PARTITION BY departmentid ORDER BY salary DESC) AS rank
    FROM schema_184.employee
) e ON d.id = e.departmentid AND e.rank = 1;",100000,"select d.name as department, e1.name as employee, e1.salary from schema_184.department as d join schema_184.employee as e1 on d.id = e1.departmentid join (select e2.departmentid, max(e2.salary) as salary from schema_184.employee as e2 group by e2.departmentid) as t on (e1.departmentid = t.departmentid and e1.salary = t.salary)",100000,0,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,Equivalent query,
177,184,126,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.department d
JOIN (
    SELECT DISTINCT ON (em.departmentid) em.name, em.salary, em.departmentid
    FROM schema_184.employee em
    ORDER BY em.departmentid, em.salary DESC
) e ON d.id = e.departmentid",50,"select d.name as department, e.name as employee, e.salary from schema_184.department as d join (select em.name, em.salary, em.departmentid from schema_184.employee as em join (select max(salary) as salary, departmentid from schema_184.employee group by departmentid) as m on (em.salary = m.salary and em.departmentid = m.departmentid)) as e on d.id = e.departmentid",100000,-99950,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,Non-equivalent queries,"The two queries differ because the optimized query uses DISTINCT ON which returns only one top-salaried employee per department based on the order of rows, while the initial query includes all employees who share the highest salary in their department, ensuring completeness."
178,184,130,Medium,"WITH max_salaries AS (
    SELECT departmentid, MAX(salary) AS salary 
    FROM schema_184.employee 
    GROUP BY departmentid
)
SELECT d.name AS department, e.name AS employee, m.salary 
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
JOIN max_salaries m ON e.departmentid = m.departmentid AND e.salary = m.salary",100000,"select d.name as department, e1.name as employee, e2.salary from schema_184.employee as e1 join schema_184.department as d on e1.departmentid = d.id join (select departmentid, max(salary) as salary from schema_184.employee group by departmentid) as e2 on e1.departmentid = e2.departmentid where e1.salary = e2.salary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
179,184,142,Medium,"WITH max_salaries AS (
    SELECT departmentid, MAX(salary) AS salary 
    FROM schema_184.employee 
    GROUP BY departmentid
)
SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e 
JOIN schema_184.department d ON e.departmentid = d.id 
JOIN max_salaries m ON e.departmentid = m.departmentid AND e.salary = m.salary",100000,"select d.name as department, e.name as employee, e.salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id join (select departmentid, max(salary) as salary from schema_184.employee group by departmentid) as m on e.departmentid = m.departmentid where e.salary = m.salary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
180,184,152,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e 
JOIN schema_184.department d ON e.departmentid = d.id 
JOIN (
    SELECT DISTINCT ON (departmentid) departmentid, salary 
    FROM schema_184.employee 
    ORDER BY departmentid, salary DESC
) mx ON e.departmentid = mx.departmentid AND e.salary = mx.salary",100000,"select d.name as department, e.name as employee, e.salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id join (select max(salary) as salary, departmentid from schema_184.employee group by departmentid) as mx on (e.departmentid = mx.departmentid and e.salary = mx.salary)",100000,0,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,Equivalent query,
181,184,156,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary)
    FROM schema_184.employee
    GROUP BY departmentid
)",100000,"select d.name as department, e.name as employee, max_sal as salary from (select max(salary) as max_sal, departmentid as did from schema_184.employee group by departmentid) as m join schema_184.department as d on d.id = m.did right outer join schema_184.employee as e on e.departmentid = did where max_sal = e.salary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
182,184,160,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary;",100000,"select dep.department_name as department, e.name as employee, salary from schema_184.employee as e join (select d.id as department_id, d.name as department_name, max(salary) as max_salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id group by d.id) as dep on e.departmentid = dep.department_id where e.salary = dep.max_salary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
183,184,164,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary)
    FROM schema_184.employee
    GROUP BY departmentid
)",100000,"select department.name as department, employee.name as employee, employee.salary from schema_184.employee join (select max(salary) as salary, departmentid from schema_184.employee group by departmentid) as max_salary on (employee.salary = max_salary.salary and employee.departmentid = max_salary.departmentid) join schema_184.department on employee.departmentid = department.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
184,184,171,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary",100000,"select t.department, emp.name as employee, t.salary from (select d.name as department, e.departmentid, max(e.salary) as salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id group by 1, 2) as t left outer join schema_184.employee as emp on (emp.departmentid = t.departmentid and emp.salary = t.salary)",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
185,184,173,Medium,"WITH max_salaries AS (
    SELECT departmentid, MAX(salary) AS max_salary 
    FROM schema_184.employee 
    GROUP BY departmentid
)
SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN max_salaries ms ON e.departmentid = ms.departmentid AND e.salary = ms.max_salary
JOIN schema_184.department d ON e.departmentid = d.id;",100000,"select t3.name as department, t1.name as employee, t1.salary from schema_184.employee as t1 join schema_184.department as t3 on t1.departmentid = t3.id join (select departmentid, max(salary) as max_salary from schema_184.employee group by departmentid) as t2 on t1.departmentid = t2.departmentid where t1.salary = t2.max_salary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
186,184,177,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary",100000,"select department, e.name as employee, j.salary as salary from (select d.name as department, d.id, max(salary) as salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id group by 1, 2) as j join schema_184.employee as e on (j.id = e.departmentid and j.salary = e.salary)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
187,184,179,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary) 
    FROM schema_184.employee 
    GROUP BY departmentid
)",100000,"select department, employee, salary from (select d.name as department, e1.name as employee, e1.salary as salary, max(salary) over (partition by departmentid) as maxsalary from schema_184.employee as e1 join schema_184.department as d on e1.departmentid = d.id) as a where salary = maxsalary",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
188,184,189,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary
JOIN schema_184.department d ON e.departmentid = d.id;",100000,"select t3.name as department, t1.name as employee, t1.salary from schema_184.employee as t1 join (select departmentid, max(salary) as salary from schema_184.employee group by departmentid) as t2 on (t1.departmentid = t2.departmentid and t1.salary = t2.salary) join schema_184.department as t3 on t1.departmentid = t3.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
189,184,208,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary) 
    FROM schema_184.employee 
    GROUP BY departmentid
)",100000,"select t1.department, t1.employee, t1.salary from (select e.name as employee, e.salary, e.departmentid, d.name as department from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id) as t1 join (select departmentid, max(salary) as maxsalary from schema_184.employee group by departmentid) as t2 on (t2.maxsalary = t1.salary and t2.departmentid = t1.departmentid)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
190,184,244,Medium,"SELECT d.name AS department, e.name AS employee, e.salary AS salary 
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary) 
    FROM schema_184.employee 
    GROUP BY departmentid
)",100000,"select d.name as department, e.name as employee, e.salary as salary from schema_184.employee as e join (select departmentid, max(salary) as msalary from schema_184.employee group by departmentid) as s on (e.departmentid = s.departmentid and e.salary = s.msalary) join schema_184.department as d on e.departmentid = d.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
191,184,248,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.department d
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) max_sal ON d.id = max_sal.departmentid
JOIN schema_184.employee e ON e.departmentid = max_sal.departmentid AND e.salary = max_sal.max_salary;",100000,"select d1.name as department, e1.name as employee, e1.salary from (select d.id, max(d.name) as name, max(e.salary) as salary from schema_184.department as d join schema_184.employee as e on e.departmentid = d.id group by d.id) as d1 join schema_184.employee as e1 on (e1.departmentid = d1.id and e1.salary = d1.salary)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
192,184,259,Medium,"WITH dept_max_salary AS (
    SELECT e.departmentid, MAX(e.salary) AS max_salary
    FROM schema_184.employee e
    GROUP BY e.departmentid
)
SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
JOIN dept_max_salary dms ON e.departmentid = dms.departmentid AND e.salary = dms.max_salary
ORDER BY department;",100000,"select department, employee, salary from (select d.name as department, e.name as employee, e.salary as salary, max(e.salary) over (partition by e.departmentid) as maxsalary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id) as m where salary = m.maxsalary order by department",100000,0,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
193,184,277,Medium,"SELECT d.name AS department, e.name AS employee, e.salary AS salary
FROM schema_184.employee e
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary
JOIN schema_184.department d ON d.id = e.departmentid;",100000,"select department.name as department, employee.name as employee, employee.salary as salary from schema_184.employee join (select departmentid, max(salary) as max_salary from schema_184.employee group by departmentid) as temp on (employee.departmentid = temp.departmentid and employee.salary = temp.max_salary) join schema_184.department on department.id = employee.departmentid",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
194,184,285,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON d.id = e.departmentid
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary)
    FROM schema_184.employee
    GROUP BY departmentid
)",100000,"select department.name as department, employee.name as employee, maxsalary as salary from (select departmentid, max(salary) as maxsalary from schema_184.employee group by departmentid) as temp join schema_184.employee on (temp.departmentid = employee.departmentid and employee.salary = temp.maxsalary) join schema_184.department on department.id = employee.departmentid",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
195,184,295,Medium,"SELECT d.name AS department, e.name AS employee, e.salary AS salary
FROM schema_184.employee e
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary
JOIN schema_184.department d ON d.id = e.departmentid;",100000,"select department.name as department, e1.name as employee, e1.salary as salary from schema_184.employee as e1 join (select max(salary) as salary, departmentid from schema_184.employee group by departmentid) as m1 on (e1.salary = m1.salary and e1.departmentid = m1.departmentid) join schema_184.department on department.id = e1.departmentid",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
196,184,304,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary)
    FROM schema_184.employee
    GROUP BY departmentid
)",100000,"select a.name as department, e1.name as employee, e1.salary as salary from schema_184.employee as e1 join (select d.id, d.name, max(salary) as s from schema_184.employee as e join schema_184.department as d on d.id = e.departmentid group by d.id, d.name) as a on (e1.departmentid = a.id and a.s = e1.salary)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
197,184,308,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary
JOIN schema_184.department d ON e.departmentid = d.id",100000,"select b.name as department, a.name as employee, a.salary from schema_184.employee as a join (select departmentid, max(salary) as max_salary from schema_184.employee group by 1) as c on (c.departmentid = a.departmentid and max_salary = a.salary) join schema_184.department as b on a.departmentid = b.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
198,184,326,Medium,"WITH max_salaries AS (
    SELECT departmentid, MAX(salary) AS max_salary 
    FROM schema_184.employee 
    GROUP BY departmentid
)
SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN max_salaries ms ON e.departmentid = ms.departmentid AND e.salary = ms.max_salary
JOIN schema_184.department d ON e.departmentid = d.id;",100000,"select b.name as department, a.name as employee, a.salary from schema_184.employee as a join (select departmentid, max(salary) as salary1 from schema_184.employee group by departmentid) as c on (a.departmentid = c.departmentid and a.salary = c.salary1) join schema_184.department as b on a.departmentid = b.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
199,184,330,Medium,"WITH max_salaries AS (
    SELECT departmentid, MAX(salary) AS salary 
    FROM schema_184.employee 
    GROUP BY departmentid
)
SELECT e.name AS employee, ms.salary, d.name AS department 
FROM max_salaries ms
JOIN schema_184.employee e ON (ms.departmentid = e.departmentid AND ms.salary = e.salary)
JOIN schema_184.department d ON ms.departmentid = d.id;",100000,"select b.name as employee, a.salary, c.name as department from (select departmentid, max(salary) as salary from schema_184.employee group by departmentid) as a join schema_184.employee as b on (a.departmentid = b.departmentid and a.salary = b.salary) join schema_184.department as c on a.departmentid = c.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
200,184,334,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN (
    SELECT departmentid, salary
    FROM (
        SELECT departmentid, salary, 
               RANK() OVER (PARTITION BY departmentid ORDER BY salary DESC) AS rank
        FROM schema_184.employee
    ) ranked
    WHERE rank = 1
) max_sal ON e.departmentid = max_sal.departmentid AND e.salary = max_sal.salary
JOIN schema_184.department d ON e.departmentid = d.id;",200080802,"select c.name as department, a.name as employee, a.salary from schema_184.employee as a join (select departmentid, max(salary) as max_salary from schema_184.employee group by 1) as b on (a.departmentid = b.departmentid and a.salary = b.max_salary) join schema_184.department as c on a.departmentid = c.id",100000,199980802,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,Non-equivalent queries,
201,184,336,Medium,"SELECT d.name AS department, e.name AS employee, e.salary AS salary
FROM schema_184.employee e
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary
JOIN schema_184.department d ON e.departmentid = d.id;",100000,"select c.name as department, a.name as employee, a.salary as salary from schema_184.employee as a join (select departmentid, max(salary) as mx from schema_184.employee group by departmentid) as b on (a.departmentid = b.departmentid and a.salary = b.mx) join schema_184.department as c on a.departmentid = c.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
202,184,353,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary
JOIN schema_184.department d ON e.departmentid = d.id",100000,"select d.name as department, t.employee, t.salary from (select e.departmentid, e.name as employee, e.salary, max(e.salary) over (partition by e.departmentid order by e.salary desc) as maxsalary from schema_184.employee as e) as t join schema_184.department as d on t.departmentid = d.id where t.salary = t.maxsalary",100000,0,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,Equivalent query,
203,184,355,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) m ON e.departmentid = m.departmentid AND e.salary = m.max_salary",100000,"select d.name as department, a.name as employee, a.salary from schema_184.employee as a join schema_184.department as d on a.departmentid = d.id join (select max(e.salary) as salary, e.departmentid from schema_184.employee as e group by e.departmentid) as m on (m.salary = a.salary and m.departmentid = a.departmentid)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
204,184,358,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary) 
    FROM schema_184.employee 
    GROUP BY departmentid
)",100000,"select d.name as department, e.name as employee, e.salary as salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id join (select departmentid, max(salary) as salary from schema_184.employee group by departmentid) as a on (e.salary = a.salary and e.departmentid = a.departmentid)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
205,184,361,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.department d
JOIN (
    SELECT e1.departmentid, e1.name, e1.salary
    FROM schema_184.employee e1
    JOIN (
        SELECT departmentid, MAX(salary) AS maxsalary
        FROM schema_184.employee
        GROUP BY departmentid
    ) e2 ON e1.departmentid = e2.departmentid AND e1.salary = e2.maxsalary
) e ON d.id = e.departmentid;",100000,"select d.name as department, e.name as employee, salary from schema_184.employee as e left outer join schema_184.department as d on e.departmentid = d.id left outer join (select max(salary) as maxsalary, departmentid from schema_184.employee group by departmentid) as a on d.id = a.departmentid where e.salary = a.maxsalary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
206,184,365,Medium,"WITH max_salaries AS (
    SELECT departmentid, MAX(salary) AS m_salary 
    FROM schema_184.employee 
    GROUP BY departmentid
)
SELECT d.name AS department, e.name AS employee, e.salary AS salary 
FROM schema_184.employee e 
JOIN schema_184.department d ON e.departmentid = d.id 
JOIN max_salaries ms ON ms.departmentid = e.departmentid AND ms.m_salary = e.salary",100000,"select d.name as department, e.name as employee, e.salary as salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id join (select departmentid, max(salary) as m_salary from schema_184.employee group by departmentid) as t1 on t1.departmentid = e.departmentid where e.salary = t1.m_salary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
207,184,366,Medium,"SELECT d.name AS department, e.name AS employee, e.salary AS salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary)
    FROM schema_184.employee
    GROUP BY departmentid
)",100000,"select d.name as department, e.name as employee, e.salary as salary from schema_184.employee as e join (select e.departmentid as did, max(salary) as maxs from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id group by e.departmentid) as edm on (e.salary = edm.maxs and e.departmentid = edm.did) join schema_184.department as d on e.departmentid = d.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
208,184,371,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
JOIN (
    SELECT departmentid, MAX(salary) AS salary 
    FROM schema_184.employee 
    GROUP BY departmentid
) mx ON e.departmentid = mx.departmentid AND e.salary = mx.salary",100000,"select d.name as department, e.name as employee, e.salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id join (select max(salary) as salary, departmentid from schema_184.employee group by departmentid) as mx on (e.salary = mx.salary and e.departmentid = mx.departmentid)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
209,184,373,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN schema_184.department d ON d.id = e.departmentid
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary) 
    FROM schema_184.employee 
    GROUP BY departmentid
)",100000,"select d.name as department, e.name as employee, e.salary from schema_184.employee as e join (select departmentid, max(salary) as max_salary from schema_184.employee group by departmentid) as max_s on e.departmentid = max_s.departmentid join schema_184.department as d on d.id = e.departmentid where e.salary = max_s.max_salary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
210,184,376,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN schema_184.department d ON d.id = e.departmentid
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary 
    FROM schema_184.employee 
    GROUP BY departmentid
) t ON e.departmentid = t.departmentid AND e.salary = t.max_salary",100000,"select d.name as department, e.name as employee, e.salary from schema_184.employee as e join schema_184.department as d on d.id = e.departmentid join (select d.id, max(e.salary) as salary from schema_184.employee as e join schema_184.department as d on d.id = e.departmentid group by d.id) as t on (e.departmentid = t.id and e.salary = t.salary)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
211,184,387,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.department d
JOIN (
    SELECT departmentid, name, salary,
           DENSE_RANK() OVER (PARTITION BY departmentid ORDER BY salary DESC) AS rank
    FROM schema_184.employee
) e ON e.departmentid = d.id AND e.rank = 1",100000,"select d.name as department, e1.name as employee, e1.salary from schema_184.employee as e1 join schema_184.department as d on e1.departmentid = d.id join (select departmentid, max(salary) as max_salary from schema_184.employee group by departmentid) as t1 on (e1.salary = t1.max_salary and e1.departmentid = t1.departmentid)",100000,0,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,Equivalent query,
212,184,428,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary) 
    FROM schema_184.employee 
    GROUP BY departmentid
)",100000,"select d.name as department, e.name as employee, e.salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id join (select max(salary) as salary, departmentid from schema_184.employee group by departmentid) as max on (e.salary = max.salary and e.departmentid = max.departmentid)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
213,184,430,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
JOIN (
    SELECT departmentid, MAX(salary) AS highest_salary 
    FROM schema_184.employee 
    GROUP BY departmentid
) s ON e.departmentid = s.departmentid AND e.salary = s.highest_salary",100000,"select d.name as department, e.name as employee, salary from schema_184.employee as e join schema_184.department as d on e.departmentid = d.id join (select max(salary) as highest_salary, departmentid from schema_184.employee group by departmentid) as s on (e.salary = s.highest_salary and s.departmentid = e.departmentid)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
214,184,436,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN schema_184.department d ON d.id = e.departmentid
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary) 
    FROM schema_184.employee 
    GROUP BY departmentid
)",100000,"select d1.name as department, e.name as employee, e.salary from schema_184.employee as e join schema_184.department as d1 on d1.id = e.departmentid join (select max(salary) as max_salary, departmentid from schema_184.employee group by departmentid) as ms on (ms.max_salary = e.salary and ms.departmentid = e.departmentid)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
215,184,442,Medium,"SELECT d.name AS department, e.name AS employee, e.salary 
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary) 
    FROM schema_184.employee 
    GROUP BY departmentid
)",100000,"select dd.name as department, ee.name as employee, ee.salary as salary from schema_184.employee as ee join (select d.id, d.name, max(e.salary) as salary from schema_184.employee as e join schema_184.department as d on d.id = e.departmentid group by d.id) as dd on dd.id = ee.departmentid where ee.salary = dd.salary",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
216,184,443,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.department d
JOIN schema_184.employee e ON d.id = e.departmentid
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary)
    FROM schema_184.employee
    GROUP BY departmentid
)",100000,"select dep.name as department, emp.name as employee, emp.salary from schema_184.employee as emp join schema_184.department as dep on emp.departmentid = dep.id join (select departmentid, max(salary) as salary from schema_184.employee group by departmentid) as temp on (emp.salary = temp.salary and dep.id = temp.departmentid)",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
217,184,455,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.department d
JOIN (
    SELECT departmentid, name, salary,
           DENSE_RANK() OVER (PARTITION BY departmentid ORDER BY salary DESC) AS rank
    FROM schema_184.employee
) e ON d.id = e.departmentid AND e.rank = 1",100000,"select department.name as department, b.name as employee, salary as salary from schema_184.department join (select a.departmentid, a.salary, b.name from (select departmentid, max(salary) as salary from schema_184.employee group by departmentid) as a join schema_184.employee as b on (a.salary = b.salary and a.departmentid = b.departmentid)) as b on department.id = b.departmentid",100000,0,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,Equivalent query,
218,184,457,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.department d
JOIN (
    SELECT departmentid, MAX(salary) AS max_salary
    FROM schema_184.employee
    GROUP BY departmentid
) max_sal ON d.id = max_sal.departmentid
JOIN schema_184.employee e ON e.departmentid = max_sal.departmentid AND e.salary = max_sal.max_salary;",100000,"select department.name as department, employee.name as employee, salary.max_salary as salary from (select departmentid, max(salary) as max_salary from schema_184.employee group by departmentid) as salary left outer join schema_184.employee as employee on (salary.max_salary = employee.salary and salary.departmentid = employee.departmentid) join schema_184.department as department on salary.departmentid = department.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
219,184,480,Medium,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_184.employee e
JOIN schema_184.department d ON e.departmentid = d.id
WHERE (e.departmentid, e.salary) IN (
    SELECT departmentid, MAX(salary) 
    FROM schema_184.employee 
    GROUP BY departmentid
)",100000,"select tb3.name as department, tb4.name as employee, tb2.maxsalary as salary from (select tb1.departmentid, max(tb1.salary) as maxsalary from schema_184.employee as tb1 group by tb1.departmentid) as tb2 join schema_184.employee as tb4 on (tb2.maxsalary = tb4.salary and tb2.departmentid = tb4.departmentid) join schema_184.department as tb3 on tb2.departmentid = tb3.id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
220,185,427,Hard,"SELECT d.name AS department, e.name AS employee, e.salary
FROM schema_185.employee e
JOIN schema_185.department d ON e.departmentid = d.id
WHERE e.id IN (
    SELECT e1.id
    FROM schema_185.employee e1
    WHERE (
        SELECT COUNT(DISTINCT e2.salary)
        FROM schema_185.employee e2
        WHERE e2.departmentid = e1.departmentid AND e2.salary >= e1.salary
    ) <= 3
)",6962,"select d.name as department, e.name as employee, salary from schema_185.employee as e join schema_185.department as d on e.departmentid = d.id join (select e1.id, count(distinct e2.salary) as rk from schema_185.employee as e1 join schema_185.employee as e2 on (e1.salary <= e2.salary and e1.departmentid = e2.departmentid) group by 1) as temp on temp.id = e.id where rk <= 3",6962,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
221,185,434,Hard,"WITH ranked_employees AS (
    SELECT 
        e.name,
        e.salary,
        e.departmentid,
        DENSE_RANK() OVER (PARTITION BY departmentid ORDER BY salary DESC) as salary_rank
    FROM schema_185.employee e
)
SELECT 
    d.name as department,
    r.name as employee,
    r.salary
FROM ranked_employees r
JOIN schema_185.department d ON r.departmentid = d.id
WHERE r.salary_rank <= 3
ORDER BY d.name, r.salary DESC;",6962,"select d.name as department, e.name as employee, e.salary from (select e1.name, e1.salary, e1.departmentid from schema_185.employee as e1 join schema_185.employee as e2 on (e1.departmentid = e2.departmentid and e1.salary <= e2.salary) group by e1.id having count(distinct e2.salary) <= 3) as e join schema_185.department as d on e.departmentid = d.id order by d.name, e.salary desc",6962,0,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
222,534,1,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity 
ORDER BY player_id, event_date",100000,"select distinct player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity order by player_id, event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
223,534,2,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date ROWS UNBOUNDED PRECEDING) AS games_played_so_far FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
224,534,3,Medium,"SELECT 
    a.player_id, 
    a.event_date, 
    (SELECT SUM(b.games_played) 
    FROM schema_534.activity b 
    WHERE b.player_id = a.player_id AND b.event_date <= a.event_date
    ) AS games_played_so_far 
FROM schema_534.activity a 
ORDER BY a.player_id, a.event_date ASC",100000,"select a.player_id, a.event_date, sum(b.games_played) as games_played_so_far from schema_534.activity as a left outer join schema_534.activity as b on (a.player_id = b.player_id and a.event_date >= b.event_date) group by a.player_id, a.event_date order by a.player_id, a.event_date asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
225,534,4,Medium,"SELECT 
    a.player_id, 
    a.event_date, 
    SUM(a2.games_played) OVER (PARTITION BY a.player_id ORDER BY a.event_date) AS games_played_so_far
FROM 
    schema_534.activity a
JOIN 
    schema_534.activity a2 
    ON a.player_id = a2.player_id AND a.event_date >= a2.event_date
GROUP BY 
    a.player_id, 
    a.event_date, 
    a2.games_played",864174,"select a.player_id, a.event_date, sum(a2.games_played) as games_played_so_far from schema_534.activity as a join schema_534.activity as a2 on (a.event_date >= a2.event_date and a.player_id = a2.player_id) group by 1, 2",100000,764174,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,Non-equivalent queries,"The optimized query produces incorrect results due to grouping by games_played, which distorts the cumulative sum, while the initial query correctly aggregates the total games played using a self-join and standard GROUP BY."
227,534,11,Medium,"SELECT 
    a1.player_id, 
    a1.event_date, 
    (SELECT SUM(a2.games_played) 
     FROM schema_534.activity a2 
     WHERE a2.player_id = a1.player_id AND a2.event_date <= a1.event_date) AS games_played_so_far 
FROM schema_534.activity a1",100000,"select a1.player_id, a1.event_date, sum(a2.games_played) as games_played_so_far from schema_534.activity as a1 left outer join schema_534.activity as a2 on (a1.player_id = a2.player_id and a2.event_date <= a1.event_date) group by a1.player_id, a1.event_date",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
228,534,15,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date rows between unbounded preceding and current row) as games_played_so_far from schema_534.activity",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
229,534,17,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date ASC ROWS UNBOUNDED PRECEDING) AS games_played_so_far FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date asc) as games_played_so_far from schema_534.activity",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
230,534,19,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date asc rows between unbounded preceding and current row) as games_played_so_far from schema_534.activity order by player_id, event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
231,534,22,Medium,"SELECT 
    player_id, 
    event_date, 
    SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date rows between unbounded preceding and current row) as games_played_so_far from schema_534.activity group by 1, 2",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
232,534,23,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity 
ORDER BY player_id, event_date",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date rows between unbounded preceding and current row) as games_played_so_far from schema_534.activity order by player_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
233,534,26,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity order by player_id, event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
234,534,29,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity 
ORDER BY player_id, event_date",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity group by player_id, event_date order by player_id, event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
235,534,31,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by player_id, event_date) as games_played_so_far from schema_534.activity",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
236,534,35,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date ASC ROWS UNBOUNDED PRECEDING) AS games_played_so_far FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date asc) as games_played_so_far from schema_534.activity as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
237,534,36,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date asc rows between unbounded preceding and current row) as games_played_so_far from schema_534.activity as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
238,534,40,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date rows unbounded preceding) as games_played_so_far from schema_534.activity",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
239,534,51,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date asc) as games_played_so_far from schema_534.activity order by player_id, event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
240,534,53,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date range between unbounded preceding and current row) as games_played_so_far from schema_534.activity",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
241,534,56,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity group by player_id, event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
242,534,65,Medium,"SELECT 
    a1.player_id, 
    a1.event_date, 
    SUM(a2.games_played) AS games_played_so_far 
FROM 
    schema_534.activity a1 
JOIN 
    schema_534.activity a2 
    ON a1.player_id = a2.player_id 
    AND a2.event_date <= a1.event_date 
GROUP BY 
    a1.player_id, 
    a1.event_date",100000,"select a1.player_id, a1.event_date, sum(a2.games_played) as games_played_so_far from schema_534.activity as a1 join schema_534.activity as a2 on (a1.player_id = a2.player_id and a1.event_date >= a2.event_date) group by a1.player_id, a1.event_date",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
243,534,66,Medium,"SELECT 
    a.player_id,
    a.event_date,
    (SELECT SUM(b.games_played) 
     FROM schema_534.activity b 
     WHERE b.player_id = a.player_id AND b.event_date <= a.event_date) AS games_played_so_far
FROM schema_534.activity a",100000,"select a.player_id as player_id, a.event_date as event_date, sum(b.games_played) as games_played_so_far from schema_534.activity as a join schema_534.activity as b on (a.player_id = b.player_id and a.event_date >= b.event_date) group by a.player_id, a.event_date",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
244,534,67,Medium,"SELECT 
    a1.player_id, 
    a1.event_date, 
    (SELECT SUM(a2.games_played) 
     FROM schema_534.activity a2 
     WHERE a2.player_id = a1.player_id AND a2.event_date <= a1.event_date) AS games_played_so_far 
FROM schema_534.activity a1",100000,"select a1.player_id, a1.event_date, sum(a2.games_played) as games_played_so_far from schema_534.activity as a1 join schema_534.activity as a2 on (a2.event_date <= a1.event_date and a1.player_id = a2.player_id) group by a1.player_id, a1.event_date",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
245,534,71,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity 
ORDER BY games_played_so_far DESC",100000,"select player_id, event_date, games_played_so_far from (select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity) as t order by games_played_so_far desc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
246,534,73,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date asc rows between unbounded preceding and current row) as games_played_so_far from schema_534.activity order by player_id asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
247,534,80,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far FROM schema_534.activity",100000,"select a.player_id, a.event_date, sum(a.games_played) over (partition by a.player_id order by event_date asc) as games_played_so_far from schema_534.activity as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
250,534,85,Medium,"SELECT 
    a.player_id, 
    a.event_date, 
    (SELECT SUM(b.games_played) 
     FROM schema_534.activity b 
     WHERE b.player_id = a.player_id AND b.event_date <= a.event_date
    ) AS games_played_so_far 
FROM schema_534.activity a 
ORDER BY a.player_id, a.event_date",100000,"select a.player_id, a.event_date, sum(b.games_played) as games_played_so_far from schema_534.activity as a join schema_534.activity as b on a.player_id = b.player_id where a.event_date >= b.event_date group by a.player_id, a.event_date order by a.player_id, a.event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
252,534,91,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date ROWS UNBOUNDED PRECEDING) AS games_played_so_far FROM schema_534.activity",100000,"select a.player_id, a.event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
253,534,92,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far FROM schema_534.activity",100000,"select a.player_id, a.event_date, sum(games_played) over (partition by player_id order by event_date asc) as games_played_so_far from schema_534.activity as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
254,534,93,Medium,"SELECT 
    a.player_id, 
    a.event_date, 
    SUM(b.games_played) AS games_played_so_far 
FROM 
    schema_534.activity a 
JOIN 
    schema_534.activity b 
    ON a.player_id = b.player_id 
    AND a.event_date >= b.event_date 
GROUP BY 
    a.player_id, 
    a.event_date",100000,"select a.player_id, a.event_date, sum(b.games_played) as games_played_so_far from schema_534.activity as a join schema_534.activity as b on a.player_id = b.player_id where a.event_date >= b.event_date group by a.player_id, a.event_date",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
256,534,97,Medium,"SELECT 
    player_id, 
    event_date, 
    SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM 
    schema_534.activity 
ORDER BY 
    player_id, 
    event_date",100000,"select a1.player_id, a1.event_date, sum(a1.games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity as a1 group by a1.player_id, a1.event_date order by a1.player_id, a1.event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
257,534,100,Medium,"SELECT 
    a1.player_id, 
    a1.event_date, 
    (SELECT SUM(a2.games_played) 
     FROM schema_534.activity a2 
     WHERE a2.player_id = a1.player_id AND a2.event_date <= a1.event_date) AS games_played_so_far
FROM schema_534.activity a1",100000,"select a1.player_id, a1.event_date, sum(a2.games_played) as games_played_so_far from schema_534.activity as a1 join schema_534.activity as a2 on (a1.player_id = a2.player_id and a1.event_date >= a2.event_date) group by 1, 2",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
258,534,105,Medium,"SELECT 
    a1.player_id, 
    a1.event_date, 
    (SELECT SUM(a2.games_played) 
     FROM schema_534.activity a2 
     WHERE a2.player_id = a1.player_id AND a2.event_date <= a1.event_date) AS games_played_so_far
FROM schema_534.activity a1",100000,"select a1.player_id, a1.event_date, sum(a2.games_played) as games_played_so_far from schema_534.activity as a1 join schema_534.activity as a2 on (a1.event_date >= a2.event_date and a1.player_id = a2.player_id) group by 1, 2",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
259,534,112,Medium,"SELECT 
    a2.player_id, 
    a2.event_date, 
    SUM(a1.games_played) AS games_played_so_far 
FROM 
    schema_534.activity a2 
JOIN 
    schema_534.activity a1 
    ON a1.player_id = a2.player_id AND a1.event_date <= a2.event_date 
GROUP BY 
    a2.player_id, a2.event_date",100000,"select a1.player_id, a2.event_date, sum(a1.games_played) as games_played_so_far from schema_534.activity as a1 left outer join schema_534.activity as a2 on (a1.player_id = a2.player_id and a1.event_date <= a2.event_date) group by a1.player_id, a2.event_date",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
260,534,113,Medium,"SELECT 
    a1.player_id, 
    a1.event_date, 
    (SELECT SUM(a2.games_played) 
     FROM schema_534.activity a2 
     WHERE a2.player_id = a1.player_id AND a2.event_date <= a1.event_date) AS games_played_so_far
FROM schema_534.activity a1
ORDER BY a1.player_id, a1.event_date ASC",100000,"select a1.player_id, a1.event_date, sum(a2.games_played) as games_played_so_far from schema_534.activity as a1 left outer join schema_534.activity as a2 on (a1.player_id = a2.player_id and a1.event_date >= a2.event_date) group by a1.player_id, a1.event_date order by a1.player_id, a1.event_date asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
261,534,115,Medium,"SELECT 
    a2.player_id, 
    a2.event_date, 
    SUM(a1.games_played) OVER (PARTITION BY a2.player_id ORDER BY a2.event_date) AS games_played_so_far
FROM schema_534.activity a2
JOIN schema_534.activity a1 ON a1.player_id = a2.player_id AND a1.event_date <= a2.event_date
GROUP BY a2.player_id, a2.event_date, a1.games_played",864174,"select a2.player_id, a2.event_date, sum(a1.games_played) as games_played_so_far from schema_534.activity as a1 join schema_534.activity as a2 on (a1.player_id = a2.player_id and a1.event_date <= a2.event_date) group by 1, 2",100000,764174,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,Non-equivalent queries,"The optimized query produces incorrect results due to grouping by games_played, which distorts the cumulative sum, while the initial query correctly aggregates the total games played using a self-join and standard GROUP BY."
263,534,117,Medium,"SELECT 
    a.player_id, 
    a.event_date, 
    SUM(b.games_played) AS games_played_so_far 
FROM 
    schema_534.activity a 
JOIN 
    schema_534.activity b 
    ON a.player_id = b.player_id 
    AND b.event_date <= a.event_date 
GROUP BY 
    a.player_id, 
    a.event_date",100000,"select c.player_id, c.end_event_date as event_date, sum(c.games_played) as games_played_so_far from (select a.player_id, a.event_date as end_event_date, b.event_date, b.games_played from schema_534.activity as a left outer join schema_534.activity as b on (a.player_id = b.player_id and a.event_date >= b.event_date)) as c group by player_id, end_event_date",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
264,534,123,Medium,"SELECT 
    player_id, 
    event_date, 
    SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from (select player_id, event_date, sum(games_played) as games_played from schema_534.activity group by player_id, event_date) as x",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
265,534,124,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity group by 1, 2",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
266,534,129,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date rows unbounded preceding) as games_played_so_far from schema_534.activity order by player_id, event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
267,534,133,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date asc) as games_played_so_far from schema_534.activity group by player_id, event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
268,534,136,Medium,"SELECT 
    a.player_id, 
    a.event_date, 
    SUM(b.games_played) AS games_played_so_far 
FROM 
    schema_534.activity a
JOIN 
    schema_534.activity b 
    ON b.player_id = a.player_id 
    AND b.event_date <= a.event_date
GROUP BY 
    a.player_id, 
    a.event_date",100000,"select player_id, event_date, sum(games_played) as games_played_so_far from (select a.player_id, a.event_date, b.games_played from schema_534.activity as a left outer join schema_534.activity as b on (a.player_id = b.player_id and b.event_date <= a.event_date)) as a group by player_id, event_date",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
269,534,141,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date asc) as games_played_so_far from schema_534.activity group by 1, 2",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
270,534,142,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date asc rows between unbounded preceding and current row) as games_played_so_far from schema_534.activity",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
271,534,146,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity
ORDER BY player_id, event_date",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date asc) as games_played_so_far from schema_534.activity order by player_id, event_date asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
272,534,147,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity 
ORDER BY player_id, event_date",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date range between unbounded preceding and current row) as games_played_so_far from schema_534.activity order by player_id, event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
273,534,148,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity 
ORDER BY player_id, event_date",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date rows between unbounded preceding and current row) as games_played_so_far from schema_534.activity order by player_id, event_date",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
274,534,160,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity order by player_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
275,534,163,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity 
ORDER BY player_id, event_date",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity order by player_id, event_date desc",100000,0,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
276,534,172,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date range unbounded preceding) as games_played_so_far from schema_534.activity",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
277,534,180,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
278,534,181,Medium,"SELECT player_id, event_date, SUM(games_played) OVER (PARTITION BY player_id ORDER BY event_date) AS games_played_so_far 
FROM schema_534.activity
ORDER BY player_id, event_date",100000,"select player_id, event_date, sum(games_played) over (partition by player_id order by event_date) as games_played_so_far from schema_534.activity as a order by player_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
279,534,212,Medium,"SELECT 
    t1.player_id, 
    t1.event_date, 
    SUM(t2.games_played) AS games_played_so_far 
FROM 
    schema_534.activity t1 
JOIN 
    schema_534.activity t2 
    ON t1.player_id = t2.player_id 
    AND t1.event_date >= t2.event_date 
GROUP BY 
    t1.player_id, 
    t1.event_date",100000,"select t1.player_id, t1.event_date, sum(t2.games_played) as games_played_so_far from schema_534.activity as t1 join schema_534.activity as t2 on t1.player_id = t2.player_id where t1.event_date >= t2.event_date group by t1.player_id, t1.event_date",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
280,534,213,Medium,"SELECT 
    t1.player_id, 
    t1.event_date, 
    (SELECT SUM(t2.games_played) 
     FROM schema_534.activity t2 
     WHERE t2.player_id = t1.player_id AND t2.event_date <= t1.event_date) AS games_played_so_far 
FROM schema_534.activity t1",100000,"select t1.player_id, t1.event_date, sum(t2.games_played) as games_played_so_far from schema_534.activity as t1 left outer join schema_534.activity as t2 on (t1.player_id = t2.player_id and t1.event_date >= t2.event_date) group by t1.event_date, t1.player_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
281,534,215,Medium,"SELECT 
    t2.player_id, 
    t2.event_date, 
    (SELECT SUM(t1.games_played) 
     FROM schema_534.activity t1 
     WHERE t1.player_id = t2.player_id AND t1.event_date <= t2.event_date) AS games_played_so_far
FROM schema_534.activity t2",100000,"select t1.player_id, t2.event_date, sum(t1.games_played) as games_played_so_far from schema_534.activity as t1 join schema_534.activity as t2 on (t1.player_id = t2.player_id and t1.event_date <= t2.event_date) group by 1, 2",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
282,570,10,Medium,"SELECT e2.name 
FROM schema_570.employee e2
WHERE e2.id IN (
    SELECT managerid 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(id) >= 5
)",10819,select e2.name from (select managerid from schema_570.employee group by managerid having count(id) >= 5) as e1 join schema_570.employee as e2 on e2.id = e1.managerid,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
283,570,12,Medium,"SELECT manager.name 
FROM schema_570.employee AS manager 
INNER JOIN (
    SELECT managerid, COUNT(*) AS cnt 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(*) >= 5
) AS subq ON manager.id = subq.managerid",10819,select manager.name from schema_570.employee as manager left outer join schema_570.employee on employee.managerid = manager.id group by manager.id having count(manager.id) >= 5,10819,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
284,570,17,Medium,"SELECT t1.name 
FROM schema_570.employee t1 
WHERE t1.id IN (
    SELECT managerid 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(*) >= 5
)",10819,select name from schema_570.employee as t1 join (select managerid from schema_570.employee group by managerid having count(managerid) >= 5) as t2 on t1.id = t2.managerid,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
285,570,35,Medium,"SELECT m.name 
FROM schema_570.employee m 
JOIN (
    SELECT managerid 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(id) >= 5
) e ON m.id = e.managerid",10819,"select name from schema_570.employee as m join (select managerid, count(id) as c from schema_570.employee group by 1) as e on (m.id = e.managerid and c >= 5)",10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
286,570,45,Medium,"SELECT e1.name 
FROM schema_570.employee e1 
WHERE (SELECT COUNT(*) FROM schema_570.employee e2 WHERE e2.managerid = e1.id) >= 5",10819,select e1.name from schema_570.employee as e1 left outer join schema_570.employee as e2 on e1.id = e2.managerid group by e1.id having count(e2.id) >= 5,10819,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
287,570,56,Medium,"SELECT e2.name 
FROM schema_570.employee e1 
JOIN schema_570.employee e2 ON e1.managerid = e2.id 
GROUP BY e2.id, e2.name 
HAVING COUNT(*) >= 5",10819,select e2.name from schema_570.employee as e1 join schema_570.employee as e2 on e1.managerid = e2.id group by e2.id having count(e2.id) >= 5,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
288,570,62,Medium,"SELECT e.name 
FROM schema_570.employee e
WHERE EXISTS (
    SELECT 1 
    FROM schema_570.employee m 
    WHERE m.managerid = e.id 
    GROUP BY m.managerid 
    HAVING COUNT(m.name) >= 5
)",10819,select name from schema_570.employee join (select managerid from schema_570.employee group by 1 having count(name) >= 5) as t1 on employee.id = t1.managerid,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
289,570,64,Medium,"SELECT l.name 
FROM schema_570.employee l
WHERE EXISTS (
    SELECT 1 
    FROM schema_570.employee r 
    WHERE r.managerid = l.id 
    GROUP BY r.managerid 
    HAVING COUNT(r.managerid) >= 5
);",10819,select name from schema_570.employee as l join (select managerid from schema_570.employee group by managerid having count(managerid) >= 5) as r on l.id = r.managerid,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
290,570,85,Medium,"SELECT e.name
FROM schema_570.employee e
WHERE e.id IN (
    SELECT managerid
    FROM schema_570.employee
    GROUP BY managerid
    HAVING COUNT(DISTINCT id) >= 5
)",10819,select employee.name as name from (select distinct managerid from schema_570.employee group by managerid having count(distinct id) >= 5) as a join schema_570.employee on a.managerid = employee.id,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
291,570,88,Medium,"SELECT e1.name 
FROM schema_570.employee e1 
WHERE (
    SELECT COUNT(DISTINCT e2.id) 
    FROM schema_570.employee e2 
    WHERE e2.managerid = e1.id
) >= 5;",10819,"select name from (select e1.id, e1.name, count(distinct e2.id) as direct_report_count from schema_570.employee as e1 left outer join schema_570.employee as e2 on e2.managerid = e1.id group by 1, 2) as a where direct_report_count >= 5",10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
292,570,93,Medium,"SELECT e1.name 
FROM schema_570.employee e1 
WHERE e1.id IN (
    SELECT managerid 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(*) >= 5
)",10819,select name from schema_570.employee as e1 join (select managerid from schema_570.employee group by managerid having count(managerid) >= 5) as e2 on e1.id = e2.managerid,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
293,570,94,Medium,"SELECT e.name 
FROM schema_570.employee e 
JOIN (
    SELECT managerid 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(id) >= 5
) tbl ON e.id = tbl.managerid",10819,"select name from schema_570.employee as e join (select managerid, count(id) as direct_cnt from schema_570.employee group by 1) as tbl on (e.id = tbl.managerid and tbl.direct_cnt >= 5)",10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
294,570,115,Medium,"SELECT a.name 
FROM schema_570.employee a 
WHERE a.id IN (
    SELECT managerid 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(DISTINCT id) >= 5
)",10819,select a.name from schema_570.employee as a join (select managerid from schema_570.employee group by managerid having count(distinct id) >= 5) as b on a.id = b.managerid,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
295,570,117,Medium,"SELECT a.name 
FROM schema_570.employee a 
WHERE (
    SELECT COUNT(*) 
    FROM schema_570.employee b 
    WHERE b.managerid = a.id
) >= 5;",10819,select a.name from schema_570.employee as a join schema_570.employee as b on a.id = b.managerid group by a.id having count(b.managerid) >= 5,10819,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
296,570,123,Medium,"SELECT b.name 
FROM schema_570.employee AS b 
WHERE b.id IN (
    SELECT managerid 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(*) >= 5
)",10819,select b.name from schema_570.employee as a left outer join schema_570.employee as b on a.managerid = b.id group by b.id having count(b.id) >= 5,10819,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
297,570,140,Medium,"SELECT e.name 
FROM schema_570.employee e
WHERE e.id IN (
    SELECT managerid 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(*) >= 5
)",10819,select e.name from (select managerid as id from schema_570.employee group by managerid having count(id) >= 5) as a join schema_570.employee as e on a.id = e.id,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
298,570,141,Medium,"SELECT e.name 
FROM schema_570.employee e 
JOIN (
    SELECT managerid 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(id) >= 5
) a ON a.managerid = e.id",10819,"select e.name from schema_570.employee as e join (select managerid, count(id) as rep from schema_570.employee group by 1 having count(id) >= 5) as a on a.managerid = e.id",10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
299,570,143,Medium,"SELECT e.name 
FROM schema_570.employee e 
WHERE e.id IN (
    SELECT managerid 
    FROM schema_570.employee 
    GROUP BY managerid 
    HAVING COUNT(id) >= 5
)",10819,"select e.name from schema_570.employee as e join (select managerid, count(id) as cnt from schema_570.employee group by managerid having count(id) >= 5) as sq on e.id = sq.managerid",10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
300,570,151,Medium,"SELECT e1.name 
FROM schema_570.employee e1 
WHERE EXISTS (
    SELECT 1 
    FROM schema_570.employee e2 
    WHERE e2.managerid = e1.id 
    GROUP BY e2.managerid 
    HAVING COUNT(*) > 4
)",10819,select e1.name from schema_570.employee as e1 join (select managerid from schema_570.employee group by managerid having count(managerid) > 4) as e2 on e1.id = e2.managerid,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
301,570,155,Medium,"SELECT e1.name 
FROM schema_570.employee e1 
WHERE (SELECT COUNT(*) FROM schema_570.employee e2 WHERE e2.managerid = e1.id) >= 5",10819,select e1.name from schema_570.employee as e1 join schema_570.employee as e2 on e2.managerid = e1.id group by e1.id having count(e2.id) >= 5,10819,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
302,570,159,Medium,"SELECT e2.name 
FROM schema_570.employee e1 
JOIN schema_570.employee e2 ON e1.managerid = e2.id 
GROUP BY e2.id, e2.name 
HAVING COUNT(DISTINCT e1.id) >= 5",10819,select e2.name from schema_570.employee as e1 join schema_570.employee as e2 on e1.managerid = e2.id group by e2.id having count(distinct e1.id) >= 5,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
303,570,160,Medium,"SELECT e2.name 
FROM schema_570.employee e1 
JOIN schema_570.employee e2 ON e1.managerid = e2.id 
GROUP BY e2.id, e2.name 
HAVING COUNT(*) >= 5",10819,select e2.name from schema_570.employee as e1 join schema_570.employee as e2 on e1.managerid = e2.id group by e2.id having count(e1.id) >= 5,10819,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
304,570,165,Medium,"SELECT e2.name 
FROM schema_570.employee e1 
JOIN schema_570.employee e2 ON e1.managerid = e2.id 
GROUP BY e2.id 
HAVING COUNT(*) >= 5",10819,"select e2.name from schema_570.employee as e1 join schema_570.employee as e2 on e1.managerid = e2.id group by e2.id, e2.name having count(e1.id) >= 5",10819,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
305,570,172,Medium,"SELECT e2.name 
FROM schema_570.employee e1 
JOIN schema_570.employee e2 ON e1.managerid = e2.id 
GROUP BY e2.id, e2.name 
HAVING COUNT(*) >= 5",10819,select e2.name from schema_570.employee as e1 left outer join schema_570.employee as e2 on e1.managerid = e2.id group by e2.id having count(e2.id) >= 5,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
306,570,184,Medium,"SELECT a.name 
FROM schema_570.employee a 
WHERE EXISTS (
    SELECT 1 
    FROM schema_570.employee b 
    WHERE b.managerid = a.id 
    GROUP BY b.managerid 
    HAVING COUNT(b.id) >= 5
)",10819,select name from schema_570.employee as a join (select managerid from schema_570.employee group by 1 having count(id) >= 5) as t on a.id = t.managerid,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
307,570,194,Medium,"SELECT a.name 
FROM schema_570.employee a 
WHERE EXISTS (
    SELECT 1 
    FROM schema_570.employee b 
    WHERE b.managerid = a.id 
    GROUP BY b.managerid 
    HAVING COUNT(*) >= 5
)",10819,select name from schema_570.employee as a join (select managerid from schema_570.employee group by managerid having count(managerid) >= 5) as b on a.id = b.managerid,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
308,570,195,Medium,"SELECT a.name 
FROM schema_570.employee a 
WHERE EXISTS (
    SELECT 1 
    FROM schema_570.employee b 
    WHERE b.managerid = a.id 
    GROUP BY b.managerid 
    HAVING COUNT(*) > 4
)",10819,select name from schema_570.employee as a join (select managerid from schema_570.employee group by managerid having count(managerid) > 4) as b on a.id = b.managerid,10819,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
309,585,58,Medium,"SELECT SUM(tiv_2016) AS tiv_2016
FROM (
    SELECT 
        i1.pid, 
        i1.tiv_2016
    FROM schema_585.insurance i1
    WHERE EXISTS (
        SELECT 1 
        FROM schema_585.insurance i2 
        WHERE i2.pid <> i1.pid AND i2.tiv_2015 = i1.tiv_2015
    )
    AND NOT EXISTS (
        SELECT 1 
        FROM schema_585.insurance i3 
        WHERE i3.pid <> i1.pid 
        AND i3.lat = i1.lat 
        AND i3.lon = i1.lon
    )
) AS sub;",1,"select sum(tiv_2016) as tiv_2016 from (select pid, tiv_2015, count(pid) over (partition by tiv_2015) as ct_2015, tiv_2016, count(pid) over (partition by (cast(lat as varchar) || cast(lon as varchar))) as ct_location from schema_585.insurance) as sub where (ct_2015 > 1 and ct_location = 1)",1,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
310,585,85,Medium,"SELECT SUM(tiv_2016) AS tiv_2016
FROM schema_585.insurance i
WHERE EXISTS (
    SELECT 1 FROM schema_585.insurance 
    WHERE pid != i.pid AND tiv_2015 = i.tiv_2015
) AND NOT EXISTS (
    SELECT 1 FROM schema_585.insurance 
    WHERE pid != i.pid AND lat = i.lat AND lon = i.lon
);",1,"select sum(tiv_2016) as tiv_2016 from (select tiv_2016, count(tiv_2015) over (partition by tiv_2015) as dr1, count(tiv_2015) over (partition by lat, lon) as dr2 from schema_585.insurance) as t where (dr1 >= 2 and dr2 = 1)",1,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
311,585,231,Medium,"SELECT SUM(tiv_2016) AS tiv_2016
FROM schema_585.insurance i
WHERE tiv_2015 IN (
    SELECT tiv_2015
    FROM schema_585.insurance
    GROUP BY tiv_2015
    HAVING COUNT(*) > 1
)
AND (lat, lon) IN (
    SELECT lat, lon
    FROM schema_585.insurance
    GROUP BY lat, lon
    HAVING COUNT(*) = 1
);",1,"select sum(tiv_2016) as tiv_2016 from (select tiv_2015, tiv_2016, lat, lon, count(tiv_2015) over (partition by tiv_2015) as cnt_tiv_2015, count(lat) over (partition by lat, lon) as cnt_lat, count(lon) over (partition by lat, lon) as cnt_lon from schema_585.insurance) as sub where (cnt_tiv_2015 > 1 and cnt_lat = 1 and cnt_lon = 1)",1,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
312,596,2,Easy,"SELECT class FROM (
    SELECT class, COUNT(DISTINCT student) AS student_count 
    FROM schema_596.courses 
    GROUP BY class
) AS subquery 
WHERE student_count >= 5;",11299,select class from schema_596.courses group by class having count(distinct student) >= 5,11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
313,596,4,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,select distinct class from schema_596.courses group by class having count(distinct student) >= 5,11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
314,596,6,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select a.class from (select class, count(distinct student) as mycount from schema_596.courses group by class) as a where a.mycount >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
315,596,7,Easy,"SELECT class FROM (SELECT class, COUNT(DISTINCT student) AS cnt FROM schema_596.courses GROUP BY class) AS subq WHERE cnt >= 5",11299,select a.class from schema_596.courses as a group by a.class having count(distinct a.student) >= 5,11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
316,596,10,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select distinct class, student from schema_596.courses) as t group by class having count(class) >= 5",11299,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
317,596,11,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select distinct student, class from schema_596.courses) as t1 group by class having count(class) >= 5",11299,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
318,596,12,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as count from schema_596.courses group by class) as foo where count >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
319,596,13,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as num from schema_596.courses group by class) as temp_table where num >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
320,596,14,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as num from schema_596.courses group by class) as tmp where num >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
321,596,15,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as count_n from schema_596.courses group by 1) as tmp where count_n >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
322,596,16,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as number from schema_596.courses group by class) as count_table where number >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
323,596,17,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as class_count from schema_596.courses group by class) as s where class_count >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
324,596,21,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select distinct student, class from schema_596.courses) as s group by class having count(class) >= 5",11299,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
325,596,23,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as inner_number_of_values from schema_596.courses group by class) as inner_query where inner_number_of_values >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
326,596,24,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as num from schema_596.courses group by class) as temp where num >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
327,596,26,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as students from schema_596.courses group by 1) as a where students >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
328,596,31,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,select class from schema_596.courses group by 1 having count(distinct student) >= 5,11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
329,596,34,Easy,"SELECT class FROM (
    SELECT class, COUNT(DISTINCT student) AS cnt 
    FROM schema_596.courses 
    GROUP BY class
) subq
WHERE cnt > 4;",11299,select class from schema_596.courses group by class having count(distinct student) > 4,11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
330,596,52,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as num from schema_596.courses group by class) as a where num >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
331,596,53,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as value from schema_596.courses group by class) as t_table where value >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
332,596,60,Easy,"SELECT class FROM (SELECT class, COUNT(DISTINCT student) AS student_count FROM schema_596.courses GROUP BY class) AS subquery WHERE student_count >= 5;",11299,select courses.class from schema_596.courses group by courses.class having count(distinct courses.student) >= 5,11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
333,596,61,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select courses_b.class from (select class, count(distinct student) as num from schema_596.courses group by class) as courses_b where num >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
334,596,62,Easy,"SELECT class 
FROM schema_596.courses 
GROUP BY class 
HAVING COUNT(DISTINCT student) >= 5;",11299,"select sub.class from (select count(distinct student) as counts, class from schema_596.courses group by class) as sub where sub.counts >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
335,596,63,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select t1.class from (select student, class from schema_596.courses group by student, class) as t1 group by t1.class having count(class) >= 5",11299,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
336,596,77,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select a.class from (select distinct student, class from schema_596.courses) as a group by a.class having count(a.class) >= 5",11299,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
337,596,78,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select a.class from (select student, class from schema_596.courses group by student, class) as a group by class having count(class) >= 5",11299,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
338,596,80,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as cclass from schema_596.courses group by class) as c where c.cclass >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
339,596,81,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) > 4,11299,"select class from (select class, count(distinct student) as cnt from schema_596.courses group by class) as a where cnt > 4",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
340,596,84,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as num from schema_596.courses group by class) as tmp_table where num >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
341,596,86,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) > 4,11299,"select class from (select class, count(distinct student) as num from schema_596.courses group by class) as temp_table where num > 4",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
342,596,89,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select distinct student, class from schema_596.courses) as t group by class having count(class) >= 5",11299,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
343,596,90,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as numstudents from schema_596.courses group by class) as counter where numstudents >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
344,596,91,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as num from schema_596.courses group by class) as temptable where num >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
345,596,92,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as a from schema_596.courses group by class) as t where a >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
346,596,93,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as abc from schema_596.courses group by class) as q where q.abc >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
347,596,95,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as cnt from schema_596.courses group by class) as temp where cnt >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
348,596,96,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as n from schema_596.courses group by class) as a where n >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
349,596,99,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as num from schema_596.courses group by class) as tempt where num >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
350,596,102,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as numstu from schema_596.courses group by class) as a where numstu >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
351,596,103,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as sc from schema_596.courses group by 1) as a where sc >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
352,596,104,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as tot_count from schema_596.courses group by class) as a where tot_count >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
353,596,107,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select class, count(distinct student) as mycount from schema_596.courses group by class) as a where mycount >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
354,596,108,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) > 4,11299,"select class from (select count(distinct student) as cnt, class from schema_596.courses group by class) as a where cnt > 4",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
355,596,109,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select count(distinct student) as student_count, class from schema_596.courses group by class) as a where student_count >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
356,596,115,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select class from (select distinct student, class from schema_596.courses) as a group by class having count(class) >= 5",11299,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
357,596,145,Easy,SELECT class FROM schema_596.courses GROUP BY class HAVING COUNT(DISTINCT student) >= 5,11299,"select t.class from (select class, count(distinct student) as count from schema_596.courses group by class) as t where count >= 5",11299,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
358,614,2,Medium,"SELECT a.follower AS follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON a.follower = b.followee 
GROUP BY a.follower 
ORDER BY follower",25020,"select aa.followee as follower, count(distinct aa.follower) as num from (select a.follower as followee, b.follower as follower from schema_614.follow as a join schema_614.follow as b on a.follower = b.followee) as aa group by aa.followee order by follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
359,614,3,Medium,"SELECT f1.follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f1 
JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f1.follower 
ORDER BY f1.follower",25020,"select distinct f1.follower, count(distinct f2.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by f1.follower order by f1.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
360,614,14,Medium,"SELECT f1.follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f1 
JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f1.follower",25020,"select f1.follower, count(distinct f2.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by f1.follower",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
361,614,17,Medium,"SELECT t1.follower AS follower, COUNT(DISTINCT t2.follower) AS num 
FROM schema_614.follow t1 
JOIN schema_614.follow t2 ON t1.follower = t2.followee 
GROUP BY t1.follower 
ORDER BY t1.follower",25020,"select t1.follower as follower, count(distinct t2.follower) as num from schema_614.follow as t1 join schema_614.follow as t2 on t1.follower = t2.followee group by t1.follower order by t1.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
362,614,19,Medium,"SELECT a.followee AS follower, COUNT(DISTINCT a.follower) AS num 
FROM schema_614.follow AS a 
WHERE EXISTS (SELECT 1 FROM schema_614.follow AS b WHERE a.followee = b.follower) 
GROUP BY a.followee",25020,"select a.followee as follower, count(distinct a.follower) as num from schema_614.follow as a join schema_614.follow as b on a.followee = b.follower group by 1 having count(distinct a.follower) > 0",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
363,614,24,Medium,"SELECT a.follower AS follower, COUNT(b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON a.follower = b.followee 
GROUP BY a.follower",25020,"select a.follower as follower, count(distinct b.follower) as num from schema_614.follow as a join schema_614.follow as b on a.follower = b.followee group by a.follower",25020,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The queries differ because the initial query counts only unique second-level followers using COUNT(DISTINCT b.follower), while the improved may overcount due to duplicate entries without DISTINCT"
364,614,25,Medium,"SELECT a.follower AS follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON a.follower = b.followee 
GROUP BY a.follower 
ORDER BY a.follower",25020,"select a.follower as follower, count(distinct b.follower) as num from schema_614.follow as a join schema_614.follow as b on a.follower = b.followee group by a.follower order by a.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
365,614,27,Medium,"SELECT a.follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON a.follower = b.followee 
GROUP BY a.follower",25020,"select a.follower, count(distinct b.follower) as num from schema_614.follow as a join schema_614.follow as b on a.follower = b.followee group by a.follower",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
366,614,28,Medium,"SELECT a.follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON a.follower = b.followee 
GROUP BY a.follower",25020,"select a.follower, count(distinct b.follower) as num from schema_614.follow as a join schema_614.follow as b on a.follower = b.followee group by 1",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
367,614,31,Medium,"SELECT a.follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow AS a 
JOIN schema_614.follow AS b ON a.follower = b.followee 
GROUP BY a.follower 
ORDER BY a.follower",25020,"select a.follower, count(distinct b.follower) as num from schema_614.follow as a join schema_614.follow as b on a.follower = b.followee group by a.follower order by a.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
368,614,34,Medium,"SELECT a.follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON a.follower = b.followee 
GROUP BY a.follower 
ORDER BY a.follower",25020,"select a.follower, count(distinct b.follower) as num from schema_614.follow as a join schema_614.follow as b on a.follower = b.followee group by a.follower having count(b.follower) >= 1 order by a.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
369,614,35,Medium,"SELECT a.follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON a.follower = b.followee 
GROUP BY a.follower",25020,"select a.follower, count(distinct b.follower) as num from schema_614.follow as a left outer join schema_614.follow as b on a.follower = b.followee group by a.follower having count(distinct b.follower) > 0",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
370,614,36,Medium,"SELECT b.followee AS follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON a.follower = b.followee 
GROUP BY b.followee 
ORDER BY b.followee",25020,"select distinct b.followee as follower, count(distinct b.follower) as num from schema_614.follow as a join schema_614.follow as b on a.follower = b.followee group by a.follower, b.followee order by b.followee",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
371,614,40,Medium,"SELECT f.follower AS follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f 
JOIN schema_614.follow f2 ON f.follower = f2.followee 
GROUP BY f.follower 
ORDER BY f.follower;",25020,"select f.follower as follower, count(distinct f2.follower) as num from schema_614.follow as f join schema_614.follow as f2 on f.follower = f2.followee group by f.follower order by f.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
372,614,41,Medium,"SELECT f.follower, COUNT(DISTINCT ff.follower) AS num 
FROM schema_614.follow f 
JOIN schema_614.follow ff ON f.follower = ff.followee 
GROUP BY f.follower",25020,"select f.follower, count(distinct ff.follower) as num from schema_614.follow as f join schema_614.follow as ff on f.follower = ff.followee group by f.follower",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
373,614,42,Medium,"SELECT f.follower, COUNT(DISTINCT f1.follower) AS num 
FROM schema_614.follow f 
JOIN schema_614.follow f1 ON f.follower = f1.followee 
GROUP BY f.follower 
ORDER BY f.follower;",25020,"select f.follower, count(distinct f1.follower) as num from schema_614.follow as f join schema_614.follow as f1 on f.follower = f1.followee group by f.follower order by f.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
374,614,45,Medium,"SELECT f1.followee AS follower, COUNT(DISTINCT f1.follower) AS num 
FROM schema_614.follow f1 
WHERE EXISTS (SELECT 1 FROM schema_614.follow f2 WHERE f1.followee = f2.follower) 
GROUP BY f1.followee 
ORDER BY f1.followee",25020,"select f1.followee as follower, count(distinct f1.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.followee = f2.follower group by f1.followee order by f1.followee",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
375,614,51,Medium,"SELECT f1.follower, COUNT(DISTINCT f2.follower) AS num 
FROM (SELECT follower FROM schema_614.follow GROUP BY follower) AS f1 
JOIN schema_614.follow AS f2 ON f1.follower = f2.followee 
GROUP BY f1.follower 
ORDER BY f1.follower",25020,"select f1.follower, count(distinct f2.follower) as num from (select distinct follower from schema_614.follow) as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by f1.follower order by f1.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
376,614,52,Medium,"SELECT f1.follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f1 
JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f1.follower 
ORDER BY f1.follower",25020,"select f1.follower, count(distinct f2.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by f1.follower order by f1.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
377,614,73,Medium,"SELECT f2.followee AS follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f1 
INNER JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f2.followee",25020,"select f2.followee as follower, count(distinct f2.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by f2.followee",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
378,614,108,Medium,"SELECT t1.follower AS follower, COUNT(DISTINCT t2.follower) AS num 
FROM schema_614.follow t1 
JOIN schema_614.follow t2 ON t1.follower = t2.followee 
GROUP BY t1.follower",25020,"select t1.follower as follower, count(distinct t2.follower) as num from schema_614.follow as t1 join schema_614.follow as t2 on t1.follower = t2.followee group by t1.follower",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
379,614,110,Medium,"SELECT t1.follower, COUNT(DISTINCT t2.follower) AS num 
FROM schema_614.follow t1 
JOIN schema_614.follow t2 ON t1.follower = t2.followee 
GROUP BY t1.follower",25020,"select t1.follower, count(distinct t2.follower) as num from schema_614.follow as t1 join schema_614.follow as t2 on t1.follower = t2.followee group by t1.follower",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
380,614,113,Medium,"SELECT tfollower.follower, COUNT(t2nddegreefollower.follower) AS num 
FROM schema_614.follow AS tfollower 
JOIN schema_614.follow AS t2nddegreefollower ON tfollower.follower = t2nddegreefollower.followee 
GROUP BY tfollower.follower",25020,"select tfollower.follower, count(distinct t2nddegreefollower.follower) as num from schema_614.follow as tfollower left outer join schema_614.follow as t2nddegreefollower on tfollower.follower = t2nddegreefollower.followee group by tfollower.follower having count(distinct t2nddegreefollower.follower) > 0",25020,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,
381,614,121,Medium,"SELECT f.follower, COUNT(DISTINCT f1.follower) AS num 
FROM schema_614.follow f 
JOIN schema_614.follow f1 ON f.follower = f1.followee 
GROUP BY f.follower",25020,"select f.follower, count(distinct f1.follower) as num from schema_614.follow as f join schema_614.follow as f1 on f.follower = f1.followee group by f.follower",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
382,614,129,Medium,"SELECT f1.follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f1 
JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f1.follower",25020,"select f1.follower, count(distinct f2.follower) as num from schema_614.follow as f1 left outer join schema_614.follow as f2 on f1.follower = f2.followee group by f1.follower having count(distinct f2.follower) > 0",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
383,614,146,Medium,"SELECT a.follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON a.follower = b.followee 
GROUP BY a.follower",25020,"select a.follower, count(distinct b.follower) as num from schema_614.follow as a left outer join schema_614.follow as b on a.follower = b.followee group by a.follower having count(b.follower) > 0",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
384,614,153,Medium,"SELECT a.followee AS follower, COUNT(DISTINCT a.follower) AS num 
FROM schema_614.follow a 
WHERE EXISTS (SELECT 1 FROM schema_614.follow b WHERE b.follower = a.followee) 
GROUP BY a.followee",25020,"select a.followee as follower, count(distinct a.follower) as num from schema_614.follow as a join (select distinct follower from schema_614.follow) as b on a.followee = b.follower group by a.followee",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
385,614,155,Medium,"SELECT a.followee AS follower, COUNT(DISTINCT a.follower) AS num 
FROM schema_614.follow AS a 
WHERE EXISTS (SELECT 1 FROM schema_614.follow WHERE follower = a.followee) 
GROUP BY a.followee 
ORDER BY a.followee",25020,"select a.followee as follower, count(distinct a.follower) as num from schema_614.follow as a join (select follower from schema_614.follow) as t on a.followee = t.follower group by a.followee order by a.followee",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
386,614,163,Medium,"SELECT a.follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON b.followee = a.follower 
GROUP BY a.follower",25020,"select a.follower, count(distinct b.follower) as num from schema_614.follow as a join schema_614.follow as b on b.followee = a.follower group by a.follower",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
387,614,197,Medium,"SELECT b.follower, COUNT(DISTINCT a.follower) AS num 
FROM schema_614.follow b 
JOIN schema_614.follow a ON a.followee = b.follower 
GROUP BY b.follower",25020,"select b.follower, count(distinct a.follower) as num from schema_614.follow as a join schema_614.follow as b on a.followee = b.follower group by 1",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
388,614,200,Medium,"SELECT a.follower, b.num 
FROM schema_614.follow a 
JOIN (
    SELECT followee, COUNT(DISTINCT follower) AS num 
    FROM schema_614.follow 
    GROUP BY followee
) b ON a.follower = b.followee 
GROUP BY a.follower, b.num 
ORDER BY a.follower",25020,"select distinct a.follower as follower, num from schema_614.follow as a join (select followee, count(distinct follower) as num from schema_614.follow group by followee) as b on a.follower = b.followee order by a.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
389,614,212,Medium,"SELECT DISTINCT f1.follower, f2.num 
FROM schema_614.follow f1
JOIN (
    SELECT followee, COUNT(DISTINCT follower) AS num 
    FROM schema_614.follow 
    GROUP BY followee
) f2 ON f1.follower = f2.followee 
ORDER BY f1.follower",25020,"select distinct follower, num from schema_614.follow join (select followee, count(distinct follower) as num from schema_614.follow group by followee) as f3 on follow.follower = f3.followee order by follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
390,614,220,Medium,"SELECT f.follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f 
JOIN schema_614.follow f2 ON f.follower = f2.followee 
GROUP BY f.follower",25020,"select f.follower, count(distinct f2.follower) as num from schema_614.follow as f join schema_614.follow as f2 on f.follower = f2.followee group by 1",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
391,614,222,Medium,"SELECT f.follower, COUNT(DISTINCT f1.follower) AS num 
FROM schema_614.follow f 
JOIN schema_614.follow f1 ON f.follower = f1.followee 
GROUP BY f.follower",25020,"select f.follower, count(distinct f1.follower) as num from schema_614.follow as f join schema_614.follow as f1 on f.follower = f1.followee group by 1",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
392,614,225,Medium,"SELECT f1.followee AS follower, COUNT(DISTINCT f1.follower) AS num 
FROM schema_614.follow f1 
WHERE EXISTS (SELECT 1 FROM schema_614.follow f2 WHERE f1.followee = f2.follower) 
GROUP BY f1.followee",25020,"select f1.followee as follower, count(distinct f1.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.followee = f2.follower group by f1.followee",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
393,614,228,Medium,"SELECT f1.followee AS follower, COUNT(DISTINCT f1.follower) AS num 
FROM schema_614.follow f1 
WHERE EXISTS (SELECT 1 FROM schema_614.follow f2 WHERE f2.follower = f1.followee)
GROUP BY f1.followee",25020,"select f1.followee as follower, count(distinct f1.follower) as num from (select followee, follower from schema_614.follow) as f1 join (select follower from schema_614.follow) as f2 on f1.followee = f2.follower group by f1.followee",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
394,614,235,Medium,"SELECT f1.follower, COUNT(DISTINCT f2.follower) AS num 
FROM (SELECT DISTINCT follower FROM schema_614.follow) f1 
LEFT JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f1.follower 
ORDER BY f1.follower ASC",49999,"select f1.follower, count(distinct f2.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by f1.follower order by f1.follower asc",25020,24979,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,"The initial query returns only users who have at least one second-level follower, while the optimized query also includes users with zero, using a LEFT JOIN."
395,614,237,Medium,"SELECT f1.follower AS follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f1 
JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f1.follower",25020,"select f1.follower as follower, count(distinct f2.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by f1.follower",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
396,614,239,Medium,"SELECT f1.follower AS follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f1 
JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f1.follower 
ORDER BY f1.follower;",25020,"select f1.follower as follower, count(distinct f2.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by f1.follower order by f1.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
397,614,245,Medium,"SELECT f1.follower AS follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f1 
JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f1.follower",25020,"select f1.follower as follower, count(distinct f2.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by 1",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
398,614,258,Medium,"SELECT f1.follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f1 
JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f1.follower",25020,"select f1.follower, count(distinct f2.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by 1",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
399,614,290,Medium,"SELECT f2.followee AS follower, COUNT(DISTINCT f2.follower) AS num 
FROM schema_614.follow f1 
INNER JOIN schema_614.follow f2 ON f1.follower = f2.followee 
GROUP BY f2.followee 
ORDER BY f2.followee",25020,"select f2.followee as follower, count(distinct f2.follower) as num from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee group by f2.followee order by f2.followee",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
400,614,338,Medium,"SELECT followee AS follower, COUNT(DISTINCT follower) AS num 
FROM schema_614.follow 
WHERE followee IN (SELECT DISTINCT follower FROM schema_614.follow)
GROUP BY followee",25020,"select followee as follower, count(distinct follower) as num from schema_614.follow as f join (select distinct follower as dfs from schema_614.follow) as df on f.followee = df.dfs group by followee",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
401,614,358,Medium,"SELECT followee.follower, COUNT(DISTINCT follower.follower) AS num 
FROM schema_614.follow AS followee 
JOIN schema_614.follow AS follower ON followee.follower = follower.followee 
GROUP BY followee.follower 
ORDER BY followee.follower",25020,"select followee.follower, count(distinct follower.follower) as num from schema_614.follow as followee join schema_614.follow as follower on followee.follower = follower.followee group by followee.follower order by followee.follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
402,614,360,Medium,"SELECT a.follower, COUNT(DISTINCT b.follower) AS num 
FROM schema_614.follow a 
JOIN schema_614.follow b ON a.follower = b.followee 
GROUP BY a.follower",25020,"select follower, count(distinct follower_follower) as num from (select a.follower, b.follower as follower_follower from schema_614.follow as a join schema_614.follow as b on a.follower = b.followee) as c group by follower",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
403,614,363,Medium,"SELECT f.follower, COUNT(DISTINCT f2.follower) AS num
FROM schema_614.follow f
JOIN schema_614.follow f2 ON f.follower = f2.followee
GROUP BY f.follower
ORDER BY f.follower",25020,"select followers.follower, followees.num from (select follower from schema_614.follow group by follower) as followers join (select followee, count(distinct follower) as num from schema_614.follow group by followee) as followees on followers.follower = followees.followee order by follower",25020,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
404,614,365,Medium,"SELECT fwe.follower, COUNT(DISTINCT fwer.follower) AS num 
FROM schema_614.follow fwe 
JOIN schema_614.follow fwer ON fwe.follower = fwer.followee 
GROUP BY fwe.follower",25020,"select fwe.follower, count(distinct fwer.follower) as num from schema_614.follow as fwe join schema_614.follow as fwer on fwe.follower = fwer.followee group by fwe.follower",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
405,614,366,Medium,"SELECT f2.followee AS follower, COUNT(DISTINCT f2.follower) AS num
FROM schema_614.follow f1
JOIN schema_614.follow f2 ON f1.follower = f2.followee
GROUP BY f2.followee
HAVING COUNT(DISTINCT f2.follower) >= 1",25020,"select g.f2f as follower, count(distinct g.f2wer) as num from (select f1.followee as f1f, f1.follower as f1wer, f2.followee as f2f, f2.follower as f2wer from schema_614.follow as f1 join schema_614.follow as f2 on f1.follower = f2.followee) as g group by g.f2f having count(distinct g.f2wer) >= 1",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
406,614,367,Medium,"SELECT a.followee AS follower, COUNT(DISTINCT a.follower) AS num 
FROM schema_614.follow AS a 
WHERE EXISTS (SELECT 1 FROM schema_614.follow AS b WHERE a.followee = b.follower) 
GROUP BY a.followee",25020,"select subquery.followee as follower, count(distinct subquery.follower) as num from (select a.followee, a.follower from schema_614.follow as a join schema_614.follow as b on a.followee = b.follower) as subquery group by subquery.followee",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
407,614,369,Medium,"SELECT t1.followee AS follower, COUNT(DISTINCT t1.follower) AS num 
FROM schema_614.follow t1 
WHERE EXISTS (SELECT 1 FROM schema_614.follow t2 WHERE t1.followee = t2.follower) 
GROUP BY t1.followee",25020,"select t1.followee as follower, count(distinct t1.follower) as num from schema_614.follow as t1 join (select distinct follower from schema_614.follow) as t2 on t1.followee = t2.follower group by t1.followee",25020,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
408,614,372,Medium,"SELECT tb1.follower AS follower, COUNT(tb2.follower) AS num 
FROM schema_614.follow tb1 
JOIN (SELECT DISTINCT followee, follower FROM schema_614.follow) tb2 
ON tb1.follower = tb2.followee 
GROUP BY tb1.follower",25020,"select tb1.follower as follower, count(distinct tb2.follower) as num from schema_614.follow as tb1 join schema_614.follow as tb2 on tb1.follower = tb2.followee group by 1",25020,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The initial query guarantees accuracy by using COUNT(DISTINCT ...), while the optimized query overcounts due to missing DISTINCT in the outer aggregation."
409,1050,4,Easy,"SELECT actor_id, director_id 
FROM (
    SELECT actor_id, director_id, COUNT(timestamp) as cnt
    FROM schema_1050.actordirector
    GROUP BY actor_id, director_id
) subq
WHERE cnt >= 3;",19314,"select a.actor_id, a.director_id from schema_1050.actordirector as a group by a.actor_id, a.director_id having count(a.timestamp) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
410,1050,5,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(timestamp) >= 3",19314,"select a.actor_id, a.director_id from (select actor_id, director_id, count(timestamp) as cooperation from schema_1050.actordirector group by actor_id, director_id) as a where a.cooperation >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
411,1050,13,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(timestamp) >= 3",19314,"select actor_id, director_id from (select actor_id, director_id, count(timestamp) as cooperated_frq from schema_1050.actordirector group by 1, 2) as a where a.cooperated_frq >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
412,1050,15,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(*) > 2",19314,"select actor_id, director_id from schema_1050.actordirector group by 1, 2 having count(timestamp) > 2",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
413,1050,16,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(*) >= 3",19314,"select actor_id, director_id from schema_1050.actordirector group by 1, 2 having count(distinct timestamp) >= 3",19314,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
414,1050,17,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(*) >= 3",19314,"select actor_id, director_id from schema_1050.actordirector group by 1, 2 having count(timestamp) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
415,1050,25,Easy,"SELECT actor_id, director_id 
FROM (
    SELECT actor_id, director_id, COUNT(DISTINCT timestamp) AS cnt
    FROM schema_1050.actordirector
    GROUP BY actor_id, director_id
) subquery
WHERE cnt > 2",19314,"select actor_id, director_id from schema_1050.actordirector group by actor_id, director_id having count(distinct timestamp) > 2",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
416,1050,26,Easy,"SELECT actor_id, director_id 
FROM (
    SELECT actor_id, director_id, COUNT(*) as cnt
    FROM schema_1050.actordirector
    GROUP BY actor_id, director_id
) subquery
WHERE cnt >= 3;",19314,"select actor_id, director_id from schema_1050.actordirector group by actor_id, director_id having count(actor_id) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
417,1050,27,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(*) >= 3;",19314,"select actor_id, director_id from schema_1050.actordirector group by actor_id, director_id having (count(actor_id) >= 3 and count(director_id) >= 3)",19314,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
418,1050,29,Easy,"SELECT actor_id, director_id 
FROM (
    SELECT actor_id, director_id, COUNT(*) as cnt 
    FROM schema_1050.actordirector 
    GROUP BY actor_id, director_id
) subquery 
WHERE cnt >= 3",19314,"select actor_id, director_id from schema_1050.actordirector group by actor_id, director_id having count(director_id) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
419,1050,31,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(*) >= 3",19314,"select actor_id, director_id from schema_1050.actordirector group by actor_id, director_id having count(timestamp) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
420,1050,41,Easy,"SELECT actor_id, director_id 
FROM (
    SELECT actor_id, director_id, COUNT(DISTINCT timestamp) as cnt
    FROM schema_1050.actordirector
    GROUP BY actor_id, director_id
) subq
WHERE cnt >= 3;",19314,"select actor_id, director_id from schema_1050.actordirector as a group by actor_id, director_id having count(distinct timestamp) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
421,1050,44,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector
GROUP BY actor_id, director_id
HAVING COUNT(*) >= 3",19314,"select actor_id, director_id from schema_1050.actordirector as a group by actor_id, director_id having count(timestamp) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
422,1050,54,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(timestamp) >= 3",19314,"select t1.actor_id, t1.director_id from (select actor_id, director_id, count(timestamp) as times_cooperated from schema_1050.actordirector group by 1, 2) as t1 where t1.times_cooperated >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
423,1050,56,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(*) >= 3",19314,"select actor_id, director_id from schema_1050.actordirector group by 1, 2 having count(actor_id) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
424,1050,59,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(*) > 2",19314,"select actor_id, director_id from schema_1050.actordirector group by actor_id, director_id having count(timestamp) > 2",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
425,1050,62,Easy,"SELECT actor_id, director_id 
FROM (
    SELECT actor_id, director_id, COUNT(DISTINCT timestamp) as cnt
    FROM schema_1050.actordirector
    GROUP BY actor_id, director_id
) subquery
WHERE cnt >= 3",19314,"select actor_id, director_id from schema_1050.actordirector group by actor_id, director_id having count(distinct timestamp) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
426,1050,67,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(timestamp) >= 3;",19314,"select a.actor_id, a.director_id from (select actor_id, director_id, count(timestamp) as cnt from schema_1050.actordirector as a group by actor_id, director_id) as a where a.cnt >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
427,1050,68,Easy,"SELECT actor_id, director_id 
FROM (
    SELECT actor_id, director_id, COUNT(timestamp) as cnt
    FROM schema_1050.actordirector
    GROUP BY actor_id, director_id
) subq
WHERE cnt >= 3;",19314,"select a1.actor_id, a1.director_id from schema_1050.actordirector as a1 group by a1.actor_id, a1.director_id having count(a1.timestamp) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
428,1050,73,Easy,"SELECT actor_id, director_id 
FROM (
    SELECT actor_id, director_id, COUNT(*) as cnt 
    FROM schema_1050.actordirector 
    GROUP BY actor_id, director_id
) subquery
WHERE cnt >= 3;",19314,"select actor_id as actor_id, director_id as director_id from schema_1050.actordirector group by actor_id, director_id having count(director_id) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
429,1050,83,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(timestamp) >= 3;",19314,"select actor_id, director_id from (select actor_id, director_id, count(timestamp) as times from schema_1050.actordirector group by actor_id, director_id) as timestable where times >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
430,1050,84,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector
GROUP BY actor_id, director_id 
HAVING COUNT(timestamp) >= 3",19314,"select actor_id, director_id from schema_1050.actordirector as a group by 1, 2 having count(a.timestamp) >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
431,1050,148,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(*) > 2",19314,"select actor_id, director_id from schema_1050.actordirector group by actor_id, director_id having count(actor_id) > 2",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
432,1050,149,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(DISTINCT timestamp) >= 3;",19314,"select distinct a.actor_id, a.director_id from (select actor_id, director_id, count(distinct timestamp) as co_times from schema_1050.actordirector group by actor_id, director_id) as a where co_times >= 3",19314,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
433,1050,151,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(*) >= 3",19314,"select distinct actor_id, director_id from (select actor_id, director_id, count(actor_id) over (partition by actor_id, director_id order by actor_id, director_id) as cnt from schema_1050.actordirector) as a where cnt >= 3",19314,0,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,Equivalent query,
434,1050,152,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(timestamp) >= 3",19314,"select distinct actor_id, director_id from schema_1050.actordirector group by 1, 2 having count(timestamp) >= 3",19314,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
435,1050,153,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(*) >= 3",19314,"select distinct actor_id, director_id from schema_1050.actordirector group by actor_id, director_id having count(timestamp) >= 3",19314,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
436,1050,154,Easy,"SELECT actor_id, director_id 
FROM schema_1050.actordirector 
GROUP BY actor_id, director_id 
HAVING COUNT(timestamp) >= 3;",19314,"select distinct x.actor_id, x.director_id from schema_1050.actordirector as x join (select actor_id, director_id, count(timestamp) as freq from schema_1050.actordirector group by actor_id, director_id) as y on (x.actor_id = y.actor_id and x.director_id = y.director_id and y.freq >= 3)",19314,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
437,1068,5,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s
JOIN schema_1068.product p ON p.product_id = s.product_id;",100000,"select p.product_name, s.year, s.price from schema_1068.product as p join schema_1068.sales as s on p.product_id = s.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
438,1068,7,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
JOIN schema_1068.product p ON s.product_id = p.product_id",100000,"select p.product_name, s.year, s.price from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
439,1068,9,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
JOIN schema_1068.product p ON s.product_id = p.product_id 
ORDER BY s.product_id",100000,"select p.product_name, s.year, s.price from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id order by p.product_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
440,1068,10,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
INNER JOIN schema_1068.product p ON p.product_id = s.product_id",100000,"select p.product_name, s.year, s.price from schema_1068.sales as s left outer join schema_1068.product as p on p.product_id = s.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
441,1068,11,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
INNER JOIN schema_1068.product p ON s.product_id = p.product_id;",100000,"select p.product_name, s.year, s.price from schema_1068.sales as s left outer join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
442,1068,14,Easy,"SELECT product.product_name, sales.year, sales.price 
FROM schema_1068.sales 
JOIN schema_1068.product USING (product_id);",100000,"select product.product_name, sales.year, sales.price from schema_1068.product join schema_1068.sales on product.product_id = sales.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
443,1068,16,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
JOIN schema_1068.product p ON p.product_id = s.product_id",100000,"select product.product_name, sales.year, sales.price from schema_1068.sales join schema_1068.product on product.product_id = sales.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
444,1068,17,Easy,"SELECT product.product_name, sales.year, sales.price 
FROM schema_1068.sales 
INNER JOIN schema_1068.product USING (product_id)",100000,"select product.product_name, sales.year, sales.price from schema_1068.sales join schema_1068.product on sales.product_id = product.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
445,1068,18,Easy,"SELECT product.product_name, sales.year, sales.price 
FROM schema_1068.sales 
LEFT JOIN schema_1068.product USING (product_id)",100000,"select product.product_name, sales.year, sales.price from schema_1068.sales left outer join schema_1068.product on sales.product_id = product.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
446,1068,21,Easy,"SELECT b.product_name, a.year, a.price 
FROM schema_1068.sales a 
JOIN schema_1068.product b ON a.product_id = b.product_id;",100000,"select b.product_name, a.year, a.price from schema_1068.sales as a left outer join schema_1068.product as b on a.product_id = b.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
447,1068,25,Easy,"SELECT b.product_name, a.year, a.price 
FROM schema_1068.sales a 
JOIN schema_1068.product b USING (product_id)",100000,"select b.product_name, a.year, a.price from schema_1068.sales as a join schema_1068.product as b on a.product_id = b.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
448,1068,26,Easy,"SELECT b.product_name, a.year, a.price 
FROM schema_1068.sales a 
JOIN schema_1068.product b ON a.product_id = b.product_id;",100000,"select c.product_name, c.year, c.price from (select a.year, a.price, b.product_name from schema_1068.sales as a join schema_1068.product as b on a.product_id = b.product_id) as c",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
449,1068,27,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
INNER JOIN schema_1068.product p ON p.product_id = s.product_id",100000,"select p.product_name, s.year, s.price from schema_1068.sales as s join schema_1068.product as p on p.product_id = s.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
450,1068,28,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
INNER JOIN schema_1068.product p ON s.product_id = p.product_id",100000,"select p.product_name as product_name, s.year as year, s.price as price from schema_1068.sales as s left outer join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
451,1068,32,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
LEFT JOIN schema_1068.product p ON s.product_id = p.product_id;",100000,"select p.product_name, s.year, s.price from (select distinct sale_id, product_id, year, price from schema_1068.sales) as s left outer join schema_1068.product as p on s.product_id = p.product_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
452,1068,33,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
JOIN schema_1068.product p ON s.product_id = p.product_id;",100000,"select p.product_name, s.year, s.price from (select distinct sale_id, product_id, year, price from schema_1068.sales) as s join schema_1068.product as p on s.product_id = p.product_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
453,1068,61,Easy,"SELECT p2.product_name, p1.year, p1.price 
FROM schema_1068.sales p1 
LEFT JOIN schema_1068.product p2 ON p1.product_id = p2.product_id;",100000,"select p2.product_name as product_name, p1.year as year, p1.price as price from schema_1068.sales as p1 left outer join schema_1068.product as p2 on p1.product_id = p2.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
454,1068,65,Easy,"SELECT product_name, year, price 
FROM schema_1068.sales 
JOIN schema_1068.product USING (product_id)",100000,"select product_name, year, price from schema_1068.product join schema_1068.sales on product.product_id = sales.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
455,1068,66,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s
JOIN schema_1068.product p USING (product_id);",100000,"select product_name, year, price from schema_1068.product as p join schema_1068.sales as s on p.product_id = s.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
456,1068,68,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
LEFT JOIN schema_1068.product p ON s.product_id = p.product_id",100000,"select product_name, year, price from schema_1068.sales as s left outer join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
457,1068,70,Easy,"SELECT product_name, year, price 
FROM schema_1068.sales 
JOIN schema_1068.product USING (product_id)",100000,"select product_name, year, price from schema_1068.sales join schema_1068.product on sales.product_id = product.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
458,1068,73,Easy,"SELECT product_name, year, price 
FROM schema_1068.sales 
JOIN schema_1068.product USING (product_id)",100000,"select product_name, year, price from schema_1068.sales join schema_1068.product on product.product_id = sales.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
459,1068,77,Easy,"SELECT product_name, year, price 
FROM schema_1068.sales 
LEFT JOIN schema_1068.product USING (product_id)",100000,"select product_name, year, price from schema_1068.sales left outer join schema_1068.product on product.product_id = sales.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
460,1068,78,Easy,"SELECT product_name, year, price 
FROM schema_1068.sales 
LEFT JOIN schema_1068.product USING (product_id)",100000,"select product_name, year, price from schema_1068.sales left outer join schema_1068.product on sales.product_id = product.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
461,1068,81,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
INNER JOIN schema_1068.product p ON p.product_id = s.product_id",100000,"select product_name, year, price from schema_1068.sales as s join schema_1068.product as p on p.product_id = s.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
462,1068,82,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
INNER JOIN schema_1068.product p ON s.product_id = p.product_id",100000,"select product_name, year, price from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
463,1068,93,Easy,"SELECT product_name, year, price 
FROM schema_1068.sales AS s 
JOIN schema_1068.product AS p ON s.product_id = p.product_id 
ORDER BY year
LIMIT 100000;",100000,"select product_name, year, price from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id order by year",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
464,1068,94,Easy,"SELECT product_name, year, price 
FROM schema_1068.sales AS s 
LEFT OUTER JOIN schema_1068.product AS p ON s.product_id = p.product_id 
ORDER BY year, product_name, price",100000,"select product_name, year, price from schema_1068.sales as s left outer join schema_1068.product as p on s.product_id = p.product_id order by year",100000,0,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
465,1068,98,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
LEFT JOIN schema_1068.product p ON s.product_id = p.product_id",100000,"select product_name, year, price from (select sale_id, s.product_id, year, quantity, price, product_name from schema_1068.sales as s left outer join schema_1068.product as p on s.product_id = p.product_id) as a",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
466,1068,102,Easy,"SELECT p2.product_name, p1.year, p1.price 
FROM schema_1068.sales p1 
LEFT JOIN schema_1068.product p2 ON p1.product_id = p2.product_id",100000,"select product_name, year, price from schema_1068.sales as p1 left outer join schema_1068.product as p2 on p1.product_id = p2.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
467,1068,104,Easy,"SELECT r.product_name, l.year, l.price 
FROM schema_1068.sales l 
JOIN schema_1068.product r USING (product_id)",100000,"select r.product_name, l.year, l.price from schema_1068.sales as l join schema_1068.product as r on l.product_id = r.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
468,1068,105,Easy,"SELECT t2.product_name, t1.year, t1.price 
FROM schema_1068.sales t1 
JOIN schema_1068.product t2 USING (product_id);",100000,"select t2.product_name, t1.year, t1.price from schema_1068.sales as t1 join schema_1068.product as t2 on t1.product_id = t2.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
469,1068,106,Easy,"SELECT t2.product_name, t1.year, t1.price FROM schema_1068.sales t1 LEFT JOIN schema_1068.product t2 ON t1.product_id = t2.product_id ORDER BY t1.year;",100000,"select t2.product_name, t1.year, t1.price from schema_1068.sales as t1 left outer join schema_1068.product as t2 on t1.product_id = t2.product_id order by year",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
470,1068,111,Easy,"SELECT product.product_name, sales.year, sales.price 
FROM schema_1068.sales 
JOIN schema_1068.product USING (product_id) 
ORDER BY sales.year;",100000,"select product.product_name, sales.year, sales.price from schema_1068.sales join schema_1068.product on sales.product_id = product.product_id order by sales.year",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
471,1068,112,Easy,"SELECT a.product_name, b.year, b.price 
FROM schema_1068.product a 
JOIN schema_1068.sales b ON a.product_id = b.product_id",100000,"select a.product_name, b.year, b.price from schema_1068.product as a join schema_1068.sales as b on a.product_id = b.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
472,1068,116,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
LEFT JOIN schema_1068.product p ON p.product_id = s.product_id;",100000,"select p.product_name, s.year, s.price from schema_1068.product as p right outer join schema_1068.sales as s on p.product_id = s.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
473,1068,117,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
INNER JOIN schema_1068.product p ON s.product_id = p.product_id",100000,"select p.product_name, year, price from schema_1068.sales as s left outer join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
474,1068,124,Easy,"SELECT t2.product_name, t1.year, t1.price 
FROM schema_1068.sales t1 
JOIN schema_1068.product t2 ON t1.product_id = t2.product_id;",100000,"select t2.product_name, t1.year, t1.price from schema_1068.sales as t1 left outer join schema_1068.product as t2 on t1.product_id = t2.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
475,1068,139,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
LEFT JOIN schema_1068.product p ON s.product_id = p.product_id;",100000,"select p.product_name, s.year, s.price from schema_1068.sales as s left outer join schema_1068.product as p on s.product_id = p.product_id order by s.sale_id",100000,0,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,Equivalent query,
476,1068,141,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
INNER JOIN schema_1068.product p ON p.product_id = s.product_id",100000,"select p.product_name, year, price from schema_1068.sales as s left outer join schema_1068.product as p on p.product_id = s.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
477,1068,145,Easy,"SELECT product.product_name, sales.year, sales.price 
FROM schema_1068.sales 
LEFT JOIN schema_1068.product USING (product_id)",100000,"select product.product_name, sales.year, sales.price from schema_1068.sales left outer join schema_1068.product on product.product_id = sales.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
478,1068,147,Easy,"SELECT product.product_name, sales.year, sales.price 
FROM schema_1068.sales 
JOIN schema_1068.product USING (product_id)",100000,"select product.product_name, year, price from schema_1068.sales join schema_1068.product on sales.product_id = product.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
479,1068,148,Easy,"SELECT s.year, s.price, p.product_name 
FROM schema_1068.sales s 
JOIN schema_1068.product p ON s.product_id = p.product_id 
ORDER BY s.year, s.price;",100000,"select s.year, s.price, p.product_name from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id order by year, price",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
480,1068,150,Easy,"SELECT a.year, a.price, b.product_name 
FROM schema_1068.sales a 
LEFT JOIN schema_1068.product b USING (product_id)",100000,"select a.year, a.price, b.product_name from schema_1068.sales as a left outer join schema_1068.product as b on a.product_id = b.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
481,1068,151,Easy,"SELECT b.product_name, a.year, a.price 
FROM schema_1068.sales a 
JOIN schema_1068.product b ON a.product_id = b.product_id 
ORDER BY b.product_id;",100000,"select b.product_name, a.year, a.price from schema_1068.sales as a join schema_1068.product as b on a.product_id = b.product_id order by a.product_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
482,1068,153,Easy,"SELECT b.product_name, a.year, a.price 
FROM schema_1068.sales a 
JOIN schema_1068.product b ON a.product_id = b.product_id",100000,"select b.product_name as product_name, a.year as year, a.price as price from schema_1068.sales as a left outer join schema_1068.product as b on a.product_id = b.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
483,1068,166,Easy,"SELECT b.product_name, a.year, a.price 
FROM schema_1068.sales a 
JOIN schema_1068.product b ON a.product_id = b.product_id;",100000,"select c.product_name, c.year, c.price from (select product_name, year, price from schema_1068.sales as a join schema_1068.product as b on a.product_id = b.product_id) as c",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
484,1068,182,Easy,"SELECT p.product_name, s.price, s.year 
FROM schema_1068.sales s 
JOIN schema_1068.product p ON s.product_id = p.product_id;",100000,"select p.product_name, s.price, s.year from schema_1068.sales as s left outer join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
485,1068,184,Easy,"SELECT p.product_name, s.year, s.price 
FROM (SELECT product_id, year, price FROM schema_1068.sales GROUP BY product_id, year, price) AS s 
JOIN schema_1068.product AS p ON s.product_id = p.product_id",99864,"select p.product_name, s.year, s.price from (select distinct product_id, year, price from schema_1068.sales) as s join schema_1068.product as p on s.product_id = p.product_id",99864,0,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,Equivalent query,"Initail as an optimized queries considered as incorrect result in LeetCode, while eqivalent between each other"
486,1068,187,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
JOIN schema_1068.product p USING (product_id)",100000,"select p.product_name, year, price from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
487,1068,189,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
JOIN schema_1068.product p USING (product_id);",100000,"select p.product_name as product_name, s.year as year, s.price from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
488,1068,190,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
JOIN schema_1068.product p ON p.product_id = s.product_id;",100000,"select p.product_name as product_name, s.year as year, s.price as price from schema_1068.sales as s left outer join schema_1068.product as p on p.product_id = s.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
489,1068,191,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
JOIN schema_1068.product p USING (product_id);",100000,"select p.product_name as product_name, s.year as year, s.price as price from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
490,1068,194,Easy,"SELECT p.product_name, s.year, MIN(s.price) AS price 
FROM schema_1068.sales s 
JOIN schema_1068.product p ON p.product_id = s.product_id 
GROUP BY p.product_name, s.year",21727,"select p.product_name, s.year, min(price) as price from schema_1068.sales as s join schema_1068.product as p on p.product_id = s.product_id group by p.product_name, s.year, sale_id",100000,-78273,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query groups by sale_id, which prevents true aggregation and returns nearly one row per sale, while the initial correctly aggregates the minimum price per product and year."
491,1068,210,Easy,"SELECT p.product_name, s.year, s.price FROM schema_1068.sales s JOIN schema_1068.product p ON s.product_id = p.product_id;",100000,"select p.product_name, s.year, s.price from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id order by s.sale_id",100000,0,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,Equivalent query,
492,1068,215,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
LEFT JOIN schema_1068.product p ON s.product_id = p.product_id 
ORDER BY s.year DESC",100000,"select p.product_name, s.year, s.price from schema_1068.sales as s left outer join schema_1068.product as p on s.product_id = p.product_id order by s.year desc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
493,1068,263,Easy,"SELECT prod.product_name, sales.year, sales.price 
FROM schema_1068.sales sales 
JOIN schema_1068.product prod USING (product_id);",100000,"select prod.product_name, sales.year, sales.price from schema_1068.sales as sales join schema_1068.product as prod on sales.product_id = prod.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
494,1068,266,Easy,"SELECT product.product_name, sales.year, sales.price 
FROM schema_1068.sales 
LEFT JOIN schema_1068.product ON product.product_id = sales.product_id;",100000,"select product.product_name, sales.year, sales.price from schema_1068.product right outer join schema_1068.sales on product.product_id = sales.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
495,1068,270,Easy,"SELECT product_name, year, price 
FROM schema_1068.sales AS s 
JOIN schema_1068.product AS p ON s.product_id = p.product_id",100000,"select product_name, year, price from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id order by sale_id",100000,0,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,Equivalent query,
496,1068,275,Easy,"SELECT product_name, sales.year, price 
FROM schema_1068.sales 
INNER JOIN schema_1068.product USING (product_id)",100000,"select product_name, sales.year, price from schema_1068.sales join schema_1068.product on sales.product_id = product.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
497,1068,279,Easy,"SELECT b.product_name, a.year, a.price 
FROM schema_1068.sales a 
JOIN schema_1068.product b ON a.product_id = b.product_id",100000,"select product_name, a.year, a.price from schema_1068.sales as a join schema_1068.product as b on a.product_id = b.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
498,1068,281,Easy,"SELECT product_name, sales.year, price 
FROM schema_1068.sales 
INNER JOIN schema_1068.product ON sales.product_id = product.product_id",100000,"select product_name, sales.year, price from schema_1068.sales left outer join schema_1068.product on sales.product_id = product.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
499,1068,291,Easy,"SELECT b.product_name, a.year, a.price 
FROM schema_1068.sales a 
JOIN schema_1068.product b USING (product_id);",100000,"select product_name, year, price from schema_1068.sales as a join schema_1068.product as b on a.product_id = b.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
500,1068,292,Easy,"SELECT b.product_name, a.year, a.price 
FROM schema_1068.sales a 
LEFT JOIN schema_1068.product b ON a.product_id = b.product_id",100000,"select product_name, year, price from schema_1068.sales as a left outer join schema_1068.product as b on a.product_id = b.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
501,1068,308,Easy,"SELECT p.product_name, s.year, s.price 
FROM schema_1068.sales s 
LEFT JOIN schema_1068.product p ON p.product_id = s.product_id",100000,"select product_name, year, price from schema_1068.sales as s left outer join schema_1068.product as p on p.product_id = s.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
502,1068,322,Easy,"SELECT product_name, year, price 
FROM schema_1068.sales 
LEFT OUTER JOIN schema_1068.product USING (product_id) 
ORDER BY year DESC",100000,"select product_name, year, price from schema_1068.sales left outer join schema_1068.product on sales.product_id = product.product_id order by year desc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
503,1068,342,Easy,"SELECT product_name, year, price 
FROM schema_1068.sales AS s 
JOIN schema_1068.product AS p ON s.product_id = p.product_id 
ORDER BY s.sale_id",100000,"select product_name, year, price from schema_1068.product as p join schema_1068.sales as s on p.product_id = s.product_id order by sale_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
504,1068,364,Easy,"SELECT s.year, s.price, p.product_name 
FROM schema_1068.sales s 
JOIN schema_1068.product p ON s.product_id = p.product_id",100000,"select s.year, s.price, p.product_name from schema_1068.sales as s join schema_1068.product as p on s.product_id = p.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
505,1068,369,Easy,"SELECT year, price, product_name 
FROM schema_1068.sales 
JOIN schema_1068.product USING (product_id)",100000,"select year, price, product_name from schema_1068.sales join schema_1068.product on sales.product_id = product.product_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
506,1069,1,Easy,"SELECT a.product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales a 
GROUP BY a.product_id;",1000,"select a.product_id, sum(quantity) as total_quantity from schema_1069.sales as a left outer join schema_1069.product as b on a.product_id = b.product_id group by a.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
507,1069,2,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select distinct s.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s group by s.product_id",1000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
508,1069,3,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select distinct a.product_id, sum(a.quantity) as total_quantity from schema_1069.sales as a group by a.product_id",1000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
509,1069,5,Easy,"SELECT product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id",1000,"select distinct product_id, sum(quantity) over (partition by product_id) as total_quantity from schema_1069.sales",1000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
510,1069,8,Easy,"SELECT s.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
WHERE s.product_id IS NOT NULL 
GROUP BY s.product_id",1000,"select p.product_id, sum(s.quantity) as total_quantity from schema_1069.product as p join schema_1069.sales as s on p.product_id = s.product_id group by p.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
511,1069,12,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select product_id, sum(quantity) as total_quantity from schema_1069.sales group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
512,1069,13,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select product_id, sum(quantity) as total_quantity from schema_1069.sales group by product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
513,1069,15,Easy,"SELECT product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id;",1000,"select s.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s group by s.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
514,1069,16,Easy,"SELECT s.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
GROUP BY s.product_id;",1000,"select s.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s left outer join schema_1069.product as p on s.product_id = p.product_id group by s.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
515,1069,18,Easy,"SELECT sales.product_id, SUM(sales.quantity) AS total_quantity 
FROM schema_1069.sales 
WHERE sales.product_id IS NOT NULL
GROUP BY sales.product_id",1000,"select sales.product_id, sum(sales.quantity) as total_quantity from schema_1069.sales join schema_1069.product on sales.product_id = product.product_id group by sales.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
516,1069,19,Easy,"SELECT product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id 
ORDER BY product_id;",1000,"select sales.product_id, sum(sales.quantity) as total_quantity from schema_1069.sales group by sales.product_id order by product_id",1000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
517,1069,23,Easy,"SELECT s.product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales AS s 
WHERE s.product_id IS NOT NULL
GROUP BY s.product_id",1000,"select p.product_id, sum(quantity) as total_quantity from schema_1069.sales as s join schema_1069.product as p on p.product_id = s.product_id group by p.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
518,1069,24,Easy,"SELECT p.product_id, COALESCE(SUM(s.quantity), 0) AS total_quantity 
FROM schema_1069.product p 
LEFT JOIN schema_1069.sales s ON p.product_id = s.product_id 
GROUP BY p.product_id",1000,"select p.product_id, sum(quantity) as total_quantity from schema_1069.sales as s left outer join schema_1069.product as p on s.product_id = p.product_id group by p.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query starts with the products table and left joins sales table, while the initial query starts with sales and left join products"
519,1069,29,Easy,"SELECT s.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
WHERE s.product_id IS NOT NULL 
GROUP BY s.product_id",1000,"select p.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s join schema_1069.product as p on s.product_id = p.product_id group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
520,1069,30,Easy,"SELECT s.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
WHERE s.product_id IS NOT NULL 
GROUP BY s.product_id",1000,"select p.product_id, sum(s.quantity) as total_quantity from schema_1069.product as p join schema_1069.sales as s on p.product_id = s.product_id group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
521,1069,46,Easy,"SELECT product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id 
ORDER BY product_id;",1000,"select product_id, sum(quantity) as total_quantity from schema_1069.sales group by product_id order by product_id",1000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
522,1069,47,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select product_id, sum(quantity) as total_quantity from schema_1069.sales as s group by product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
523,1069,71,Easy,"SELECT s.product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales s 
WHERE s.product_id IS NOT NULL
GROUP BY s.product_id",1000,"select s.product_id, sum(quantity) as total_quantity from schema_1069.sales as s join schema_1069.product as p on s.product_id = p.product_id group by s.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
524,1069,73,Easy,"SELECT s.product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales s 
WHERE s.product_id IS NOT NULL
GROUP BY s.product_id",1000,"select s.product_id, sum(quantity) as total_quantity from schema_1069.sales as s join schema_1069.product as p on s.product_id = p.product_id group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
525,1069,74,Easy,"SELECT product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id;",1000,"select s.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s group by product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
526,1069,76,Easy,"SELECT s.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
WHERE s.product_id IS NOT NULL
GROUP BY s.product_id",1000,"select s.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s join schema_1069.product as p on p.product_id = s.product_id group by s.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
527,1069,77,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select s.product_id, sum(quantity) as total_quantity from schema_1069.sales as s left outer join schema_1069.product as p on s.product_id = p.product_id group by s.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
528,1069,78,Easy,"SELECT product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id",1000,"select s.product_id, sum(quantity) as total_quantity from schema_1069.sales as s group by s.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
529,1069,82,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select sales.product_id, sum(quantity) as total_quantity from schema_1069.sales group by product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
530,1069,83,Easy,"SELECT a.product_id, SUM(a.quantity) AS total_quantity 
FROM schema_1069.sales a 
WHERE a.product_id IS NOT NULL 
GROUP BY a.product_id",1000,"select a.product_id, sum(a.quantity) as total_quantity from schema_1069.sales as a join schema_1069.product as b on a.product_id = b.product_id group by a.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
531,1069,84,Easy,"SELECT product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id",1000,"select distinct sales.product_id, sum(quantity) as total_quantity from schema_1069.sales group by sales.product_id",1000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
532,1069,85,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select product_id as product_id, sum(quantity) as total_quantity from schema_1069.sales group by product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
533,1069,93,Easy,"SELECT s.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
WHERE s.product_id IS NOT NULL 
GROUP BY s.product_id",1000,"select s.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s join schema_1069.product as p on s.product_id = p.product_id group by s.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
534,1069,95,Easy,"SELECT p.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.product p 
JOIN schema_1069.sales s ON p.product_id = s.product_id 
GROUP BY p.product_id",1000,"select p.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s join schema_1069.product as p on s.product_id = p.product_id group by p.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
535,1069,96,Easy,"SELECT product.product_id, SUM(sales.quantity) AS total_quantity 
FROM schema_1069.sales 
JOIN schema_1069.product USING (product_id) 
GROUP BY product.product_id",1000,"select product.product_id as product_id, sum(quantity) as total_quantity from schema_1069.sales join schema_1069.product on sales.product_id = product.product_id group by product.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
536,1069,101,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select a.product_id, sum(a.quantity) as total_quantity from schema_1069.sales as a group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
537,1069,102,Easy,"SELECT product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id;",1000,"select a.product_id, sum(a.quantity) as total_quantity from schema_1069.sales as a group by a.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
538,1069,103,Easy,"SELECT a.product_id, SUM(a.quantity) AS total_quantity 
FROM schema_1069.sales a 
GROUP BY a.product_id",1000,"select a.product_id, sum(a.quantity) as total_quantity from schema_1069.sales as a left outer join schema_1069.product as b on a.product_id = b.product_id group by a.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
539,1069,107,Easy,"SELECT b.product_id, SUM(b.quantity) AS total_quantity 
FROM schema_1069.sales b 
WHERE b.product_id IS NOT NULL 
GROUP BY b.product_id",1000,"select a.product_id, sum(b.quantity) as total_quantity from schema_1069.product as a join schema_1069.sales as b on a.product_id = b.product_id group by a.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
540,1069,110,Easy,"SELECT product_id, sum(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select distinct product_id, sum(quantity) as total_quantity from schema_1069.sales group by 1",1000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
541,1069,111,Easy,"SELECT product_id, sum(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id ORDER BY product_id",1000,"select distinct product_id, sum(quantity) as total_quantity from schema_1069.sales group by product_id order by product_id",1000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
542,1069,112,Easy,"SELECT product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id;",1000,"select distinct product_id, sum(quantity) over (partition by product_id order by product_id) as total_quantity from schema_1069.sales",1000,0,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,Equivalent query,
543,1069,115,Easy,"SELECT s.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
GROUP BY s.product_id",1000,"select distinct s.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s join schema_1069.product as p on s.product_id = p.product_id group by s.product_id",1000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
544,1069,116,Easy,"SELECT product_id, sum(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select distinct product_id, sum(quantity) as total_quantity from schema_1069.sales group by product_id",1000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
545,1069,121,Easy,"SELECT p.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
JOIN schema_1069.product p ON s.product_id = p.product_id 
GROUP BY p.product_id",1000,"select p.product_id, sum(quantity) as total_quantity from schema_1069.product as p join schema_1069.sales as s on s.product_id = p.product_id group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
546,1069,122,Easy,"SELECT p.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
JOIN schema_1069.product p ON s.product_id = p.product_id 
GROUP BY p.product_id",1000,"select p.product_id, sum(quantity) as total_quantity from schema_1069.product as p join schema_1069.sales as s on p.product_id = s.product_id group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
547,1069,124,Easy,"SELECT p.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.product p 
JOIN schema_1069.sales s ON p.product_id = s.product_id 
GROUP BY p.product_id",1000,"select p.product_id, sum(quantity) as total_quantity from schema_1069.sales as s join schema_1069.product as p on s.product_id = p.product_id group by p.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
548,1069,126,Easy,"SELECT p.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
JOIN schema_1069.product p USING (product_id) 
GROUP BY p.product_id;",1000,"select p.product_id, sum(quantity) as total_quantity from schema_1069.product as p join schema_1069.sales as s on p.product_id = s.product_id group by p.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
549,1069,142,Easy,"SELECT product.product_id, COALESCE(SUM(sales.quantity), 0) AS total_quantity 
FROM schema_1069.product 
LEFT JOIN schema_1069.sales ON product.product_id = sales.product_id 
GROUP BY product.product_id",1000,"select product.product_id, sum(sales.quantity) as total_quantity from schema_1069.sales left outer join schema_1069.product on product.product_id = sales.product_id group by product.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query starts with the products table and left joins sales table, while the initial query starts with sales and left join products"
550,1069,148,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id;",1000,"select product_id as product_id, sum(quantity) as total_quantity from schema_1069.sales group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
551,1069,158,Easy,"SELECT product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id",1000,"select product_id, sum(quantity) as total_quantity from schema_1069.sales as s group by s.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
552,1069,185,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select product_id, sum(quantity) as total_quantity from schema_1069.sales as s group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
553,1069,187,Easy,"SELECT product_id, SUM(quantity) AS total_quantity FROM schema_1069.sales GROUP BY product_id",1000,"select s.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
554,1069,189,Easy,"SELECT s.product_id, SUM(s.quantity) AS total_quantity 
FROM schema_1069.sales s 
GROUP BY s.product_id 
ORDER BY s.product_id;",1000,"select s.product_id, sum(s.quantity) as total_quantity from schema_1069.sales as s group by s.product_id order by s.product_id",1000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
555,1069,190,Easy,"SELECT s.product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales s 
GROUP BY s.product_id;",1000,"select s.product_id as product_id, sum(quantity) as total_quantity from schema_1069.sales as s left outer join schema_1069.product as p on s.product_id = p.product_id group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
556,1069,192,Easy,"SELECT s.product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales s 
GROUP BY s.product_id",1000,"select s.product_id, sum(quantity) as total_quantity from schema_1069.sales as s left outer join schema_1069.product as p on s.product_id = p.product_id group by 1",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
557,1069,199,Easy,"SELECT product_id, sum(quantity) AS total_quantity 
FROM schema_1069.sales 
GROUP BY product_id",1000,"select s.product_id, sum(quantity) as total_quantity from schema_1069.sales as s group by product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
558,1069,214,Easy,"SELECT sales.product_id, SUM(quantity) AS total_quantity 
FROM schema_1069.sales 
WHERE product_id IS NOT NULL
GROUP BY sales.product_id",1000,"select sales.product_id, sum(quantity) as total_quantity from schema_1069.sales join schema_1069.product on sales.product_id = product.product_id group by sales.product_id",1000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
559,1077,1,Medium,"WITH max_experience AS (
    SELECT 
        p.project_id, 
        MAX(e.experience_years) AS max_years
    FROM 
        schema_1077.project p
    JOIN 
        schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY 
        p.project_id
)
SELECT 
    p.project_id, 
    p.employee_id
FROM 
    schema_1077.project p
JOIN 
    schema_1077.employee e ON p.employee_id = e.employee_id
JOIN 
    max_experience me ON p.project_id = me.project_id AND e.experience_years = me.max_years;",11013,"select distinct a.project_id, a.employee_id from (select project_id, project.employee_id, experience_years, max(experience_years) over (partition by project_id) as max_years from schema_1077.project join schema_1077.employee on project.employee_id = employee.employee_id) as a where a.experience_years = a.max_years",11013,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
560,1077,9,Medium,"SELECT p.project_id, p.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) AS max_years
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) m ON p.project_id = m.project_id AND e.experience_years = m.max_years",11013,"select project.project_id, project.employee_id from schema_1077.project join (select project_id, max(experience_years) as years from schema_1077.project join schema_1077.employee on project.employee_id = employee.employee_id group by project_id) as maxes on maxes.project_id = project.project_id join schema_1077.employee on project.employee_id = employee.employee_id where employee.experience_years = maxes.years",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
561,1077,29,Medium,"WITH ranked_employees AS (
    SELECT 
        p.project_id, 
        p.employee_id, 
        e.experience_years,
        RANK() OVER (PARTITION BY p.project_id ORDER BY e.experience_years DESC) as rank
    FROM 
        schema_1077.project p
    JOIN 
        schema_1077.employee e ON p.employee_id = e.employee_id
)
SELECT 
    project_id, 
    employee_id
FROM 
    ranked_employees
WHERE 
    rank = 1;",11013,"select project_id, employee_id from (select p.project_id, p.employee_id, experience_years, max(experience_years) over (partition by p.project_id) as max_years from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id) as t where experience_years = max_years",11013,0,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,Equivalent query,
562,1077,57,Medium,"SELECT p.project_id, e.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) AS max_years
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) max_exp ON p.project_id = max_exp.project_id AND e.experience_years = max_exp.max_years",11013,"select t1.project_id, t1.employee_id from (select p.project_id, e.employee_id, e.experience_years from schema_1077.project as p left outer join schema_1077.employee as e on p.employee_id = e.employee_id) as t1 join (select p.project_id, max(e.experience_years) as max_years from schema_1077.project as p left outer join schema_1077.employee as e on p.employee_id = e.employee_id group by 1) as t2 on (t1.project_id = t2.project_id and t1.experience_years = t2.max_years)",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
563,1077,59,Medium,"SELECT p.project_id, p.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) AS max_exp
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) max_exp_per_project ON p.project_id = max_exp_per_project.project_id AND e.experience_years = max_exp_per_project.max_exp",11013,"select t1.project_id, t2.employee_id from (select p.project_id, max(e.experience_years) as most_experienced from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id group by 1) as t1 join (select p.project_id, p.employee_id, e.experience_years from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id) as t2 on (t1.project_id = t2.project_id and t1.most_experienced = t2.experience_years)",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
564,1077,121,Medium,"WITH project_employees AS (
    SELECT 
        p.project_id,
        p.employee_id,
        e.experience_years
    FROM 
        schema_1077.project p
    JOIN 
        schema_1077.employee e ON p.employee_id = e.employee_id
),
max_experience_per_project AS (
    SELECT 
        project_id,
        MAX(experience_years) AS max_experience
    FROM 
        project_employees
    GROUP BY 
        project_id
)
SELECT 
    pe.project_id,
    pe.employee_id
FROM 
    project_employees pe
JOIN 
    max_experience_per_project mep ON pe.project_id = mep.project_id 
    AND pe.experience_years = mep.max_experience;",11013,"select a.project_id as project_id, a.employee_id as employee_id from (select distinct proj.project_id as project_id, proj.employee_id as employee_id, emp.experience_years as experience_years from schema_1077.project as proj join schema_1077.employee as emp on proj.employee_id = emp.employee_id) as a join (select distinct proj.project_id, max(emp.experience_years) over (partition by proj.project_id) as exp from schema_1077.project as proj join schema_1077.employee as emp on proj.employee_id = emp.employee_id) as b on (a.project_id = b.project_id and a.experience_years = b.exp)",11013,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
565,1077,136,Medium,"WITH project_employee_exp AS (
    SELECT p.project_id, p.employee_id, e.experience_years
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
),
max_exp_per_project AS (
    SELECT project_id, MAX(experience_years) AS max_experience
    FROM project_employee_exp
    GROUP BY project_id
)
SELECT p.project_id, p.employee_id
FROM project_employee_exp p
JOIN max_exp_per_project m ON p.project_id = m.project_id AND p.experience_years = m.max_experience;",11013,"select a.project_id, a.employee_id from (select project_id, p.employee_id, experience_years from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id) as a join (select project_id, max(experience_years) as experience_years from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id group by project_id) as b on (a.project_id = b.project_id and a.experience_years = b.experience_years)",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
566,1077,138,Medium,"WITH project_experience AS (
    SELECT 
        p.project_id, 
        p.employee_id, 
        e.experience_years
    FROM 
        schema_1077.project p
    JOIN 
        schema_1077.employee e ON p.employee_id = e.employee_id
),
max_experience AS (
    SELECT 
        project_id, 
        MAX(experience_years) AS max_years
    FROM 
        project_experience
    GROUP BY 
        project_id
)
SELECT 
    pe.project_id, 
    pe.employee_id
FROM 
    project_experience pe
JOIN 
    max_experience me ON pe.project_id = me.project_id AND pe.experience_years = me.max_years;",11013,"select c.project_id, c.employee_id from (select a.project_id, a.employee_id, b.experience_years, max(b.experience_years) over (partition by a.project_id) as max_years from schema_1077.project as a join schema_1077.employee as b on a.employee_id = b.employee_id) as c where c.experience_years = c.max_years",11013,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
567,1077,143,Medium,"SELECT p.project_id, e.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) AS max_years
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) a ON p.project_id = a.project_id AND e.experience_years = a.max_years;",11013,"select p.project_id, e.employee_id from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id join (select project_id, max(experience_years) as max_years from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id group by project_id) as a on (p.project_id = a.project_id and e.experience_years = a.max_years)",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
568,1077,148,Medium,"SELECT p.project_id, e.employee_id 
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) AS max_exp
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) max_exp_per_project ON p.project_id = max_exp_per_project.project_id AND e.experience_years = max_exp_per_project.max_exp",11013,"select p.project_id, e.employee_id from schema_1077.employee as e join schema_1077.project as p on e.employee_id = p.employee_id join (select project_id, max(experience_years) as max from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id group by project_id) as t on (e.experience_years = max and p.project_id = t.project_id)",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
569,1077,149,Medium,"SELECT p.project_id, e.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) as max_exp
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) max_exp ON p.project_id = max_exp.project_id AND e.experience_years = max_exp.max_exp",11013,"select p.project_id, e.employee_id from schema_1077.project as p left outer join schema_1077.employee as e on p.employee_id = e.employee_id right outer join (select a.project_id, max(b.experience_years) as max from schema_1077.project as a left outer join schema_1077.employee as b on a.employee_id = b.employee_id group by 1) as c on (p.project_id = c.project_id and e.experience_years = c.max)",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
570,1077,158,Medium,"WITH max_experience AS (
    SELECT p.project_id, MAX(e.experience_years) AS max_yrs
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
)
SELECT p.project_id, p.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN max_experience me ON p.project_id = me.project_id AND e.experience_years = me.max_yrs",11013,"select p.project_id, p.employee_id from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id join (select project_id, max(experience_years) as yrs from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id group by project_id) as a on (a.project_id = p.project_id and a.yrs = e.experience_years)",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
571,1077,162,Medium,"SELECT p.project_id, p.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) AS max_yrs
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) m ON p.project_id = m.project_id AND e.experience_years = m.max_yrs",11013,"select p1.project_id, p1.employee_id from schema_1077.project as p1 join schema_1077.employee as e1 on p1.employee_id = e1.employee_id join (select p.project_id, max(experience_years) as max_yrs from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id group by 1) as m on (p1.project_id = m.project_id and e1.experience_years = m.max_yrs)",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
572,1077,181,Medium,"WITH project_employees AS (
    SELECT p.project_id, p.employee_id, e.experience_years
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
),
max_experience AS (
    SELECT project_id, MAX(experience_years) AS max_years
    FROM project_employees
    GROUP BY project_id
)
SELECT pe.project_id, pe.employee_id
FROM project_employees pe
JOIN max_experience me ON pe.project_id = me.project_id AND pe.experience_years = me.max_years;",11013,"select project_id, employee_id from (select distinct p.project_id, p.employee_id, e.experience_years, max(e.experience_years) over (partition by p.project_id) as max_years from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id) as tmp where experience_years = max_years",11013,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
573,1077,273,Medium,"SELECT p.project_id, e.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) AS max_years
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) max_exp ON p.project_id = max_exp.project_id AND e.experience_years = max_exp.max_years;",11013,"select sub.project_id, employee.employee_id from (select project_id, max(e.experience_years) as maxyears from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id group by p.project_id) as sub join schema_1077.project on sub.project_id = project.project_id join schema_1077.employee on (project.employee_id = employee.employee_id and sub.maxyears = employee.experience_years)",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
574,1077,274,Medium,"SELECT p.project_id, e.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) AS max_exp
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) t ON p.project_id = t.project_id AND e.experience_years = t.max_exp",11013,"select t.project_id, e.employee_id from schema_1077.employee as e join (select project_id, max(experience_years) as max from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id group by project_id) as t on e.experience_years = t.max join schema_1077.project as p on (p.project_id = t.project_id and e.employee_id = p.employee_id)",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
575,1077,276,Medium,"SELECT p.project_id, e.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) as max_years
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) max_exp ON p.project_id = max_exp.project_id AND e.experience_years = max_exp.max_years",11013,"select t.project_id, t.employee_id from (select p.project_id, e.employee_id, e.experience_years, max(e.experience_years) over (partition by p.project_id) as mx from schema_1077.project as p left outer join schema_1077.employee as e on p.employee_id = e.employee_id) as t where t.experience_years = t.mx",11013,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
576,1077,292,Medium,"WITH project_experience AS (
    SELECT 
        p.project_id, 
        p.employee_id, 
        e.experience_years
    FROM 
        schema_1077.project p
    JOIN 
        schema_1077.employee e ON p.employee_id = e.employee_id
),
max_experience_per_project AS (
    SELECT 
        project_id, 
        MAX(experience_years) AS max_exp
    FROM 
        project_experience
    GROUP BY 
        project_id
)
SELECT 
    pe.project_id, 
    pe.employee_id
FROM 
    project_experience pe
JOIN 
    max_experience_per_project mep ON pe.project_id = mep.project_id AND pe.experience_years = mep.max_exp;",11013,"select t1.project_id, t1.employee_id from (select a.project_id, a.employee_id, b.experience_years, max(b.experience_years) over (partition by a.project_id) as max_exp from schema_1077.project as a left outer join schema_1077.employee as b on a.employee_id = b.employee_id) as t1 where t1.experience_years = t1.max_exp",11013,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
577,1077,293,Medium,"WITH max_experience AS (
    SELECT 
        p.project_id, 
        MAX(e.experience_years) AS max_years
    FROM 
        schema_1077.project p
    JOIN 
        schema_1077.employee e ON e.employee_id = p.employee_id
    GROUP BY 
        p.project_id
)
SELECT 
    p.project_id, 
    p.employee_id
FROM 
    schema_1077.project p
JOIN 
    schema_1077.employee e ON e.employee_id = p.employee_id
JOIN 
    max_experience me ON me.project_id = p.project_id AND e.experience_years = me.max_years;",11013,"select t1.project_id, t1.employee_id from schema_1077.project as t1 join schema_1077.employee as t2 on t2.employee_id = t1.employee_id join (select t1.project_id, max(t2.experience_years) as max_years from schema_1077.project as t1 join schema_1077.employee as t2 on t2.employee_id = t1.employee_id group by t1.project_id) as t3 on t3.project_id = t1.project_id where t2.experience_years = t3.max_years",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
578,1077,296,Medium,"SELECT p.project_id, e.employee_id
FROM schema_1077.project p
JOIN schema_1077.employee e ON p.employee_id = e.employee_id
JOIN (
    SELECT p.project_id, MAX(e.experience_years) AS max_year
    FROM schema_1077.project p
    JOIN schema_1077.employee e ON p.employee_id = e.employee_id
    GROUP BY p.project_id
) max_exp ON p.project_id = max_exp.project_id AND e.experience_years = max_exp.max_year;",11013,"select tmp.project_id, ee.employee_id from (select p.project_id, max(experience_years) as max_year from schema_1077.project as p join schema_1077.employee as e on p.employee_id = e.employee_id group by p.project_id) as tmp join schema_1077.project as pp on tmp.project_id = pp.project_id join schema_1077.employee as ee on pp.employee_id = ee.employee_id where ee.experience_years = tmp.max_year",11013,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
579,1113,3,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select distinct extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action_date = '2019-07-04' and action = 'report') group by extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
580,1113,6,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action_date = '2019-07-04' and action = 'report') group by extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
581,1113,7,Easy,"SELECT a.extra AS report_reason, COUNT(DISTINCT a.post_id) AS report_count 
FROM schema_1113.actions AS a 
WHERE a.action = 'report' AND a.action_date = '2019-07-04' 
GROUP BY a.extra",10,"select a.extra as report_reason, count(distinct a.post_id) as report_count from schema_1113.actions as a where (a.action = 'report' and a.action_date = '2019-07-04') group by a.extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
582,1113,11,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action = 'report' AND action_date = '2019-07-04' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action = 'report' and action_date = '2019-07-04') group by extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
583,1113,18,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (1 = 1 and action_date = '2019-07-04' and action = 'report') group by extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
584,1113,24,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action = 'report' AND action_date = '2019-07-04' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action = 'report' and action_date = '2019-07-04') group by 1",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
585,1113,34,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra 
ORDER BY extra DESC",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action_date = '2019-07-04' and action = 'report') group by extra order by extra desc",10,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
586,1113,65,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action_date = '2019-07-04' and action = 'report') group by 1",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
587,1113,72,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action = 'report' AND action_date = '2019-07-04' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions as a where (action = 'report' and action_date = '2019-07-04') group by a.extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
588,1113,79,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action_date = '2019-07-04' and action = 'report') group by 1 having count(distinct post_id) > 0",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
589,1113,97,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra 
ORDER BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action_date = '2019-07-04' and action = 'report') group by extra order by extra",10,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
590,1113,99,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select report_reason, count(report_reason) as report_count from (select distinct t1.post_id, t1.action, t1.extra as report_reason, t1.action_date from schema_1113.actions as t1 where (t1.action_date = '2019-07-04' and t1.action = 'report')) as t2 group by t2.report_reason",10,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
591,1113,102,Easy,"SELECT a.extra AS report_reason, COUNT(DISTINCT a.post_id) AS report_count 
FROM schema_1113.actions AS a 
WHERE a.action_date = '2019-07-04' AND a.action = 'report' 
GROUP BY a.extra",10,"select a.extra as report_reason, count(distinct a.post_id) as report_count from schema_1113.actions as a where (a.action_date = '2019-07-04' and a.action = 'report') group by a.extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
592,1113,106,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action = 'report' AND action_date = '2019-07-04' 
GROUP BY extra",10,"select distinct extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action = 'report' and action_date = '2019-07-04') group by extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
593,1113,120,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions as a where (action_date = '2019-07-04' and action = 'report') group by extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
594,1113,138,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action = 'report' AND action_date = '2019-07-04' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions as a where (action = 'report' and action_date = '2019-07-04') group by extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
595,1113,146,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action = 'report' AND action_date = '2019-07-04'
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action = 'report' and action_date = '2019-07-04 ') group by extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
596,1113,186,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report'
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions group by extra, action_date, action having (action_date = '2019-07-04' and action = 'report')",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
597,1113,191,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action = 'report' AND action_date = '2019-07-04' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action = 'report' and action_date = '2019-07-04') group by extra having count(distinct post_id) > 0",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
598,1113,207,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra 
ORDER BY extra ASC",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action_date = '2019-07-04' and action = 'report') group by extra order by extra asc",10,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
599,1113,225,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action = 'report' AND action_date = '2019-07-04' 
GROUP BY extra 
ORDER BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action = 'report' and action_date = '2019-07-04') group by extra order by extra",10,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
600,1113,228,Easy,"SELECT extra AS report_reason, COUNT(DISTINCT post_id) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select extra as report_reason, count(distinct post_id) as report_count from schema_1113.actions where (action_date = '2019-07-04' and action = 'report') group by action, extra",10,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
601,1113,234,Easy,"SELECT extra AS report_reason, COUNT(*) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select extra as report_reason, count(extra) as report_count from (select distinct post_id, action_date, action, extra from schema_1113.actions) as x where (action_date = '2019-07-04' and action = 'report') group by extra",10,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The initial query counts unique post-level reports by reason on 2019?07?04, while the optimized query counts all report actions, including duplicates"
602,1113,236,Easy,"SELECT extra AS report_reason, COUNT(*) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select extra as report_reason, count(extra) as report_count from (select distinct post_id, extra from schema_1113.actions where (action_date = '2019-07-04' and action = 'report')) as a group by a.extra",10,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The initial query counts unique post-level reports by reason on 2019?07?04, while the optimized query counts all report actions, including duplicates"
603,1113,237,Easy,"SELECT extra AS report_reason, COUNT(*) AS report_count 
FROM schema_1113.actions 
WHERE action_date = '2019-07-04' AND action = 'report' 
GROUP BY extra",10,"select extra as report_reason, count(extra) as report_count from (select distinct post_id, action_date, action, extra from schema_1113.actions) as y where (action_date = '2019-07-04' and action = 'report') group by extra",10,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The initial query counts unique post-level reports by reason on 2019?07?04, while the optimized query counts all report actions, including duplicates"
604,1126,1,Medium,"WITH event_means AS (
    SELECT event_type, AVG(occurences) AS mean 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events e
JOIN event_means m ON e.event_type = m.event_type AND e.occurences > m.mean
GROUP BY business_id 
HAVING COUNT(*) > 1;",4995,"select distinct events.business_id from schema_1126.events join (select event_type, avg(occurences) as mean from schema_1126.events group by event_type) as t on (t.event_type = events.event_type and occurences > mean) group by business_id having count(business_id) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
605,1126,2,Medium,"SELECT business_id
FROM (
    SELECT 
        e.business_id, 
        e.event_type, 
        e.occurences > avg(e.occurences) OVER (PARTITION BY e.event_type) AS is_above_mean
    FROM schema_1126.events e
) t
WHERE is_above_mean
GROUP BY business_id
HAVING COUNT(DISTINCT event_type) > 1;",4995,"select distinct a.business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as mean from schema_1126.events) as a where a.occurences > a.mean group by a.business_id having count(distinct a.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
606,1126,6,Medium,"SELECT business_id
FROM schema_1126.events a
JOIN (
    SELECT event_type, AVG(occurences) AS avg_occur 
    FROM schema_1126.events 
    GROUP BY event_type
) b ON a.event_type = b.event_type AND a.occurences > b.avg_occur
GROUP BY business_id
HAVING COUNT(DISTINCT a.event_type) > 1",4995,"select distinct business_id from schema_1126.events as a join (select event_type, avg(occurences) as avg_occur from schema_1126.events group by event_type) as b on (a.event_type = b.event_type and a.occurences > b.avg_occur) group by a.business_id having count(a.event_type) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
607,1126,7,Medium,"WITH avg_occurrences AS (
    SELECT event_type, avg(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id
FROM schema_1126.events e
JOIN avg_occurrences a ON e.event_type = a.event_type
WHERE e.occurences > a.avg_occ
GROUP BY business_id
HAVING COUNT(*) > 1;",4995,"select distinct business_id from schema_1126.events as e join (select event_type, avg(occurences) as avg_occ from schema_1126.events group by event_type) as tmp on e.event_type = tmp.event_type where e.occurences > tmp.avg_occ group by business_id having count(business_id) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
608,1126,8,Medium,"SELECT e.business_id
FROM schema_1126.events e
JOIN (
    SELECT event_type, AVG(occurences) AS avg_occur 
    FROM schema_1126.events 
    GROUP BY event_type
) x ON e.event_type = x.event_type AND e.occurences > x.avg_occur
GROUP BY e.business_id
HAVING COUNT(DISTINCT e.event_type) > 1",4995,"select distinct e.business_id from schema_1126.events as e left outer join (select event_type, avg(occurences) as avg_occur from schema_1126.events group by event_type) as x on e.event_type = x.event_type where e.occurences > x.avg_occur group by e.business_id having count(distinct e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
609,1126,9,Medium,"WITH event_avg AS (
    SELECT event_type, avg(occurences) AS average 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id 
FROM schema_1126.events e
JOIN event_avg t ON e.event_type = t.event_type 
WHERE e.occurences > t.average 
GROUP BY e.business_id 
HAVING count(e.event_type) > 1",4995,"select e.business_id from schema_1126.events as e join (select event_type, avg(occurences) as average from schema_1126.events group by event_type) as t on e.event_type = t.event_type where e.occurences > t.average group by e.business_id having count(e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
610,1126,10,Medium,"WITH event_avg AS (
    SELECT event_type, avg(occurences) AS avgoc 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e1.business_id 
FROM schema_1126.events e1 
JOIN event_avg e2 ON e1.event_type = e2.event_type 
WHERE e1.occurences > e2.avgoc 
GROUP BY e1.business_id 
HAVING count(DISTINCT e1.event_type) > 1",4995,"select e1.business_id from schema_1126.events as e1 left outer join (select event_type, avg(occurences) as avgoc from schema_1126.events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avgoc group by e1.business_id having count(distinct e1.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
611,1126,11,Medium,"SELECT e1.business_id
FROM schema_1126.events e1
JOIN (
    SELECT event_type, AVG(occurences) AS avg_occurences
    FROM schema_1126.events
    GROUP BY event_type
) e2 ON e1.event_type = e2.event_type
WHERE e1.occurences > e2.avg_occurences
GROUP BY e1.business_id
HAVING COUNT(*) > 1;",4995,"select e3.business_id from (select business_id from schema_1126.events as e1 left outer join (select event_type, avg(occurences) as avg_occurences from schema_1126.events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avg_occurences) as e3 group by e3.business_id having count(business_id) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
612,1126,13,Medium,"WITH event_avg AS (
    SELECT 
        event_type, 
        AVG(occurences) AS avg_occurences_event 
    FROM schema_1126.events 
    GROUP BY event_type
),
filtered_events AS (
    SELECT 
        e.business_id, 
        e.event_type
    FROM schema_1126.events e
    JOIN event_avg a ON e.event_type = a.event_type
    WHERE e.occurences > a.avg_occurences_event
)
SELECT 
    business_id
FROM filtered_events
GROUP BY business_id
HAVING COUNT(DISTINCT event_type) > 1;",4995,"select a.business_id from (select business_id, event_type, occurences, count(event_type) over (partition by business_id) as count_event, avg(occurences) over (partition by event_type) as avg_occurences_event from schema_1126.events) as a where a.occurences > a.avg_occurences_event group by a.business_id having count(distinct a.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
613,1126,16,Medium,"SELECT a.business_id
FROM schema_1126.events a
JOIN (
    SELECT event_type, AVG(occurences) AS avgocc 
    FROM schema_1126.events 
    GROUP BY event_type
) b ON a.event_type = b.event_type AND a.occurences > b.avgocc
GROUP BY a.business_id
HAVING COUNT(*) > 1",4995,"select a.business_id from schema_1126.events as a join (select event_type, avg(occurences) as avgocc from schema_1126.events group by event_type) as b on (a.event_type = b.event_type and a.occurences > b.avgocc) group by a.business_id having count(a.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
614,1126,17,Medium,"WITH event_avg AS (
    SELECT event_type, avg(occurences) AS avg_occ_by_event 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT a.business_id 
FROM schema_1126.events a 
JOIN event_avg b ON a.event_type = b.event_type AND a.occurences > b.avg_occ_by_event 
GROUP BY a.business_id 
HAVING count(DISTINCT a.event_type) > 1",4995,"select a.business_id from schema_1126.events as a left outer join (select distinct event_type, avg(occurences) as avg_occ_by_event from schema_1126.events group by 1) as b on a.event_type = b.event_type where a.occurences > b.avg_occ_by_event group by 1 having count(distinct a.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
615,1126,23,Medium,"WITH avg_occurrences AS (
    SELECT 
        event_type, 
        AVG(occurences) AS avg_occ 
    FROM 
        schema_1126.events 
    GROUP BY 
        event_type
)
SELECT 
    e.business_id 
FROM 
    schema_1126.events e
JOIN 
    avg_occurrences a ON e.event_type = a.event_type
WHERE 
    e.occurences > a.avg_occ
GROUP BY 
    e.business_id 
HAVING 
    COUNT(DISTINCT e.event_type) > 1;",4995,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occ from schema_1126.events) as t where t.occurences > t.avg_occ group by business_id having count(event_type) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
616,1126,37,Medium,"WITH event_avgs AS (
    SELECT 
        event_type, 
        AVG(occurences) AS avg_occurences 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT 
    e.business_id 
FROM schema_1126.events e
JOIN event_avgs a ON e.event_type = a.event_type
WHERE e.occurences > a.avg_occurences
GROUP BY e.business_id 
HAVING COUNT(DISTINCT e.event_type) >= 2;",4995,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg from schema_1126.events) as b where occurences > avg group by business_id having count(event_type) >= 2",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
617,1126,39,Medium,"WITH event_avg AS (
    SELECT event_type, avg(occurences) AS average 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events t1 
JOIN event_avg t2 ON t1.event_type = t2.event_type AND t1.occurences > t2.average 
GROUP BY business_id 
HAVING COUNT(*) >= 2",4995,"select business_id from schema_1126.events as t1 join (select event_type, avg(occurences) as average from schema_1126.events group by event_type) as t2 on (t1.event_type = t2.event_type and t1.occurences > t2.average) group by business_id having count(business_id) >= 2",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
618,1126,40,Medium,"SELECT e.business_id
FROM schema_1126.events e
JOIN (
    SELECT event_type, avg(occurences) as avg_occurences 
    FROM schema_1126.events 
    GROUP BY event_type
) t ON e.event_type = t.event_type AND e.occurences > t.avg_occurences
GROUP BY e.business_id
HAVING count(DISTINCT e.event_type) > 1",4995,"select business_id from schema_1126.events as e join (select event_type, avg(occurences) as avg_occurences from schema_1126.events group by event_type) as t on (e.event_type = t.event_type and e.occurences > t.avg_occurences) group by e.business_id having count(distinct e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
619,1126,42,Medium,"SELECT business_id
FROM schema_1126.events e
JOIN (
    SELECT event_type, AVG(occurences) AS average_occurences 
    FROM schema_1126.events 
    GROUP BY event_type
) avg ON e.event_type = avg.event_type AND e.occurences > avg.average_occurences
GROUP BY business_id
HAVING COUNT(*) > 1",4995,"select business_id from schema_1126.events as e left outer join (select event_type, avg(occurences) as average_occurences from schema_1126.events group by event_type) as average on e.event_type = average.event_type where occurences > average_occurences group by business_id having count(business_id) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
620,1126,43,Medium,"SELECT business_id
FROM schema_1126.events evt
JOIN (
    SELECT event_type, AVG(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
) avg_evt ON evt.event_type = avg_evt.event_type
WHERE evt.occurences > avg_evt.avg_occ
GROUP BY business_id
HAVING COUNT(evt.event_type) > 1",4995,"select business_id from schema_1126.events as evt left outer join (select event_type, avg(occurences) as avg_occ from schema_1126.events group by 1) as avg_evt on evt.event_type = avg_evt.event_type where occurences > avg_occ group by 1 having count(evt.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
621,1126,45,Medium,"WITH event_avg AS (
    SELECT event_type, AVG(occurences) AS occurence_avg 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events e
JOIN event_avg ea ON e.event_type = ea.event_type 
WHERE e.occurences > ea.occurence_avg 
GROUP BY business_id 
HAVING COUNT(*) > 1;",4995,"select business_id from schema_1126.events join (select event_type, avg(occurences) as occurence_avg from schema_1126.events group by event_type) as event_avg on events.event_type = event_avg.event_type where events.occurences > event_avg.occurence_avg group by business_id having count(business_id) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
622,1126,46,Medium,"WITH event_avg AS (
    SELECT event_type, AVG(occurences) AS avgtimes 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events e
JOIN event_avg m ON e.event_type = m.event_type 
WHERE e.occurences > m.avgtimes 
GROUP BY business_id 
HAVING COUNT(DISTINCT e.event_type) > 1",4995,"select business_id from schema_1126.events as e join (select event_type, avg(occurences) as avgtimes from schema_1126.events group by event_type) as m on e.event_type = m.event_type where e.occurences > m.avgtimes group by business_id having count(distinct e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
623,1126,52,Medium,"SELECT business_id 
FROM schema_1126.events e
WHERE e.occurences > (SELECT avg(occurences) FROM schema_1126.events WHERE event_type = e.event_type)
GROUP BY business_id 
HAVING COUNT(DISTINCT event_type) > 1",4995,"select business_id from schema_1126.events as e join (select event_type, avg(occurences) as avg_occurence from schema_1126.events group by event_type) as t on (e.event_type = t.event_type and e.occurences > avg_occurence) group by business_id having count(distinct e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
624,1126,53,Medium,"SELECT business_id
FROM (
    SELECT business_id, COUNT(event_type) AS event_count
    FROM (
        SELECT e.business_id, e.event_type
        FROM schema_1126.events e
        JOIN (
            SELECT event_type, AVG(occurences) AS avg_occurences
            FROM schema_1126.events
            GROUP BY event_type
        ) avg ON e.event_type = avg.event_type
        WHERE e.occurences > avg.avg_occurences
    ) filtered
    GROUP BY business_id
) counted
WHERE event_count > 1;",4995,"select c.business_id from (select b.business_id, count(b.event_type) as event_count from (select a.business_id, a.event_type from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occurences from schema_1126.events) as a where a.occurences > a.avg_occurences) as b group by b.business_id) as c where c.event_count > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
625,1126,54,Medium,"WITH event_avg AS (
    SELECT event_type, avg(occurences) AS average 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id 
FROM schema_1126.events e
JOIN event_avg ea ON e.event_type = ea.event_type 
WHERE e.occurences > ea.average 
GROUP BY e.business_id 
HAVING count(e.event_type) > 1",4995,"select e.business_id from schema_1126.events as e join (select event_type, avg(occurences) as average from schema_1126.events group by event_type) as e2 on e.event_type = e2.event_type where e.occurences > e2.average group by e.business_id having count(e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
626,1126,56,Medium,"WITH event_avg AS (
    SELECT event_type, avg(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id 
FROM schema_1126.events e
JOIN event_avg t ON e.event_type = t.event_type AND e.occurences > t.avg_occ
GROUP BY e.business_id 
HAVING count(DISTINCT e.event_type) > 1",4995,"select e.business_id from schema_1126.events as e left outer join (select distinct event_type, avg(occurences) as avg_occ from schema_1126.events group by event_type) as t on e.event_type = t.event_type where e.occurences > t.avg_occ group by e.business_id having count(distinct e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
627,1126,58,Medium,"SELECT e.business_id 
FROM schema_1126.events e
JOIN (
    SELECT event_type, AVG(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
) t ON e.event_type = t.event_type AND e.occurences > t.avg_occ
GROUP BY e.business_id 
HAVING COUNT(DISTINCT e.event_type) > 1",4995,"select e.business_id from schema_1126.events as e left outer join (select event_type, avg(occurences) as avg_occ from schema_1126.events group by 1) as t on e.event_type = t.event_type where e.occurences > t.avg_occ group by 1 having count(distinct e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
628,1126,60,Medium,"WITH avg_occurrences AS (
    SELECT event_type, avg(occurences) AS avg_occur 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id
FROM schema_1126.events e
JOIN avg_occurrences a ON e.event_type = a.event_type AND e.occurences > a.avg_occur
GROUP BY e.business_id
HAVING count(DISTINCT e.event_type) > 1;",4995,"select distinct e.business_id from schema_1126.events as e left outer join (select event_type, avg(occurences) as avg_occur from schema_1126.events group by event_type) as t1 on e.event_type = t1.event_type where e.occurences > t1.avg_occur group by e.business_id having count(distinct e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
629,1126,61,Medium,"WITH event_avg AS (
    SELECT 
        event_type, 
        AVG(occurences) AS average 
    FROM 
        schema_1126.events 
    GROUP BY 
        event_type
)
SELECT 
    e.business_id 
FROM 
    schema_1126.events e
JOIN 
    event_avg a ON e.event_type = a.event_type
WHERE 
    e.occurences > a.average
GROUP BY 
    e.business_id 
HAVING 
    COUNT(DISTINCT e.event_type) > 1;",4995,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as average from schema_1126.events) as t where occurences > average group by 1 having count(event_type) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
630,1126,134,Medium,"SELECT e.business_id
FROM schema_1126.events e
JOIN (
    SELECT event_type, AVG(occurences) AS avg_occ
    FROM schema_1126.events
    GROUP BY event_type
) t1 ON e.event_type = t1.event_type AND e.occurences > t1.avg_occ
GROUP BY e.business_id
HAVING COUNT(*) > 1",4995,"select e.business_id from (select event_type, avg(occurences) as avg_occ from schema_1126.events group by event_type) as t1 left outer join schema_1126.events as e on (t1.event_type = e.event_type and e.occurences > t1.avg_occ) group by e.business_id having count(e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
631,1126,135,Medium,"SELECT events.business_id 
FROM schema_1126.events 
JOIN (
    SELECT event_type, avg(occurences) as average 
    FROM schema_1126.events 
    GROUP BY event_type
) t2 ON events.event_type = t2.event_type AND events.occurences > t2.average 
GROUP BY events.business_id 
HAVING count(DISTINCT events.event_type) > 1",4995,"select events.business_id from schema_1126.events left outer join (select event_type, avg(occurences) as average from schema_1126.events group by events.event_type) as t2 on events.event_type = t2.event_type where events.occurences > t2.average group by events.business_id having count(distinct events.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
632,1126,138,Medium,"WITH avg_occurrences AS (
    SELECT event_type, AVG(occurences) AS avg_occurence 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT a.business_id 
FROM schema_1126.events AS a 
JOIN avg_occurrences AS b ON a.event_type = b.event_type 
WHERE a.occurences > b.avg_occurence 
GROUP BY a.business_id 
HAVING COUNT(DISTINCT a.event_type) > 1",4995,"select a.business_id from schema_1126.events as a join (select event_type, avg(occurences) as avg_occurence from schema_1126.events group by event_type) as b on a.event_type = b.event_type where a.occurences > b.avg_occurence group by a.business_id having count(distinct a.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
633,1126,141,Medium,"WITH event_means AS (
    SELECT event_type, AVG(occurences) AS mean 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT a.business_id 
FROM schema_1126.events a
JOIN event_means c ON a.event_type = c.event_type AND a.occurences > c.mean
GROUP BY a.business_id 
HAVING COUNT(*) >= 2;",4995,"select a.business_id from schema_1126.events as a left outer join (select event_type, avg(occurences) as mean from schema_1126.events group by event_type) as c on a.event_type = c.event_type where a.occurences > c.mean group by a.business_id having count(c.event_type) >= 2",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
634,1126,142,Medium,"WITH event_avg AS (
    SELECT event_type, AVG(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events a
JOIN event_avg b ON a.event_type = b.event_type AND a.occurences > b.avg_occ
GROUP BY business_id 
HAVING COUNT(*) > 1;",4995,"select a.business_id from schema_1126.events as a left outer join (select avg(occurences) as avg_occ, event_type from schema_1126.events group by event_type) as b on a.event_type = b.event_type where a.occurences > b.avg_occ group by business_id having count(business_id) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
635,1126,151,Medium,"WITH event_avgs AS (
    SELECT event_type, AVG(occurences) AS event_avg 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events e
JOIN event_avgs a ON e.event_type = a.event_type
WHERE e.occurences > a.event_avg
GROUP BY business_id 
HAVING COUNT(e.event_type) > 1;",4995,"select business_id from (select a.business_id, a.event_type, a.occurences, b.event_avg from schema_1126.events as a left outer join (select event_type, avg(occurences) as event_avg from schema_1126.events group by event_type) as b on a.event_type = b.event_type) as temp where occurences > event_avg group by business_id having count(event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
636,1126,155,Medium,"SELECT business_id
FROM schema_1126.events e1
WHERE occurences > (SELECT AVG(occurences) FROM schema_1126.events e2 WHERE e2.event_type = e1.event_type)
GROUP BY business_id
HAVING COUNT(*) > 1;",4995,"select business_id from (select business_id, avg(occurences) over (partition by event_type) as avg_occ, occurences from schema_1126.events) as e where occurences > avg_occ group by business_id having count(business_id) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
637,1126,157,Medium,"WITH event_averages AS (
    SELECT 
        event_type, 
        AVG(occurences) AS average 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id
FROM (
    SELECT 
        e.business_id, 
        COUNT(DISTINCT e.event_type) AS cnt
    FROM schema_1126.events e
    JOIN event_averages a ON e.event_type = a.event_type
    WHERE e.occurences > a.average
    GROUP BY e.business_id
) t
WHERE cnt > 1;",4995,"select business_id from (select business_id, count(event_type) as cnt from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as average from schema_1126.events) as t where occurences > average group by 1) as t where cnt > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
638,1126,159,Medium,"WITH avg_occurrences AS (
    SELECT 
        event_type, 
        AVG(occurences) AS avg_occurances 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id
FROM schema_1126.events e
JOIN avg_occurrences a ON e.event_type = a.event_type
WHERE e.occurences > a.avg_occurances
GROUP BY e.business_id
HAVING COUNT(DISTINCT e.event_type) > 1;",4995,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occurances from schema_1126.events) as asd where occurences > asd.avg_occurances group by business_id having count(event_type) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
639,1126,160,Medium,"WITH event_avg AS (
    SELECT event_type, AVG(occurences) AS avg_occurences 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events e
JOIN event_avg a ON e.event_type = a.event_type
WHERE e.occurences > a.avg_occurences
GROUP BY business_id 
HAVING COUNT(DISTINCT e.event_type) > 1;",4995,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occurences from schema_1126.events) as t where occurences > avg_occurences group by 1 having count(event_type) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
640,1126,162,Medium,"WITH event_avg AS (
    SELECT event_type, AVG(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
),
business_events AS (
    SELECT 
        business_id, 
        event_type, 
        SUM(occurences) AS occ 
    FROM schema_1126.events 
    GROUP BY business_id, event_type
)
SELECT business_id
FROM business_events be
JOIN event_avg ea ON be.event_type = ea.event_type AND be.occ > ea.avg_occ
GROUP BY business_id
HAVING COUNT(be.event_type) > 1;",4995,"select business_id from (select business_id, event_type, sum(occurences) as occ from schema_1126.events group by business_id, event_type) as t1 left outer join (select event_type, avg(occurences) as avg_occ from schema_1126.events group by event_type) as t2 on t1.event_type = t2.event_type where t1.occ > t2.avg_occ group by business_id having count(t1.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
641,1126,163,Medium,"SELECT business_id
FROM (
    SELECT 
        business_id, 
        occurences, 
        AVG(occurences) OVER (PARTITION BY event_type) as avgocc
    FROM schema_1126.events
) t1
WHERE occurences > avgocc
GROUP BY business_id
HAVING COUNT(*) > 1",4995,"select business_id from (select business_id, event_type, occurences, count(event_type) over (partition by business_id) as cnt, avg(occurences) over (partition by event_type) as avgocc from schema_1126.events) as t1 where occurences > avgocc group by 1 having count(business_id) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
642,1126,164,Medium,"WITH avg_occurrences AS (
    SELECT 
        event_type, 
        AVG(occurences) AS avg_occ
    FROM schema_1126.events
    GROUP BY event_type
)
SELECT 
    e.business_id
FROM schema_1126.events e
JOIN avg_occurrences a ON e.event_type = a.event_type
WHERE e.occurences > a.avg_occ
GROUP BY e.business_id
HAVING COUNT(*) > 1;",4995,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avgocc from schema_1126.events) as t1 where occurences > avgocc group by 1 having count(business_id) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
643,1126,165,Medium,"WITH avg_occurrences AS (
    SELECT 
        event_type, 
        AVG(occurences) AS avg_occ
    FROM 
        schema_1126.events
    GROUP BY 
        event_type
)
SELECT 
    e.business_id
FROM 
    schema_1126.events e
JOIN 
    avg_occurrences a ON e.event_type = a.event_type
WHERE 
    e.occurences > a.avg_occ
GROUP BY 
    e.business_id
HAVING 
    COUNT(DISTINCT e.event_type) > 1;",4995,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avgocc from schema_1126.events) as t1 where occurences > avgocc group by 1 having count(event_type) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
644,1126,166,Medium,"WITH event_avgs AS (
    SELECT event_type, avg(occurences) AS avgo 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events e
JOIN event_avgs a ON e.event_type = a.event_type
WHERE e.occurences > a.avgo
GROUP BY business_id 
HAVING COUNT(e.event_type) > 1",4995,"select business_id from (select event_type, avg(occurences) as avgo from schema_1126.events group by event_type) as tmp join schema_1126.events on tmp.event_type = events.event_type where events.occurences > tmp.avgo group by events.business_id having count(events.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
645,1126,178,Medium,"SELECT a.business_id
FROM schema_1126.events a
JOIN (
    SELECT event_type, AVG(occurences) AS avg_occur 
    FROM schema_1126.events 
    GROUP BY event_type
) b ON a.event_type = b.event_type AND a.occurences > b.avg_occur
GROUP BY a.business_id
HAVING COUNT(DISTINCT a.event_type) > 1",4995,"select business_id from (select a.business_id, a.event_type from schema_1126.events as a join (select event_type, avg(occurences) as avg_occur from schema_1126.events group by 1) as b on (a.event_type = b.event_type and a.occurences > b.avg_occur)) as temp group by 1 having count(distinct event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
646,1126,180,Medium,"SELECT business_id
FROM schema_1126.events a
JOIN (
    SELECT event_type, AVG(occurences) AS avg_occur 
    FROM schema_1126.events 
    GROUP BY event_type
) cte ON a.event_type = cte.event_type AND a.occurences > cte.avg_occur
GROUP BY business_id
HAVING COUNT(DISTINCT a.event_type) > 1",4995,"select business_id from (select a.business_id, a.event_type from schema_1126.events as a left outer join (select event_type, avg(occurences) as avg_occur from schema_1126.events group by event_type) as cte on a.event_type = cte.event_type where a.occurences > cte.avg_occur) as cte2 group by business_id having count(event_type) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
647,1126,188,Medium,"WITH event_avgs AS (
    SELECT 
        event_type, 
        AVG(occurences) AS event_avg
    FROM schema_1126.events
    GROUP BY event_type
),
above_avg_events AS (
    SELECT 
        e.business_id, 
        e.event_type
    FROM schema_1126.events e
    JOIN event_avgs a ON e.event_type = a.event_type
    WHERE e.occurences > a.event_avg
)
SELECT business_id
FROM above_avg_events
GROUP BY business_id
HAVING COUNT(DISTINCT event_type) > 1;",4995,"select business_id from (select business_id, event_type from (select business_id, event_type, avg(occurences) over (partition by event_type) as event_avg, occurences from schema_1126.events) as t where occurences > event_avg) as tt group by business_id having count(distinct event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
648,1126,189,Medium,"WITH event_avg AS (
    SELECT 
        event_type, 
        AVG(occurences) AS average
    FROM schema_1126.events
    GROUP BY event_type
)
SELECT business_id
FROM schema_1126.events e
JOIN event_avg a ON e.event_type = a.event_type
WHERE e.occurences > a.average
GROUP BY business_id
HAVING COUNT(DISTINCT e.event_type) >= 2;",4995,"select business_id from (select business_id, event_type from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as average from schema_1126.events) as a where occurences > average) as a group by business_id having count(event_type) >= 2",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
649,1126,190,Medium,"WITH event_avg AS (
    SELECT event_type, AVG(occurences) AS avg_event_occur
    FROM schema_1126.events
    GROUP BY event_type
)
SELECT business_id
FROM schema_1126.events e
JOIN event_avg a ON e.event_type = a.event_type
WHERE e.occurences > a.avg_event_occur
GROUP BY business_id
HAVING COUNT(DISTINCT e.event_type) > 1;",4995,"select business_id from (select business_id, event_type, avg(occurences) over (partition by event_type) as avg_event_occur, occurences from schema_1126.events) as sub where occurences > avg_event_occur group by 1 having count(distinct event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
650,1126,193,Medium,"WITH event_avg AS (
    SELECT 
        event_type, 
        AVG(occurences) AS avg_o 
    FROM 
        schema_1126.events 
    GROUP BY 
        event_type
)
SELECT 
    business_id 
FROM 
    schema_1126.events e
JOIN 
    event_avg a ON e.event_type = a.event_type
WHERE 
    e.occurences > a.avg_o
GROUP BY 
    business_id 
HAVING 
    COUNT(*) > 1;",4995,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_o from schema_1126.events) as t where occurences > avg_o group by business_id having count(business_id) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
651,1126,195,Medium,"WITH event_avgs AS (
    SELECT 
        event_type, 
        AVG(occurences) AS avg_occ
    FROM schema_1126.events
    GROUP BY event_type
)
SELECT business_id
FROM schema_1126.events e
JOIN event_avgs a ON e.event_type = a.event_type
WHERE e.occurences > a.avg_occ
GROUP BY business_id
HAVING COUNT(*) > 1;",4995,"select business_id from (select business_id, occurences, avg(occurences) over (partition by event_type) as avg_occ from schema_1126.events) as a where a.occurences > avg_occ group by business_id having count(business_id) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
652,1126,196,Medium,"WITH avg_events AS (
    SELECT event_type, avg(occurences) AS ave_occurences 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events e2
JOIN avg_events e1 ON e1.event_type = e2.event_type AND e2.occurences > e1.ave_occurences
GROUP BY business_id 
HAVING count(DISTINCT e1.event_type) > 1",4995,"select business_id from (select event_type, avg(occurences) as ave_occurences from schema_1126.events group by event_type) as e1 join schema_1126.events as e2 on (e1.event_type = e2.event_type and e2.occurences > e1.ave_occurences) group by business_id having count(distinct e1.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
653,1126,197,Medium,"WITH avg_events AS (
    SELECT event_type, avg(occurences) AS ave_occurences 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events e2
JOIN avg_events e1 ON e1.event_type = e2.event_type AND e2.occurences > e1.ave_occurences
GROUP BY business_id 
HAVING count(DISTINCT e2.event_type) > 1",4995,"select business_id from (select event_type, avg(occurences) as ave_occurences from schema_1126.events group by event_type) as e1 join schema_1126.events as e2 on (e1.event_type = e2.event_type and e2.occurences > e1.ave_occurences) group by business_id having count(distinct e2.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
654,1126,198,Medium,"WITH avg_occurrences AS (
    SELECT event_type, avg(occurences) AS ave_occurences 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id
FROM schema_1126.events e
JOIN avg_occurrences a ON e.event_type = a.event_type
WHERE e.occurences > a.ave_occurences
GROUP BY e.business_id
HAVING COUNT(DISTINCT e.event_type) > 1;",4995,"select business_id from (select event_type, avg(occurences) as ave_occurences from schema_1126.events as e1 group by event_type) as temp1 join schema_1126.events as e2 on temp1.event_type = e2.event_type where e2.occurences > temp1.ave_occurences group by business_id having count(distinct temp1.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
655,1126,200,Medium,"WITH event_avg AS (
    SELECT event_type, avg(occurences) AS avg_events 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events e
JOIN event_avg ea ON e.event_type = ea.event_type
WHERE e.occurences > ea.avg_events
GROUP BY business_id 
HAVING count(DISTINCT e.event_type) > 1;",4995,"select business_id from (select event_type, avg(occurences) as avg_events from schema_1126.events group by event_type) as temp1 join schema_1126.events as temp2 on temp1.event_type = temp2.event_type where temp2.occurences > temp1.avg_events group by business_id having count(distinct temp2.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
656,1126,203,Medium,"WITH avg_occurrences AS (
    SELECT event_type, AVG(occurences) AS avg_occurences 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events a
JOIN avg_occurrences b ON a.event_type = b.event_type 
WHERE a.occurences > b.avg_occurences 
GROUP BY business_id 
HAVING COUNT(DISTINCT a.event_type) > 1",4995,"select business_id from schema_1126.events as a join (select event_type, avg(occurences) as avg_occurences from schema_1126.events group by event_type) as b on a.event_type = b.event_type where a.occurences > b.avg_occurences group by business_id having count(distinct a.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
657,1126,204,Medium,"WITH event_avgs AS (
    SELECT event_type, avg(occurences) AS event_avg 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT a.business_id 
FROM schema_1126.events a
JOIN event_avgs b ON a.event_type = b.event_type 
WHERE a.occurences > b.event_avg 
GROUP BY a.business_id 
HAVING count(DISTINCT a.event_type) > 1",4995,"select business_id from schema_1126.events as a join (select event_type, avg(occurences) as event_avg from schema_1126.events group by event_type) as b on a.event_type = b.event_type where a.occurences > event_avg group by a.business_id having count(distinct a.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
658,1126,208,Medium,"SELECT business_id
FROM schema_1126.events e
JOIN (
    SELECT event_type, AVG(occurences) AS avg_occu
    FROM schema_1126.events
    GROUP BY event_type
) a ON e.event_type = a.event_type AND e.occurences > a.avg_occu
GROUP BY business_id
HAVING COUNT(*) >= 2",4995,"select business_id from schema_1126.events as e join (select event_type, avg(occurences) as occu from schema_1126.events group by event_type) as a on (e.event_type = a.event_type and e.occurences > a.occu) group by business_id having count(e.event_type) >= 2",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
659,1126,212,Medium,"WITH event_avgs AS (
    SELECT event_type, AVG(occurences) AS avg_occurences 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id 
FROM schema_1126.events e
JOIN event_avgs a ON e.event_type = a.event_type AND e.occurences > a.avg_occurences
GROUP BY e.business_id 
HAVING COUNT(e.event_type) > 1;",4995,"select business_id from schema_1126.events as e1 left outer join (select event_type, avg(occurences) as avg from schema_1126.events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avg group by business_id having count(e1.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
660,1126,214,Medium,"WITH event_avg AS (
    SELECT event_type, avg(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events e1
JOIN event_avg e2 ON e1.event_type = e2.event_type 
WHERE e1.occurences > e2.avg_occ 
GROUP BY business_id 
HAVING count(DISTINCT e1.event_type) > 1;",4995,"select business_id from schema_1126.events as e1 left outer join (select event_type, avg(occurences) as avg_occ from schema_1126.events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avg_occ group by business_id having count(distinct e1.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
661,1126,219,Medium,"SELECT a.business_id
FROM schema_1126.events a
JOIN (
    SELECT event_type, AVG(occurences) AS avg_cnt 
    FROM schema_1126.events 
    GROUP BY event_type
) b ON a.event_type = b.event_type AND a.occurences > b.avg_cnt
GROUP BY a.business_id
HAVING COUNT(a.event_type) > 1",4995,"select business_id from schema_1126.events as a join (select event_type, avg(occurences) as avg_cnt from schema_1126.events group by 1) as b on a.event_type = b.event_type where a.occurences > b.avg_cnt group by 1 having count(a.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
662,1126,220,Medium,"SELECT a.business_id
FROM schema_1126.events a
JOIN (
    SELECT event_type, AVG(occurences) AS avg_occ
    FROM schema_1126.events
    GROUP BY event_type
) b ON a.event_type = b.event_type AND a.occurences > b.avg_occ
GROUP BY a.business_id
HAVING COUNT(*) > 1",4995,"select business_id from schema_1126.events as a left outer join (select avg(occurences) as avg_occ, event_type from schema_1126.events group by event_type) as b on a.event_type = b.event_type where a.occurences > b.avg_occ group by business_id having count(business_id) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
663,1126,228,Medium,"WITH event_avg AS (
    SELECT event_type, AVG(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id
FROM schema_1126.events e
JOIN event_avg a ON e.event_type = a.event_type
WHERE e.occurences > a.avg_occ
GROUP BY e.business_id
HAVING COUNT(DISTINCT e.event_type) > 1;",4995,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occ from schema_1126.events) as temp where occurences > avg_occ group by business_id having count(event_type) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
664,1126,233,Medium,"SELECT business_id
FROM schema_1126.events e
WHERE occurences > (SELECT AVG(occurences) FROM schema_1126.events WHERE event_type = e.event_type)
GROUP BY business_id
HAVING COUNT(*) > 1",4995,"select c.business_id from (select business_id, a.event_type, b.occurences as occurences, a.occurences as occurences_average from schema_1126.events as b left outer join (select event_type, avg(occurences) as occurences from schema_1126.events group by event_type) as a on b.event_type = a.event_type where b.occurences > a.occurences) as c group by c.business_id having count(c.business_id) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
665,1126,234,Medium,"WITH event_avg AS (
    SELECT event_type, AVG(occurences) AS average
    FROM schema_1126.events
    GROUP BY event_type
)
SELECT business_id
FROM schema_1126.events e
JOIN event_avg a ON e.event_type = a.event_type
WHERE e.occurences > a.average
GROUP BY business_id
HAVING COUNT(*) > 1;",4995,"select c.business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as average from schema_1126.events) as c where c.occurences > c.average group by c.business_id having count(business_id) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
666,1126,239,Medium,"WITH avg_occurrences AS (
    SELECT event_type, avg(occurences) AS avgoccurences 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id
FROM schema_1126.events a
JOIN avg_occurrences b ON a.event_type = b.event_type AND a.occurences > b.avgoccurences
GROUP BY business_id
HAVING count(DISTINCT a.event_type) > 1;",4995,"select distinct business_id from schema_1126.events as a join (select event_type, avg(occurences) as avgoccurences from schema_1126.events group by event_type) as b on a.event_type = b.event_type where a.occurences > b.avgoccurences group by business_id having count(distinct a.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
667,1126,241,Medium,"SELECT e.business_id
FROM schema_1126.events e
JOIN (
    SELECT event_type, avg(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
) a ON e.event_type = a.event_type AND e.occurences > a.avg_occ
GROUP BY e.business_id
HAVING COUNT(DISTINCT e.event_type) > 1",4995,"select distinct e.business_id as business_id from (select event_type, avg(occurences) as avg_occ from schema_1126.events group by event_type) as a join schema_1126.events as e on (a.event_type = e.event_type and a.avg_occ < e.occurences) group by e.business_id having count(distinct e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
668,1126,242,Medium,"SELECT e.business_id
FROM schema_1126.events e
JOIN (
    SELECT event_type, avg(occurences) as avg_occurences 
    FROM schema_1126.events 
    GROUP BY event_type
) avg ON e.event_type = avg.event_type AND e.occurences > avg.avg_occurences
GROUP BY e.business_id
HAVING count(DISTINCT e.event_type) > 1",4995,"select distinct e.business_id as business_id from schema_1126.events as e join (select event_type, avg(occurences) as avg_occurences from schema_1126.events group by 1) as avg on e.event_type = avg.event_type where e.occurences > avg.avg_occurences group by 1 having count(e.event_type) > 1",4995,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
669,1126,243,Medium,"SELECT e.business_id
FROM schema_1126.events e
JOIN (
    SELECT event_type, avg(occurences) as avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
) x ON e.event_type = x.event_type AND e.occurences > x.avg_occ
GROUP BY e.business_id
HAVING count(DISTINCT e.event_type) > 1",4995,"select distinct e.business_id from schema_1126.events as e left outer join (select event_type, avg(occurences) as avg_occ from schema_1126.events group by event_type) as x on e.event_type = x.event_type where e.occurences > x.avg_occ group by 1 having count(distinct e.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
670,1126,248,Medium,"WITH avg_events AS (
    SELECT event_type, AVG(occurences) AS avg_occu 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id
FROM schema_1126.events e
JOIN avg_events t ON e.event_type = t.event_type AND e.occurences > t.avg_occu
GROUP BY e.business_id
HAVING COUNT(DISTINCT e.event_type) > 1",4995,"select e.business_id from (select event_type, avg(occurences) as avg_occu from schema_1126.events group by 1) as t join schema_1126.events as e on t.event_type = e.event_type where e.occurences > t.avg_occu group by 1 having count(distinct t.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
671,1126,251,Medium,"WITH avg_events AS (
    SELECT event_type, AVG(occurences) AS avo 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id 
FROM schema_1126.events e
JOIN avg_events a ON e.event_type = a.event_type AND e.occurences > a.avo
GROUP BY e.business_id 
HAVING COUNT(DISTINCT e.event_type) >= 2;",4995,"select e.business_id from schema_1126.events as e join (select event_type, avg(occurences) as avo from schema_1126.events group by event_type) as a on e.event_type = a.event_type where e.occurences > a.avo group by e.business_id having count(distinct e.event_type) >= 2",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
672,1126,253,Medium,"WITH event_avg AS (
    SELECT event_type, avg(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id 
FROM schema_1126.events e
JOIN event_avg t ON e.event_type = t.event_type AND e.occurences > t.avg_occ
GROUP BY e.business_id 
HAVING COUNT(*) > 1",4995,"select e.business_id from schema_1126.events as e left outer join (select event_type, avg(occurences) as avg_occ from schema_1126.events group by event_type) as t on e.event_type = t.event_type where e.occurences > t.avg_occ group by e.business_id having count(e.business_id) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
673,1126,254,Medium,"WITH business_avg AS (
    SELECT business_id, event_type, avg(occurences) AS e_avg 
    FROM schema_1126.events 
    GROUP BY business_id, event_type
),
event_avg AS (
    SELECT event_type, avg(occurences) AS e_avg 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM business_avg ba
JOIN event_avg ea ON ba.event_type = ea.event_type AND ba.e_avg > ea.e_avg
GROUP BY business_id 
HAVING COUNT(ba.event_type) > 1",4995,"select e1.business_id from (select business_id, event_type, avg(occurences) as e_avg from schema_1126.events group by business_id, event_type) as e1 join (select event_type, avg(occurences) as e_avg from schema_1126.events group by event_type) as e2 on e1.event_type = e2.event_type where e1.e_avg > e2.e_avg group by business_id having count(e1.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
674,1126,256,Medium,"WITH event_avg AS (
    SELECT event_type, AVG(occurences) AS avg_occurences
    FROM schema_1126.events
    GROUP BY event_type
)
SELECT e.business_id
FROM schema_1126.events e
JOIN event_avg ea ON e.event_type = ea.event_type
WHERE e.occurences > ea.avg_occurences
GROUP BY e.business_id
HAVING COUNT(*) >= 2;",4995,"select e2.business_id from schema_1126.events as e2 join (select e1.event_type, avg(e1.occurences) as avg from schema_1126.events as e1 group by e1.event_type) as temp on e2.event_type = temp.event_type where e2.occurences > temp.avg group by e2.business_id having count(e2.business_id) >= 2",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
675,1126,259,Medium,"WITH event_means AS (
    SELECT event_type, AVG(occurences) AS mean 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id 
FROM schema_1126.events t1
JOIN event_means t2 ON t1.event_type = t2.event_type 
WHERE t1.occurences > t2.mean 
GROUP BY business_id 
HAVING COUNT(*) > 1",4995,"select t1.business_id from schema_1126.events as t1 join (select event_type, avg(occurences) as mean from schema_1126.events group by event_type) as t2 on t1.event_type = t2.event_type where t1.occurences > t2.mean group by t1.business_id having count(t1.business_id) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
676,1126,261,Medium,"WITH avg_events AS (
    SELECT event_type, AVG(occurences) AS avg_occ 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT business_id
FROM schema_1126.events e
JOIN avg_events t1 ON e.event_type = t1.event_type AND e.occurences > t1.avg_occ
GROUP BY business_id
HAVING COUNT(e.event_type) > 1;",4995,"select t2.business_id from (select e.business_id, count(e.event_type) as event_count from (select event_type, avg(occurences) as avg_occ from schema_1126.events group by event_type) as t1 left outer join schema_1126.events as e on (t1.event_type = e.event_type and e.occurences > t1.avg_occ) group by e.business_id) as t2 where t2.event_count > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
677,1126,262,Medium,"SELECT e2.business_id
FROM schema_1126.events e2
JOIN (
    SELECT event_type, avg(occurences) as ave_occurences
    FROM schema_1126.events
    GROUP BY event_type
) temp1 ON e2.event_type = temp1.event_type
WHERE e2.occurences > temp1.ave_occurences
GROUP BY e2.business_id
HAVING count(e2.event_type) > 1;",4995,"select t2.business_id from (select e2.business_id, count(e2.event_type) as ev_c from (select event_type, avg(occurences) as ave_occurences from schema_1126.events as e1 group by event_type) as temp1 join schema_1126.events as e2 on temp1.event_type = e2.event_type where e2.occurences > temp1.ave_occurences group by e2.business_id) as t2 where t2.ev_c > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
678,1126,397,Medium,"WITH event_avg AS (
    SELECT event_type, AVG(occurences) AS average 
    FROM schema_1126.events 
    GROUP BY event_type
)
SELECT e.business_id
FROM schema_1126.events e
JOIN event_avg ea ON e.event_type = ea.event_type AND e.occurences > ea.average
GROUP BY e.business_id
HAVING COUNT(DISTINCT e.event_type) > 1;",4995,"with temp1 as (select event_type, avg(occurences) as average from schema_1126.events group by event_type) select business_id from (select event_type, avg(occurences) as average from schema_1126.events group by event_type) as temp1 join schema_1126.events as e2 on (e2.event_type = temp1.event_type and e2.occurences > temp1.average) group by e2.business_id having count(distinct temp1.event_type) > 1",4995,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
679,1141,12,Easy,"SELECT activity_date AS day, COUNT(DISTINCT user_id) AS active_users 
FROM schema_1141.activity 
WHERE activity_date <= '2019-07-27' AND activity_date > '2019-06-27'
GROUP BY activity_date;",15,"select activity_date as day, count(distinct user_id) as active_users from schema_1141.activity group by activity_date having (activity_date <= '2019-07-27' and activity_date > '2019-06-27')",15,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
680,1141,27,Easy,"SELECT activity_date AS day, COUNT(DISTINCT user_id) AS active_users 
FROM schema_1141.activity 
WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' 
GROUP BY activity_date",15,"select activity_date as day, count(distinct user_id) as active_users from schema_1141.activity where (activity_date <= '2019-07-27' and activity_date > '2019-06-27') group by activity_date",15,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
681,1141,45,Easy,"SELECT activity_date AS day, COUNT(DISTINCT user_id) AS active_users 
FROM schema_1141.activity 
WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' 
GROUP BY activity_date",15,"select activity_date as day, count(distinct user_id) as active_users from schema_1141.activity where (activity_date >= '2019-06-28' and activity_date <= '2019-07-27') group by 1",15,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
682,1141,59,Easy,"SELECT activity_date AS day, COUNT(DISTINCT user_id) AS active_users 
FROM schema_1141.activity 
WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' 
GROUP BY activity_date",15,"select activity_date as day, count(distinct user_id) as active_users from schema_1141.activity where (activity_date <= '2019-07-27' and activity_date >= '2019-06-28') group by activity_date",15,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
683,1141,108,Easy,"SELECT activity_date AS day, COUNT(DISTINCT user_id) AS active_users 
FROM schema_1141.activity 
WHERE activity_date > '2019-06-27' AND activity_date <= '2019-07-27'
GROUP BY activity_date;",15,"select activity_date as day, count(distinct user_id) as active_users from schema_1141.activity group by activity_date having (activity_date > '2019-06-27' and activity_date <= '2019-07-27')",15,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
684,1141,144,Easy,"SELECT activity_date AS day, COUNT(DISTINCT user_id) AS active_users 
FROM schema_1141.activity 
WHERE activity_date > '2019-06-27' AND activity_date <= '2019-07-27' 
GROUP BY activity_date",15,"select activity_date as day, count(distinct user_id) as active_users from schema_1141.activity where ('2019-06-27' < activity_date and activity_date <= '2019-07-27') group by 1",15,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
685,1141,147,Easy,"SELECT activity_date AS day, COUNT(DISTINCT user_id) AS active_users 
FROM schema_1141.activity 
WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27' 
GROUP BY activity_date",15,"select activity_date as day, count(distinct user_id) as active_users from schema_1141.activity where (activity_date > '2019-06-27' and activity_date <= '2019-07-27') group by activity_date",15,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
686,1148,2,Easy,SELECT author_id AS id FROM schema_1148.views WHERE author_id = viewer_id GROUP BY author_id ORDER BY author_id,208,select distinct author_id as id from schema_1148.views where author_id = viewer_id order by author_id,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
687,1148,7,Easy,SELECT author_id AS id FROM schema_1148.views WHERE author_id = viewer_id GROUP BY author_id ORDER BY author_id ASC,208,select distinct author_id as id from schema_1148.views where author_id = viewer_id order by author_id asc,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
688,1148,29,Easy,"SELECT DISTINCT v1.author_id AS id 
FROM schema_1148.views v1 
WHERE EXISTS (
    SELECT 1 
    FROM schema_1148.views v2 
    WHERE v1.article_id = v2.article_id 
    AND v1.author_id = v2.viewer_id
) 
ORDER BY v1.author_id;",316,select distinct v1.author_id as id from schema_1148.views as v1 join schema_1148.views as v2 on (v1.article_id = v2.article_id and v1.author_id = v2.viewer_id) order by v1.author_id,316,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
689,1148,46,Easy,SELECT DISTINCT author_id AS id FROM schema_1148.views WHERE author_id = viewer_id ORDER BY author_id,208,select author_id as id from schema_1148.views where author_id = viewer_id group by author_id order by author_id,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
690,1148,55,Easy,SELECT DISTINCT author_id AS id FROM schema_1148.views WHERE author_id = viewer_id ORDER BY author_id ASC,208,select author_id as id from schema_1148.views where author_id = viewer_id group by author_id order by author_id asc,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
691,1148,62,Easy,SELECT author_id AS id FROM schema_1148.views WHERE viewer_id = author_id GROUP BY author_id ORDER BY author_id,208,select distinct author_id as id from schema_1148.views where viewer_id = author_id order by author_id,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
692,1148,66,Easy,SELECT DISTINCT author_id AS id FROM schema_1148.views WHERE author_id = viewer_id ORDER BY author_id,208,select t.author_id as id from (select author_id from schema_1148.views where author_id = viewer_id group by author_id having count(author_id) >= 1) as t order by t.author_id,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
693,1148,67,Easy,SELECT author_id AS id FROM schema_1148.views WHERE author_id = viewer_id GROUP BY author_id ORDER BY author_id ASC,208,select distinct v1.author_id as id from schema_1148.views as v1 where v1.author_id = v1.viewer_id order by v1.author_id asc,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
694,1148,82,Easy,SELECT DISTINCT author_id AS id FROM schema_1148.views WHERE author_id = viewer_id ORDER BY author_id,208,select author_id as id from schema_1148.views as a where author_id = viewer_id group by author_id order by author_id,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
695,1148,88,Easy,SELECT DISTINCT author_id AS id FROM schema_1148.views WHERE author_id = viewer_id ORDER BY author_id ASC,208,select author_id as id from schema_1148.views where author_id = viewer_id group by author_id having count(author_id) >= 1 order by author_id asc,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
696,1148,90,Easy,SELECT DISTINCT author_id AS id FROM schema_1148.views WHERE viewer_id = author_id ORDER BY author_id ASC,208,select author_id as id from schema_1148.views where viewer_id = author_id group by author_id order by author_id asc,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
697,1148,97,Easy,SELECT DISTINCT author_id AS id FROM schema_1148.views WHERE author_id = viewer_id ORDER BY author_id ASC,208,"select author_id as id from schema_1148.views where author_id = viewer_id group by author_id, viewer_id order by author_id asc",208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
698,1148,107,Easy,"SELECT DISTINCT a.author_id AS id 
FROM schema_1148.views a 
WHERE EXISTS (
    SELECT 1 
    FROM schema_1148.views b 
    WHERE a.article_id = b.article_id 
    AND a.author_id = b.viewer_id
) 
ORDER BY a.author_id",316,select distinct a.author_id as id from schema_1148.views as a join schema_1148.views as b on (a.article_id = b.article_id and a.author_id = b.viewer_id) order by a.author_id,316,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
699,1148,111,Easy,SELECT author_id AS id FROM schema_1148.views WHERE author_id = viewer_id GROUP BY author_id ORDER BY author_id,208,select distinct author_id as id from schema_1148.views as v where v.author_id = v.viewer_id order by author_id,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
700,1148,152,Easy,SELECT viewer_id AS id FROM schema_1148.views WHERE author_id = viewer_id GROUP BY viewer_id ORDER BY viewer_id ASC,208,select distinct viewer_id as id from schema_1148.views where author_id = viewer_id order by viewer_id asc,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
701,1148,153,Easy,SELECT viewer_id AS id FROM schema_1148.views WHERE author_id = viewer_id GROUP BY viewer_id ORDER BY viewer_id,208,select distinct viewer_id as id from schema_1148.views where author_id = viewer_id order by viewer_id,208,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
731,1149,167,Medium,"SELECT viewer_id AS id 
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS article_count
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
) AS grouped_views
WHERE article_count > 1
GROUP BY viewer_id;",100,"select distinct v.viewer_id as id from schema_1149.views as v group by viewer_id, view_date having count(distinct article_id) > 1",100,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
715,1149,52,Medium,"SELECT viewer_id AS id 
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS article_count
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
) AS grouped_views
WHERE article_count >= 2
GROUP BY viewer_id;",100,"select distinct viewer_id as id from schema_1149.views group by viewer_id, view_date having count(distinct article_id) >= 2",100,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
708,1149,18,Medium,"SELECT viewer_id AS id 
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS cnt
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
) t
WHERE cnt > 1
GROUP BY viewer_id;",100,"select distinct viewer_id as id from schema_1149.views group by viewer_id, view_date having count(distinct article_id) > 1",100,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
720,1149,87,Medium,"SELECT viewer_id AS id 
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS total_article 
    FROM schema_1149.views 
    GROUP BY viewer_id, view_date 
    HAVING COUNT(DISTINCT article_id) > 1
) AS temp 
GROUP BY viewer_id 
ORDER BY viewer_id",100,"select distinct temp.viewer_id as id from (select viewer_id, view_date, count(distinct article_id) as total_article from schema_1149.views group by viewer_id, view_date having count(distinct article_id) > 1) as temp order by temp.viewer_id",100,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
718,1149,81,Medium,"SELECT viewer_id AS id 
FROM schema_1149.views 
GROUP BY viewer_id 
HAVING COUNT(DISTINCT (view_date, article_id)) > 1 
ORDER BY id;",100,"select distinct id from (select view_date, viewer_id as id from schema_1149.views group by view_date, viewer_id having count(distinct article_id) > 1) as cte order by id",100,0,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,
716,1149,53,Medium,"SELECT viewer_id AS id 
FROM schema_1149.views 
GROUP BY viewer_id, view_date 
HAVING COUNT(DISTINCT article_id) > 1",27263,"select distinct viewer_id as id from schema_1149.views as v1 group by viewer_id, view_date having count(distinct article_id) > 1",100,27163,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,
724,1149,105,Medium,"SELECT viewer_id AS id 
FROM schema_1149.views 
GROUP BY viewer_id, view_date 
HAVING COUNT(DISTINCT article_id) > 1",27263,"select distinct viewer_id as id from (select viewer_id, view_date from schema_1149.views group by 1, 2 having count(distinct article_id) > 1) as a",100,27163,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,
729,1149,160,Medium,"SELECT viewer_id AS id 
FROM schema_1149.views 
GROUP BY viewer_id, view_date 
HAVING COUNT(DISTINCT article_id) > 1",27263,"select distinct viewer_id as id from (select viewer_id, view_date from schema_1149.views group by 1, 2 having count(distinct article_id) > 1) as x",100,27163,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,
719,1149,84,Medium,"SELECT viewer_id AS id 
FROM schema_1149.views 
GROUP BY viewer_id, view_date 
HAVING COUNT(DISTINCT article_id) > 1 
ORDER BY id;",27263,"select distinct id from (select view_date, viewer_id as id from schema_1149.views group by 1, 2 having count(distinct article_id) > 1) as sub order by id",100,27163,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,
703,1149,5,Medium,"SELECT viewer_id AS id 
FROM schema_1149.views 
GROUP BY viewer_id, view_date 
HAVING COUNT(DISTINCT article_id) > 1 
ORDER BY viewer_id ASC;",27263,"select distinct viewer_id as id from (select viewer_id, view_date, count(distinct article_id) as count from schema_1149.views group by viewer_id, view_date having count(distinct article_id) > 1) as a order by viewer_id asc",100,27163,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,
723,1149,101,Medium,"SELECT viewer_id AS id 
FROM schema_1149.views 
GROUP BY viewer_id, view_date 
HAVING COUNT(DISTINCT article_id) > 1 
ORDER BY viewer_id ASC;",27263,"select distinct viewer_id as id from (select viewer_id, view_date, count(distinct article_id) as views from schema_1149.views group by viewer_id, view_date) as t where views > 1 order by viewer_id asc",100,27163,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,
705,1149,7,Medium,"SELECT viewer_id AS id 
FROM schema_1149.views 
GROUP BY viewer_id, view_date 
HAVING COUNT(DISTINCT article_id) > 1 
ORDER BY viewer_id;",27263,"select distinct viewer_id as id from (select viewer_id, view_date from schema_1149.views group by viewer_id, view_date having count(distinct article_id) > 1) as s order by viewer_id",100,27163,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,
722,1149,99,Medium,"SELECT viewer_id AS id 
FROM schema_1149.views 
GROUP BY viewer_id, view_date 
HAVING COUNT(DISTINCT article_id) > 1 
ORDER BY viewer_id;",27263,"select distinct viewer_id as id from (select viewer_id, view_date, count(distinct article_id) as cnt from schema_1149.views group by 1, 2) as tmp where cnt > 1 order by viewer_id",100,27163,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,
726,1149,132,Medium,"SELECT viewer_id AS id
FROM (
    SELECT viewer_id, view_date, COUNT(*) AS view_count, COUNT(DISTINCT article_id) AS article_count
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
) AS grouped_views
WHERE view_count > 1 AND article_count > 1
GROUP BY viewer_id;",100,"select distinct viewer_id as id from schema_1149.views group by viewer_id, view_date having (count(viewer_id) > 1 and count(distinct article_id) > 1)",100,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
717,1149,77,Medium,"SELECT viewer_id AS id
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS article_count
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
    HAVING COUNT(DISTINCT article_id) > 1
) AS a
GROUP BY viewer_id
ORDER BY viewer_id",100,"select distinct a.viewer_id as id from (select viewer_id, view_date, count(distinct article_id) as article_count from schema_1149.views group by viewer_id, view_date) as a where a.article_count > 1 order by a.viewer_id",100,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
704,1149,6,Medium,"SELECT viewer_id AS id
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS article_count
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
) AS grouped_views
WHERE article_count > 1
GROUP BY viewer_id
ORDER BY viewer_id ASC;",100,"select distinct viewer_id as id from schema_1149.views group by view_date, viewer_id having count(distinct article_id) > 1 order by viewer_id asc",100,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
710,1149,24,Medium,"SELECT viewer_id AS id
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS article_count
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
) AS grouped_views
WHERE article_count > 1
GROUP BY viewer_id
ORDER BY viewer_id ASC;",100,"select distinct viewer_id as id from schema_1149.views group by viewer_id, view_date having count(distinct article_id) > 1 order by viewer_id asc",100,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
707,1149,17,Medium,"SELECT viewer_id AS id
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS article_count
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
) AS grouped_views
WHERE article_count > 1
GROUP BY viewer_id
ORDER BY viewer_id;",100,"select distinct viewer_id as id from schema_1149.views group by view_date, viewer_id having count(distinct article_id) > 1 order by viewer_id",100,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
709,1149,23,Medium,"SELECT viewer_id AS id
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS article_count
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
) AS grouped_views
WHERE article_count > 1
GROUP BY viewer_id
ORDER BY viewer_id;",100,"select distinct viewer_id as id from schema_1149.views group by viewer_id, view_date having count(distinct article_id) > 1 order by viewer_id",100,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
702,1149,1,Medium,"SELECT viewer_id AS id
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS article_count
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
) AS subquery
WHERE article_count > 1
GROUP BY viewer_id
ORDER BY viewer_id;",100,"select distinct v.viewer_id as id from schema_1149.views as v group by v.view_date, v.viewer_id having count(distinct v.article_id) > 1 order by v.viewer_id",100,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
727,1149,137,Medium,"SELECT viewer_id AS id
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS article_count
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
) AS subquery
WHERE article_count > 1
GROUP BY viewer_id
ORDER BY viewer_id;",100,"select distinct viewer_id as id from schema_1149.views as v group by view_date, viewer_id having count(distinct article_id) > 1 order by viewer_id",100,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
721,1149,93,Medium,"SELECT viewer_id AS id
FROM (
    SELECT viewer_id, view_date, COUNT(DISTINCT article_id) AS view_cnts_per_day
    FROM schema_1149.views
    GROUP BY viewer_id, view_date
    HAVING COUNT(DISTINCT article_id) > 1
) AS x
GROUP BY viewer_id
ORDER BY viewer_id;",100,"select distinct viewer_id as id from (select distinct viewer_id, view_date, count(distinct article_id) as view_cnts_per_day from schema_1149.views as v2 group by 1, 2) as x where view_cnts_per_day > 1 order by viewer_id",100,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
706,1149,9,Medium,"SELECT viewer_id AS id
FROM schema_1149.views
GROUP BY viewer_id, view_date
HAVING COUNT(DISTINCT article_id) > 1
ORDER BY viewer_id;",27263,"select distinct viewer_id as id from (select viewer_id, view_date, count(distinct article_id) as art_num from schema_1149.views group by viewer_id, view_date) as t1 where art_num > 1 order by viewer_id",100,27163,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,
728,1149,158,Medium,"SELECT viewer_id AS id
FROM schema_1149.views
GROUP BY viewer_id, view_date
HAVING COUNT(DISTINCT article_id) > 1
ORDER BY viewer_id;",27263,"select distinct viewer_id as id from (select viewer_id, view_date from schema_1149.views group by viewer_id, view_date having count(distinct article_id) > 1) as t order by viewer_id",100,27163,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,
730,1149,161,Medium,"SELECT viewer_id AS id
FROM schema_1149.views
GROUP BY viewer_id, view_date
HAVING COUNT(DISTINCT article_id) > 1
ORDER BY viewer_id;",27263,"select distinct viewer_id as id from (select view_date, viewer_id, count(distinct article_id) as articles from schema_1149.views group by view_date, viewer_id) as t where articles > 1 order by viewer_id",100,27163,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,
711,1149,32,Medium,"SELECT viewer_id AS id
FROM schema_1149.views
GROUP BY viewer_id, view_date
HAVING COUNT(DISTINCT article_id) > 1;",27263,"select distinct viewer_id as id from (select viewer_id, view_date, count(distinct article_id) as cnt from schema_1149.views group by 1, 2) as a where cnt > 1",100,27163,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,
713,1149,37,Medium,"SELECT viewer_id AS id
FROM schema_1149.views
GROUP BY viewer_id, view_date
HAVING COUNT(DISTINCT article_id) > 1;",27263,"select distinct viewer_id as id from (select viewer_id, view_date, count(distinct article_id) as cnt from schema_1149.views group by viewer_id, view_date) as temp where cnt > 1",100,27163,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,
712,1149,33,Medium,"SELECT viewer_id AS id
FROM schema_1149.views
GROUP BY viewer_id, view_date
HAVING COUNT(DISTINCT article_id) >= 2",27263,"select distinct viewer_id as id from (select a.viewer_id, a.view_date from schema_1149.views as a group by 1, 2 having count(distinct article_id) >= 2) as tmp",100,27163,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,
732,1158,255,Medium,"SELECT 
    u.user_id AS buyer_id, 
    u.join_date, 
    COUNT(o.order_date) AS orders_in_2019 
FROM 
    schema_1158.users u 
LEFT JOIN (
    SELECT 
        buyer_id, 
        order_date 
    FROM 
        schema_1158.orders 
    WHERE 
        order_date BETWEEN '2019-01-01' AND '2019-12-31'
) o ON u.user_id = o.buyer_id 
GROUP BY 
    u.user_id, 
    u.join_date;",100000,"select user_id as buyer_id, join_date, count(order_date) as orders_in_2019 from schema_1158.users as u left outer join schema_1158.orders as o on (u.user_id = o.buyer_id and o.order_date >= '2019-01-01' and o.order_date <= '2019-12-31') group by 1",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
733,1303,3,Easy,"SELECT a.employee_id, subq.team_size
FROM schema_1303.employee a
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size
    FROM schema_1303.employee
    GROUP BY team_id
) subq ON a.team_id = subq.team_id;",100000,"select a.employee_id, count(b.employee_id) as team_size from schema_1303.employee as a left outer join schema_1303.employee as b on a.team_id = b.team_id group by a.employee_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
734,1303,5,Easy,"SELECT a.employee_id, c.team_size 
FROM schema_1303.employee a 
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) c ON a.team_id = c.team_id",100000,"select a.employee_id, b.team_size from schema_1303.employee as a join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as b on a.team_id = b.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
735,1303,6,Easy,"SELECT a.employee_id, b.team_size 
FROM schema_1303.employee a 
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) b USING (team_id) 
ORDER BY a.employee_id;",100000,"select a.employee_id, team_size from schema_1303.employee as a join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as b on a.team_id = b.team_id order by employee_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
736,1303,8,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id;",100000,"select e.employee_id, emp.team_size from (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as emp join schema_1303.employee as e on e.team_id = emp.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
737,1303,12,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t USING (team_id)",100000,"select e.employee_id, team_size from schema_1303.employee as e join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as t on e.team_id = t.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
738,1303,13,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, team_size from schema_1303.employee as e left outer join (select team_id, count(team_id) as team_size from schema_1303.employee group by 1) as a on e.team_id = a.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
739,1303,14,Easy,"SELECT e1.employee_id, (SELECT COUNT(*) FROM schema_1303.employee e2 WHERE e2.team_id = e1.team_id) AS team_size
FROM schema_1303.employee e1",100000,"select e1.employee_id, count(e2.employee_id) as team_size from schema_1303.employee as e1 left outer join schema_1303.employee as e2 on e1.team_id = e2.team_id group by e1.employee_id, e2.team_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
740,1303,15,Easy,"SELECT e1.employee_id, t.team_size 
FROM schema_1303.employee e1 
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e1.team_id = t.team_id;",100000,"select e1.employee_id, team_size from schema_1303.employee as e1 join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by team_id) as e2 on e1.team_id = e2.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
741,1303,22,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id;",100000,"select employee_id, count(employee_id) over (partition by team_id) as team_size from schema_1303.employee",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
742,1303,23,Easy,"SELECT employee_id, team_count AS team_size 
FROM schema_1303.employee 
JOIN (
    SELECT team_id, COUNT(*) AS team_count 
    FROM schema_1303.employee 
    GROUP BY team_id
) AS team_sizes USING (team_id) 
ORDER BY employee_id;",100000,"select employee_id, count(employee_id) over (partition by team_id) as team_size from schema_1303.employee order by employee_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
743,1303,28,Easy,"SELECT employee_id, team_count AS team_size 
FROM schema_1303.employee 
JOIN (
    SELECT team_id, COUNT(*) AS team_count 
    FROM schema_1303.employee 
    GROUP BY team_id
) AS team_sizes USING (team_id)",100000,"select employee_id, count(team_id) over (partition by team_id) as team_size from schema_1303.employee",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
744,1303,32,Easy,"SELECT employee_id, team_count AS team_size 
FROM schema_1303.employee 
JOIN (
    SELECT team_id, COUNT(*) AS team_count 
    FROM schema_1303.employee 
    GROUP BY team_id
) AS team_sizes 
ON employee.team_id = team_sizes.team_id 
ORDER BY employee_id",100000,"select employee_id, count(team_id) over (partition by team_id) as team_size from schema_1303.employee order by employee_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
745,1303,35,Easy,"SELECT employee_id, team_count.team_size
FROM schema_1303.employee
JOIN (
    SELECT team_id, COUNT(*) AS team_size
    FROM schema_1303.employee
    GROUP BY team_id
) AS team_count ON employee.team_id = team_count.team_id;",100000,"select employee_id, count(team_id) over (partition by team_id) as team_size from schema_1303.employee group by employee_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
746,1303,37,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select employee_id, team_size from schema_1303.employee as e left outer join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by team_id) as teams on e.team_id = teams.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
747,1303,38,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select employee_id, team_size from schema_1303.employee as e left outer join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as teams on e.team_id = teams.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
748,1303,39,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select employee_id, team_size from schema_1303.employee join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as teams on employee.team_id = teams.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
749,1303,41,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select employee_id, team_size from schema_1303.employee left outer join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by team_id) as teams on employee.team_id = teams.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
750,1303,43,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select employee_id, team_size from schema_1303.employee as e left outer join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as t on e.team_id = t.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
751,1303,45,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select employee_id, team_size from schema_1303.employee as e join (select team_id, count(team_id) as team_size from schema_1303.employee group by team_id) as r on r.team_id = e.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
752,1303,49,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select employee.employee_id, t.team_size from schema_1303.employee left outer join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as t on t.team_id = employee.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
753,1303,51,Easy,"SELECT e.employee_id, t.team_size
FROM schema_1303.employee e
JOIN (
    SELECT team_id, COUNT(*) AS team_size
    FROM schema_1303.employee
    GROUP BY team_id
) t ON e.team_id = t.team_id;",100000,"select employee_id, cnt as team_size from schema_1303.employee join (select team_id, count(employee_id) as cnt from schema_1303.employee group by team_id) as tmp on employee.team_id = tmp.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
754,1303,70,Easy,"SELECT e.employee_id, COUNT(*) OVER (PARTITION BY e.team_id) AS team_size 
FROM schema_1303.employee e",100000,"select e.employee_id, t1.team_size from (select e1.team_id, count(e1.employee_id) as team_size from schema_1303.employee as e1 group by e1.team_id) as t1 right outer join schema_1303.employee as e on t1.team_id = e.team_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
755,1303,72,Easy,"SELECT a.employee_id, b.team_size 
FROM schema_1303.employee a 
LEFT JOIN (
    SELECT team_id, COUNT(*) as team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) b ON a.team_id = b.team_id",100000,"select a.employee_id, b.team_size from schema_1303.employee as a left outer join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by 1) as b on a.team_id = b.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
756,1303,73,Easy,"SELECT a.employee_id, b.team_size 
FROM schema_1303.employee a 
JOIN (
    SELECT team_id, COUNT(*) as team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) b USING (team_id)",100000,"select a.employee_id, b.team_size from schema_1303.employee as a join (select team_id, count(team_id) as team_size from schema_1303.employee group by team_id) as b on a.team_id = b.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
757,1303,74,Easy,"SELECT a.employee_id, t.team_size 
FROM schema_1303.employee a
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON a.team_id = t.team_id;",100000,"select a.employee_id, b.team_size from schema_1303.employee as a join (select team_id, count(team_id) as team_size from schema_1303.employee group by team_id) as b on b.team_id = a.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
758,1303,75,Easy,"SELECT a.employee_id, c.team_size 
FROM schema_1303.employee AS a 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) AS c ON a.team_id = c.team_id",100000,"select a.employee_id, b.team_size from schema_1303.employee as a left outer join (select team_id, count(team_id) as team_size from schema_1303.employee group by team_id) as b on a.team_id = b.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
759,1303,81,Easy,"SELECT a.employee_id, b.team_size 
FROM schema_1303.employee a 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) b ON a.team_id = b.team_id",100000,"select a.employee_id, team_size from schema_1303.employee as a left outer join (select team_id, count(team_id) as team_size from schema_1303.employee group by team_id) as b on a.team_id = b.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
760,1303,82,Easy,"SELECT a.employee_id, t.cnt AS team_size 
FROM schema_1303.employee AS a 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS cnt 
    FROM schema_1303.employee 
    GROUP BY team_id
) AS t ON a.team_id = t.team_id",100000,"select a.employee_id, x.cnt as team_size from schema_1303.employee as a left outer join (select team_id, count(distinct employee_id) as cnt from schema_1303.employee group by 1) as x on a.team_id = x.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
761,1303,86,Easy,"SELECT a.employee_id, b.team_size 
FROM schema_1303.employee AS a 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) AS b ON a.team_id = b.team_id;",100000,"select distinct a.employee_id, b.team_size from schema_1303.employee as a left outer join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by team_id) as b on a.team_id = b.team_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
762,1303,88,Easy,"SELECT employee_id, team_count AS team_size 
FROM schema_1303.employee 
JOIN (
    SELECT team_id, COUNT(*) AS team_count 
    FROM schema_1303.employee 
    GROUP BY team_id
) team_sizes ON employee.team_id = team_sizes.team_id;",100000,"select distinct employee_id, count(employee_id) over (partition by team_id) as team_size from schema_1303.employee",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
763,1303,89,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id;",100000,"select e.employee_id, count(employee_id) over (partition by team_id) as team_size from schema_1303.employee as e",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
764,1303,90,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
JOIN (
    SELECT team_id, COUNT(*) as team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, t.team_size from schema_1303.employee as e join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by team_id) as t on e.team_id = t.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
765,1303,91,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
JOIN (
    SELECT team_id, COUNT(*) as team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, tmp.team_size from schema_1303.employee as e join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by team_id) as tmp on e.team_id = tmp.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
766,1303,95,Easy,"SELECT e.employee_id, t.count as team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) as count 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, c.count as team_size from schema_1303.employee as e left outer join (select team_id, count(distinct employee_id) as count from schema_1303.employee group by team_id) as c on e.team_id = c.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
767,1303,96,Easy,"SELECT e.employee_id, t.team_size
FROM schema_1303.employee e
JOIN (
    SELECT team_id, COUNT(*) AS team_size
    FROM schema_1303.employee
    GROUP BY team_id
) t ON e.team_id = t.team_id;",100000,"select e.employee_id, count(d.employee_id) as team_size from schema_1303.employee as e join schema_1303.employee as d on e.team_id = d.team_id group by e.employee_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
768,1303,97,Easy,"WITH team_counts AS (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
)
SELECT e.employee_id, tc.team_size 
FROM schema_1303.employee e 
JOIN team_counts tc ON e.team_id = tc.team_id;",100000,"select e.employee_id, count(e1.team_id) as team_size from schema_1303.employee as e join schema_1303.employee as e1 on e.team_id = e1.team_id group by e.employee_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
769,1303,99,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, s.team_size from schema_1303.employee as e join (select team_id, count(team_id) as team_size from schema_1303.employee group by team_id) as s on e.team_id = s.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
770,1303,101,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t USING (team_id)",100000,"select e.employee_id, t.size as team_size from schema_1303.employee as e join (select team_id, count(employee_id) as size from schema_1303.employee group by team_id) as t on e.team_id = t.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
771,1303,102,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, t.team_size from schema_1303.employee as e left outer join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as t on e.team_id = t.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
772,1303,105,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, t.team_size from schema_1303.employee as e join (select team_id as team_number, count(team_id) as team_size from schema_1303.employee group by team_id) as t on e.team_id = t.team_number",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
773,1303,106,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) as team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, t.team_size from schema_1303.employee as e left outer join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by team_id) as t on e.team_id = t.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
774,1303,107,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
JOIN (
    SELECT team_id, COUNT(*) as team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, team.team_size from schema_1303.employee as e join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by 1) as team on e.team_id = team.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
775,1303,108,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id;",100000,"select e.employee_id, team_size from schema_1303.employee as e join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as base on e.team_id = base.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
776,1303,109,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, temp.team_size from schema_1303.employee as e left outer join (select team_id, count(team_id) as team_size from schema_1303.employee group by team_id) as temp on e.team_id = temp.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
777,1303,112,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select e.employee_id, c.team_size from schema_1303.employee as e join (select team_id, count(team_id) as team_size from schema_1303.employee group by team_id) as c on e.team_id = c.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
778,1303,115,Easy,"SELECT e1.employee_id, team_counts.count AS team_size
FROM schema_1303.employee e1
JOIN (
    SELECT team_id, COUNT(*) AS count
    FROM schema_1303.employee
    GROUP BY team_id
) team_counts ON e1.team_id = team_counts.team_id;",100000,"select e1.employee_id, count(e2.employee_id) as team_size from schema_1303.employee as e1 join schema_1303.employee as e2 on e1.team_id = e2.team_id group by e1.employee_id, e2.team_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
779,1303,116,Easy,"SELECT e1.employee_id, team_counts.count AS team_size
FROM schema_1303.employee e1
JOIN (
    SELECT team_id, COUNT(*) AS count
    FROM schema_1303.employee
    GROUP BY team_id
) team_counts ON e1.team_id = team_counts.team_id
ORDER BY e1.employee_id;",100000,"select e1.employee_id, count(e2.employee_id) as team_size from schema_1303.employee as e1 join schema_1303.employee as e2 on e1.team_id = e2.team_id group by e1.employee_id, e2.team_id order by e1.employee_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
780,1303,117,Easy,"SELECT e1.employee_id, t.team_size 
FROM schema_1303.employee e1 
JOIN (
    SELECT team_id, COUNT(*) as team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t USING (team_id)",100000,"select e1.employee_id, t.team_size from schema_1303.employee as e1 join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as t on t.team_id = e1.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
781,1303,123,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id;",100000,"select employee_id, a.ecnt as team_size from schema_1303.employee as e join (select team_id, count(employee_id) as ecnt from schema_1303.employee group by team_id) as a on e.team_id = a.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
782,1303,147,Easy,"SELECT employee_id, team_count AS team_size 
FROM schema_1303.employee 
JOIN (
    SELECT team_id, COUNT(*) AS team_count 
    FROM schema_1303.employee 
    GROUP BY team_id
) AS team_sizes USING (team_id);",100000,"select employee_id, count(team_id) over (partition by team_id) as team_size from schema_1303.employee as e",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
783,1303,149,Easy,"SELECT employee_id, team_count AS team_size
FROM schema_1303.employee
JOIN (
    SELECT team_id, COUNT(*) AS team_count
    FROM schema_1303.employee
    GROUP BY team_id
) AS team_sizes ON employee.team_id = team_sizes.team_id;",100000,"select employee_id, count(team_id) over (partition by team_id rows between unbounded preceding and unbounded following) as team_size from schema_1303.employee",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
784,1303,156,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select employee_id, team_size from schema_1303.employee as e left outer join (select team_id, count(team_id) as team_size from schema_1303.employee group by team_id) as t on e.team_id = t.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
785,1303,157,Easy,"SELECT e.employee_id, t.team_size
FROM schema_1303.employee e
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size
    FROM schema_1303.employee
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select employee_id, team_size from schema_1303.employee as e left outer join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by team_id) as team on e.team_id = team.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
786,1303,159,Easy,"SELECT employee_id, COUNT(*) OVER (PARTITION BY team_id) AS team_size FROM schema_1303.employee",100000,"select employee_id, team_size from schema_1303.employee left outer join (select team_id, count(distinct employee_id) as team_size from schema_1303.employee group by team_id) as t on employee.team_id = t.team_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
787,1303,160,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
JOIN (
    SELECT team_id, COUNT(*) as team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t USING (team_id)",100000,"select employee_id, team_size from schema_1303.employee as e join (select team_id, count(employee_id) as team_size from schema_1303.employee group by team_id) as t on e.team_id = t.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
788,1303,162,Easy,"SELECT e.employee_id, t.team_size 
FROM schema_1303.employee e 
LEFT JOIN (
    SELECT team_id, COUNT(*) AS team_size 
    FROM schema_1303.employee 
    GROUP BY team_id
) t ON e.team_id = t.team_id",100000,"select employee_id, team_size from schema_1303.employee as e left outer join (select team_id, count(team_id) as team_size from schema_1303.employee group by 1) as b on e.team_id = b.team_id",100000,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
789,1303,173,Easy,"SELECT COUNT(*) OVER (PARTITION BY e.team_id) AS team_size, e.employee_id 
FROM schema_1303.employee AS e",100000,"select temp.team_size, e.employee_id from schema_1303.employee as e join (select count(employee_id) as team_size, team_id from schema_1303.employee group by team_id) as temp on e.team_id = temp.team_id",100000,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
790,1308,2,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day) AS grouped_scores 
ORDER BY gender, day",100000,"select distinct gender, day, sum(score_points) over (partition by gender order by day) as total from schema_1308.scores order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
791,1308,3,Medium,"SELECT 
    s1.gender, 
    s1.day, 
    SUM(s2.score_points) OVER (PARTITION BY s1.gender ORDER BY s1.day) AS total
FROM 
    schema_1308.scores s1
JOIN 
    schema_1308.scores s2 ON s1.gender = s2.gender AND s2.day <= s1.day
GROUP BY 
    s1.gender, 
    s1.day, 
    s2.score_points
ORDER BY 
    s1.gender, 
    s1.day;",1499567,"select distinct s1.gender, s1.day, sum(s2.score_points) as total from schema_1308.scores as s1 join schema_1308.scores as s2 on s1.gender = s2.gender where s2.day <= s1.day group by s1.gender, s1.day order by s1.gender, s1.day",100000,1399567,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,Non-equivalent queries,
792,1308,4,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day) AS grouped_scores 
ORDER BY gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day) as total from schema_1308.scores group by gender, day order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
793,1308,5,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day ROWS UNBOUNDED PRECEDING) AS total 
FROM schema_1308.scores 
ORDER BY gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day) as total from schema_1308.scores order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
794,1308,6,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total FROM schema_1308.scores",100000,"select gender, day, sum(score_points) over (partition by gender order by gender, day) as total from schema_1308.scores",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
795,1308,7,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores 
ORDER BY gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by gender, day) as total from schema_1308.scores order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
796,1308,8,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day ROWS UNBOUNDED PRECEDING) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day) as total from schema_1308.scores",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
798,1308,13,Medium,"SELECT 
    a.gender, 
    a.day, 
    (SELECT SUM(b.score_points) 
     FROM schema_1308.scores b 
     WHERE b.gender = a.gender AND b.day <= a.day) AS total 
FROM schema_1308.scores a 
ORDER BY a.gender, a.day",100000,"select a.gender, a.day, sum(b.score_points) as total from schema_1308.scores as a left outer join schema_1308.scores as b on (a.day >= b.day and a.gender = b.gender) group by a.gender, a.day order by a.gender, a.day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
799,1308,14,Medium,"WITH daily_totals AS (
    SELECT 
        gender, 
        day, 
        SUM(score_points) AS daily_score
    FROM 
        schema_1308.scores
    GROUP BY 
        gender, day
)
SELECT 
    a.gender, 
    a.day, 
    SUM(b.daily_score) AS total
FROM 
    daily_totals a
JOIN 
    daily_totals b ON a.gender = b.gender AND a.day >= b.day
GROUP BY 
    a.gender, a.day
ORDER BY 
    a.gender, a.day;",100000,"select c.gender, c.day, sum(p.score_points) as total from schema_1308.scores as c left outer join schema_1308.scores as p on (c.gender = p.gender and c.day >= p.day) group by c.gender, c.day order by c.gender, c.day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
800,1308,22,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day ASC ROWS UNBOUNDED PRECEDING) AS total 
FROM schema_1308.scores 
ORDER BY gender, day",100000,"select gender, day, sum(dtotal) over (partition by gender order by day asc rows between unbounded preceding and current row) as total from (select gender, day, sum(score_points) as dtotal from schema_1308.scores group by gender, day) as a order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
801,1308,23,Medium,"SELECT 
    gender, 
    day, 
    SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM 
    schema_1308.scores 
ORDER BY 
    gender, 
    day",100000,"select gender, day, sum(score) over (partition by gender order by day) as total from (select gender, day, sum(score_points) as score from schema_1308.scores group by gender, day) as t order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
802,1308,24,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores
ORDER BY gender, day;",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc) as total from schema_1308.scores",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
803,1308,25,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores 
GROUP BY gender, day, score_points",100000,"select gender, day, sum(score_points) over (partition by gender order by gender, day rows between unbounded preceding and current row) as total from schema_1308.scores group by 1, 2",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
804,1308,27,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc) as total from schema_1308.scores as s",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
805,1308,30,Medium,"WITH daily_scores AS (
    SELECT day, gender, SUM(score_points) AS score_points 
    FROM schema_1308.scores 
    GROUP BY day, gender
)
SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM daily_scores 
ORDER BY gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc rows between unbounded preceding and current row) as total from (select day, gender, sum(score_points) as score_points from schema_1308.scores group by day, gender) as sub order by gender, day asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
806,1308,32,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores 
ORDER BY gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc) as total from schema_1308.scores order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
807,1308,33,Medium,"SELECT gender, day, sum(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, sum(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day) AS grouped_scores 
ORDER BY gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc) as total from schema_1308.scores group by gender, day order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
808,1308,35,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points FROM schema_1308.scores GROUP BY gender, day) AS grouped_scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day) as total from schema_1308.scores group by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
809,1308,44,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day, gender asc) as total from schema_1308.scores",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
810,1308,47,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points FROM schema_1308.scores GROUP BY gender, day) AS grouped_scores 
ORDER BY gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day rows between unbounded preceding and current row) as total from schema_1308.scores group by gender, day order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
811,1308,52,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day ASC) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day) AS grouped_scores 
ORDER BY gender, day ASC",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc) as total from schema_1308.scores group by day, gender order by gender, day asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
812,1308,53,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day rows unbounded preceding) as total from schema_1308.scores",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
813,1308,54,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day) AS grouped_scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day) as total from schema_1308.scores group by 1, 2",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
814,1308,55,Medium,"SELECT 
    gender, 
    day, 
    SUM(SUM(score_points)) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM 
    schema_1308.scores 
GROUP BY 
    gender, day 
ORDER BY 
    gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day) as total from (select gender, day, sum(score_points) as score_points from schema_1308.scores group by gender, day) as x order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
815,1308,71,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(total) over (partition by gender order by day) as total from (select gender, day, sum(score_points) as total from schema_1308.scores group by gender, day order by gender, day) as z",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
816,1308,77,Medium,"SELECT 
    gender, 
    day, 
    SUM(SUM(score_points)) OVER (PARTITION BY gender ORDER BY day ASC ROWS UNBOUNDED PRECEDING) AS total 
FROM 
    schema_1308.scores 
GROUP BY 
    gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc rows between unbounded preceding and current row) as total from (select gender, day, sum(score_points) as score_points from schema_1308.scores as s group by 1, 2) as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
817,1308,85,Medium,"SELECT 
    s1.gender,
    s1.day,
    (SELECT SUM(s2.score_points) 
     FROM schema_1308.scores s2 
     WHERE s2.gender = s1.gender AND s2.day <= s1.day) AS total
FROM schema_1308.scores s1
GROUP BY s1.gender, s1.day
ORDER BY s1.gender, s1.day",100000,"select s1.gender as gender, s1.day as day, sum(s2.score_points) as total from schema_1308.scores as s1 join schema_1308.scores as s2 on (s1.gender = s2.gender and s1.day >= s2.day) group by s1.gender, s1.day order by s1.gender, s1.day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
818,1308,88,Medium,"SELECT 
    gender, 
    day, 
    SUM(score_points) OVER (PARTITION BY gender ORDER BY day ROWS UNBOUNDED PRECEDING) AS total
FROM 
    schema_1308.scores
ORDER BY 
    gender, day;",100000,"select s1.gender, s1.day, sum(s2.score_points) as total from schema_1308.scores as s1 join schema_1308.scores as s2 on (s1.gender = s2.gender and s1.day >= s2.day) group by s1.gender, s1.day order by s1.gender, s1.day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
819,1308,99,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day) AS aggregated_scores 
ORDER BY gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day) as total from schema_1308.scores group by day, gender order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
820,1308,103,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(total_day) over (partition by gender order by day) as total from (select gender, day, sum(score_points) as total_day from schema_1308.scores group by gender, day order by gender, day) as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
821,1308,120,Medium,"SELECT 
    gender, 
    day, 
    SUM(SUM(score_points)) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM 
    schema_1308.scores 
GROUP BY 
    gender, 
    day",100000,"select a.gender, a.day, sum(a.daily_total) over (partition by a.gender order by a.day) as total from (select gender, day, sum(score_points) as daily_total from schema_1308.scores group by gender, day) as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
825,1308,153,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores 
ORDER BY gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc) as total from schema_1308.scores as s1 order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
826,1308,154,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores 
ORDER BY gender, day",100000,"select gender, day, sum(score_points) over (partition by gender order by day rows between unbounded preceding and current row) as total from schema_1308.scores order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
827,1308,159,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(score) over (partition by gender order by day) as total from (select gender, day, sum(score_points) as score from schema_1308.scores group by gender, day) as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
828,1308,165,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day ASC) AS total 
FROM schema_1308.scores 
ORDER BY gender ASC, day ASC",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc) as total from schema_1308.scores order by gender asc, day asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
829,1308,166,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc range between unbounded preceding and current row) as total from schema_1308.scores",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
830,1308,170,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day ASC) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day) AS grouped_scores 
ORDER BY gender ASC, day ASC",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc) as total from schema_1308.scores group by gender, day order by gender asc, day asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
831,1308,189,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total FROM schema_1308.scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day, gender) as total from schema_1308.scores",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
832,1308,190,Medium,"SELECT gender, day, sum(score_points) OVER (PARTITION BY gender ORDER BY day ASC) AS total 
FROM schema_1308.scores 
ORDER BY gender ASC, day ASC",100000,"select gender, day, sum(score_points) over (partition by gender order by gender asc, day asc) as total from schema_1308.scores order by gender asc, day asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
833,1308,191,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day) AS grouped_scores 
ORDER BY gender, day;",100000,"select gender, day, sum(score_points) over (partition by gender order by gender, day) as total from schema_1308.scores group by gender, day order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
834,1308,202,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day
     ) AS grouped_scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc) as total from schema_1308.scores group by 1, 2",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
835,1308,205,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day ASC) AS total 
FROM schema_1308.scores 
ORDER BY gender, day ASC",100000,"select gender, day, sum(score_points) over (partition by gender order by day asc) as total from schema_1308.scores order by gender, day asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
836,1308,213,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day rows between unbounded preceding and current row) as total from schema_1308.scores",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
837,1308,214,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day) AS grouped_scores",100000,"select gender, day, sum(score_points) over (partition by gender order by day rows between unbounded preceding and current row) as total from schema_1308.scores group by 1, 2",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
838,1308,219,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day
      ORDER BY gender, day) AS t;",100000,"select gender, day, sum(score_points) over (partition by gender order by day) as total from (select gender, day, sum(score_points) as score_points from schema_1308.scores group by gender, day) as t order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
839,1308,235,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day ROWS UNBOUNDED PRECEDING) AS total 
FROM schema_1308.scores 
ORDER BY gender, day;",100000,"select gender, day, sum(score_points) over (partition by gender order by day) as total from schema_1308.scores order by gender, day asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
840,1308,249,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM (SELECT gender, day, SUM(score_points) AS score_points 
      FROM schema_1308.scores 
      GROUP BY gender, day) AS grouped_scores 
ORDER BY gender ASC, day ASC",100000,"select gender, day, sum(score_points) over (partition by gender order by day) as total from schema_1308.scores group by 1, 2 order by gender asc, day asc",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
841,1308,253,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(tot) over (partition by gender order by day) as total from (select gender, day, sum(score_points) as tot from schema_1308.scores group by gender, day order by gender, day) as a",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
842,1308,254,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores 
ORDER BY gender, day;",100000,"select gender, day, sum(total) over (partition by gender order by day) as total from (select gender, day, sum(score_points) as total from schema_1308.scores group by gender, day) as a order by gender, day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
843,1308,255,Medium,"SELECT 
    gender, 
    day, 
    SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM 
    schema_1308.scores
ORDER BY 
    gender, day;",100000,"select gender, day, sum(total) over (partition by gender order by day) as total from (select gender, day, sum(score_points) as total from schema_1308.scores group by gender, day order by gender, day) as temp",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
844,1308,257,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select gender, day, sum(total) over (partition by gender order by day) as total from (select gender, day, sum(score_points) as total from schema_1308.scores group by 1, 2) as cte",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
845,1308,258,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total FROM schema_1308.scores",100000,"select gender, day, total from (select gender, day, score_points, sum(score_points) over (partition by gender order by day) as total from schema_1308.scores) as aggregate",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
847,1308,284,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores 
ORDER BY gender, day",100000,"select s.gender, s.day, sum(s.score_points) over (partition by s.gender order by day) as total from schema_1308.scores as s order by s.gender, s.day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
848,1308,285,Medium,"SELECT gender, day, SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total 
FROM schema_1308.scores",100000,"select s.gender, s.day, sum(s.score_points) over (partition by s.gender order by day) as total from schema_1308.scores as s",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
849,1308,294,Medium,"SELECT 
    gender, 
    day, 
    SUM(score_points) OVER (PARTITION BY gender ORDER BY day) AS total
FROM 
    schema_1308.scores
ORDER BY 
    gender, 
    day",100000,"select s1.gender, s1.day, sum(s2.score_points) as total from schema_1308.scores as s1 join schema_1308.scores as s2 on (s1.gender = s2.gender and s2.day <= s1.day) group by s1.gender, s1.day order by s1.gender, s1.day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
850,1308,307,Medium,"SELECT 
    s1.gender, 
    s1.day, 
    SUM(s2.score_points) AS total 
FROM 
    schema_1308.scores s1 
JOIN 
    schema_1308.scores s2 
    ON s1.gender = s2.gender AND s2.day <= s1.day 
GROUP BY 
    s1.gender, s1.day 
ORDER BY 
    s1.gender, s1.day",100000,"select s1.gender, s1.day, sum(s2.score_points) as total from schema_1308.scores as s1 left outer join schema_1308.scores as s2 on (s1.day >= s2.day and s1.gender = s2.gender) group by s1.gender, s1.day order by s1.gender, s1.day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
851,1308,309,Medium,"SELECT 
    s1.gender, 
    s1.day, 
    SUM(s2.score_points) AS total 
FROM 
    schema_1308.scores s1 
JOIN LATERAL (
    SELECT 
        SUM(score_points) AS score_points 
    FROM 
        schema_1308.scores s2 
    WHERE 
        s2.day <= s1.day 
        AND s2.gender = s1.gender
) s2 ON true
GROUP BY 
    s1.gender, 
    s1.day 
ORDER BY 
    s1.gender, 
    s1.day;",100000,"select s1.gender, s1.day, sum(s2.score_points) as total from schema_1308.scores as s1 join schema_1308.scores as s2 on (s1.day >= s2.day and s1.gender = s2.gender) group by s1.gender, s1.day order by s1.gender, s1.day",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
854,1327,149,Easy,"SELECT p.product_name, o.sum_unit AS unit
FROM schema_1327.products p
JOIN (
    SELECT product_id, SUM(unit) AS sum_unit
    FROM schema_1327.orders
    WHERE order_date BETWEEN '2020-02-01' AND '2020-02-29'
    GROUP BY product_id
    HAVING SUM(unit) >= 100
) o ON p.product_id = o.product_id",2709,"select p.product_name as product_name, o.sum_unit as unit from schema_1327.products as p join (select product_id, sum(unit) as sum_unit from schema_1327.orders where (order_date >= '2020-02-01' and order_date < '2020-03-01') group by product_id) as o on p.product_id = o.product_id where o.sum_unit >= 100",2709,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
855,1327,312,Easy,"SELECT x.product_name, y.s AS unit 
FROM schema_1327.products x 
JOIN (
    SELECT product_id, SUM(unit) AS s 
    FROM schema_1327.orders 
    WHERE order_date BETWEEN '2020-02-01' AND '2020-02-29' 
    GROUP BY product_id 
    HAVING SUM(unit) >= 100
) y ON x.product_id = y.product_id",2709,"select x.product_name, y.s as unit from schema_1327.products as x join (select product_id, sum(unit) as s from schema_1327.orders where (order_date >= '2020-02-01' and order_date < '2020-03-01') group by product_id) as y on x.product_id = y.product_id where y.s >= 100",2709,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
856,1364,10,Medium,"SELECT 
    a.invoice_id, 
    b.customer_name, 
    a.price, 
    COALESCE(cnt.contacts_cnt, 0) AS contacts_cnt, 
    COALESCE(tcnt.trusted_contacts_cnt, 0) AS trusted_contacts_cnt 
FROM 
    schema_1364.invoices a 
LEFT JOIN 
    schema_1364.customers b ON a.user_id = b.customer_id 
LEFT JOIN 
    (SELECT user_id, COUNT(*) AS contacts_cnt FROM schema_1364.contacts GROUP BY user_id) cnt ON b.customer_id = cnt.user_id 
LEFT JOIN 
    (SELECT c.user_id, COUNT(d.customer_name) AS trusted_contacts_cnt 
     FROM schema_1364.contacts c 
     LEFT JOIN schema_1364.customers d ON d.customer_name = c.contact_name 
     GROUP BY c.user_id) tcnt ON b.customer_id = tcnt.user_id 
ORDER BY 
    a.invoice_id",100000,"select a.invoice_id, b.customer_name, a.price, count(c.user_id) as contacts_cnt, count(d.customer_name) as trusted_contacts_cnt from schema_1364.invoices as a left outer join schema_1364.customers as b on a.user_id = b.customer_id left outer join schema_1364.contacts as c on b.customer_id = c.user_id left outer join schema_1364.customers as d on d.customer_name = c.contact_name group by a.invoice_id, b.customer_name, a.price order by a.invoice_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
857,1364,15,Medium,"SELECT 
    i.invoice_id, 
    c1.customer_name, 
    i.price, 
    COALESCE(m.contacts_cnt, 0) AS contacts_cnt, 
    COALESCE(t.trusted_contacts_cnt, 0) AS trusted_contacts_cnt 
FROM 
    schema_1364.invoices i 
LEFT JOIN 
    schema_1364.customers c1 ON i.user_id = c1.customer_id 
LEFT JOIN (
    SELECT 
        user_id, 
        COUNT(contact_email) AS contacts_cnt 
    FROM 
        schema_1364.contacts 
    GROUP BY 
        user_id
) m ON c1.customer_id = m.user_id 
LEFT JOIN (
    SELECT 
        m.user_id, 
        COUNT(c2.email) AS trusted_contacts_cnt 
    FROM 
        schema_1364.contacts m 
    LEFT JOIN 
        schema_1364.customers c2 ON m.contact_name = c2.customer_name AND m.contact_email = c2.email 
    GROUP BY 
        m.user_id
) t ON c1.customer_id = t.user_id 
ORDER BY 
    i.invoice_id",100000,"select i.invoice_id, c1.customer_name, i.price, count(m.contact_email) as contacts_cnt, count(c2.email) as trusted_contacts_cnt from schema_1364.invoices as i left outer join schema_1364.customers as c1 on i.user_id = c1.customer_id left outer join schema_1364.contacts as m on c1.customer_id = m.user_id left outer join schema_1364.customers as c2 on (m.contact_name = c2.customer_name and m.contact_email = c2.email) group by i.invoice_id, c1.customer_name, i.price order by i.invoice_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
858,1364,43,Medium,"SELECT 
    i.invoice_id, 
    us.customer_name, 
    i.price, 
    COUNT(co.contact_name) AS contacts_cnt, 
    COUNT(CASE WHEN cu.customer_name IS NOT NULL THEN cu.customer_name END) AS trusted_contacts_cnt 
FROM 
    schema_1364.invoices AS i 
LEFT JOIN 
    schema_1364.customers AS us ON us.customer_id = i.user_id 
LEFT JOIN 
    schema_1364.contacts AS co ON i.user_id = co.user_id 
LEFT JOIN 
    schema_1364.customers AS cu ON co.contact_name = cu.customer_name 
GROUP BY 
    i.invoice_id, us.customer_name, i.price 
ORDER BY 
    i.invoice_id",100000,"select i.invoice_id, us.customer_name, i.price, count(co.contact_name) as contacts_cnt, count(cu.customer_name) as trusted_contacts_cnt from schema_1364.invoices as i left outer join schema_1364.contacts as co on i.user_id = co.user_id left outer join schema_1364.customers as cu on co.contact_name = cu.customer_name left outer join schema_1364.customers as us on us.customer_id = i.user_id group by 1, 2, 3 order by i.invoice_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
859,1364,135,Medium,"SELECT 
    c.invoice_id, 
    a.customer_name, 
    c.price, 
    COALESCE(contact_counts.contacts_cnt, 0) AS contacts_cnt, 
    COALESCE(trusted_counts.trusted_contacts_cnt, 0) AS trusted_contacts_cnt 
FROM 
    schema_1364.invoices c 
LEFT JOIN 
    schema_1364.customers a ON a.customer_id = c.user_id 
LEFT JOIN 
    (
        SELECT 
            user_id, 
            COUNT(contact_name) AS contacts_cnt 
        FROM 
            schema_1364.contacts 
        GROUP BY 
            user_id
    ) contact_counts ON a.customer_id = contact_counts.user_id 
LEFT JOIN 
    (
        SELECT 
            b.user_id, 
            COUNT(DISTINCT d.customer_name) AS trusted_contacts_cnt 
        FROM 
            schema_1364.contacts b 
        JOIN 
            schema_1364.customers d ON b.contact_name = d.customer_name 
        GROUP BY 
            b.user_id
    ) trusted_counts ON a.customer_id = trusted_counts.user_id",100000,"select c.invoice_id, a.customer_name, c.price, count(b.contact_name) as contacts_cnt, count(distinct d.customer_name) as trusted_contacts_cnt from schema_1364.invoices as c left outer join schema_1364.customers as a on a.customer_id = c.user_id left outer join schema_1364.contacts as b on a.customer_id = b.user_id left outer join schema_1364.customers as d on b.contact_name = d.customer_name group by 1, 2, 3",100000,0,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,"Equivalent query (Order mismatch, no ORDER BY in initial query)",Sorting problem
860,1364,188,Medium,"SELECT 
    i.invoice_id, 
    cu.customer_name, 
    i.price, 
    COALESCE(contact_counts.contacts_cnt, 0) AS contacts_cnt, 
    COALESCE(trusted_counts.trusted_contacts_cnt, 0) AS trusted_contacts_cnt 
FROM 
    schema_1364.invoices i 
LEFT JOIN 
    schema_1364.customers cu ON i.user_id = cu.customer_id 
LEFT JOIN (
    SELECT 
        user_id, 
        COUNT(contact_name) AS contacts_cnt 
    FROM 
        schema_1364.contacts 
    GROUP BY 
        user_id
) contact_counts ON i.user_id = contact_counts.user_id 
LEFT JOIN (
    SELECT 
        c.user_id, 
        COUNT(cu2.email) AS trusted_contacts_cnt 
    FROM 
        schema_1364.contacts c 
    JOIN 
        schema_1364.customers cu2 ON c.contact_name = cu2.customer_name 
    GROUP BY 
        c.user_id
) trusted_counts ON i.user_id = trusted_counts.user_id 
ORDER BY 
    i.invoice_id;",100000,"select i.invoice_id, min(cu.customer_name) as customer_name, min(i.price) as price, count(c.contact_name) as contacts_cnt, count(cu2.email) as trusted_contacts_cnt from schema_1364.invoices as i left outer join schema_1364.customers as cu on i.user_id = cu.customer_id left outer join schema_1364.contacts as c on i.user_id = c.user_id left outer join schema_1364.customers as cu2 on c.contact_name = cu2.customer_name group by i.invoice_id order by i.invoice_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
861,1364,204,Medium,"SELECT 
    i.invoice_id, 
    c.customer_name, 
    i.price, 
    COALESCE(o.contacts_cnt, 0) AS contacts_cnt, 
    COALESCE(a.trusted_contacts_cnt, 0) AS trusted_contacts_cnt 
FROM 
    schema_1364.invoices AS i 
LEFT JOIN 
    schema_1364.customers AS c ON i.user_id = c.customer_id 
LEFT JOIN 
    (SELECT 
        user_id, 
        COUNT(contact_name) AS contacts_cnt 
     FROM 
        schema_1364.contacts 
     GROUP BY 
        user_id
    ) AS o ON c.customer_id = o.user_id 
LEFT JOIN 
    (SELECT 
        o.user_id, 
        COUNT(a.email) AS trusted_contacts_cnt 
     FROM 
        schema_1364.contacts AS o 
     LEFT JOIN 
        schema_1364.customers AS a ON o.contact_email = a.email 
     GROUP BY 
        o.user_id
    ) AS a ON c.customer_id = a.user_id 
ORDER BY 
    i.invoice_id",100000,"select invoice_id, c.customer_name, price, count(o.contact_name) as contacts_cnt, count(a.email) as trusted_contacts_cnt from schema_1364.invoices as i left outer join schema_1364.customers as c on i.user_id = c.customer_id left outer join schema_1364.contacts as o on c.customer_id = o.user_id left outer join schema_1364.customers as a on a.email = o.contact_email group by i.invoice_id, c.customer_name, i.price order by i.invoice_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
862,1364,228,Medium,"SELECT 
    t1.invoice_id, 
    t2.customer_name, 
    t1.price, 
    COALESCE(t3.contacts_cnt, 0) AS contacts_cnt, 
    COALESCE(t4.trusted_contacts_cnt, 0) AS trusted_contacts_cnt 
FROM 
    schema_1364.invoices t1 
LEFT JOIN 
    schema_1364.customers t2 ON t1.user_id = t2.customer_id 
LEFT JOIN (
    SELECT 
        user_id, 
        COUNT(DISTINCT contact_name) AS contacts_cnt 
    FROM 
        schema_1364.contacts 
    GROUP BY 
        user_id
) t3 ON t1.user_id = t3.user_id 
LEFT JOIN (
    SELECT 
        t3.user_id, 
        COUNT(DISTINCT t4.customer_name) AS trusted_contacts_cnt 
    FROM 
        schema_1364.contacts t3 
    JOIN 
        schema_1364.customers t4 ON t3.contact_name = t4.customer_name 
    GROUP BY 
        t3.user_id
) t4 ON t1.user_id = t4.user_id",100000,"select invoice_id, t2.customer_name, price, count(distinct t3.contact_name) as contacts_cnt, count(distinct t4.customer_name) as trusted_contacts_cnt from schema_1364.invoices as t1 left outer join schema_1364.customers as t2 on t1.user_id = t2.customer_id left outer join schema_1364.contacts as t3 on t1.user_id = t3.user_id left outer join schema_1364.customers as t4 on t3.contact_name = t4.customer_name group by 1, 2, 3",100000,0,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,"Equivalent query (Order mismatch, no ORDER BY in initial query)",Sorting problem
863,1364,233,Medium,"SELECT 
    i.invoice_id, 
    c.customer_name, 
    i.price, 
    COALESCE(cnt.contacts_cnt, 0) AS contacts_cnt, 
    COALESCE(cnt.trusted_contacts_cnt, 0) AS trusted_contacts_cnt 
FROM 
    schema_1364.invoices i 
LEFT JOIN 
    schema_1364.customers c ON i.user_id = c.customer_id 
LEFT JOIN (
    SELECT 
        user_id, 
        COUNT(contact_name) AS contacts_cnt, 
        COUNT(e.email) AS trusted_contacts_cnt 
    FROM 
        schema_1364.contacts ct 
    LEFT JOIN 
        schema_1364.customers e ON ct.contact_email = e.email 
    GROUP BY 
        user_id
) cnt ON i.user_id = cnt.user_id 
ORDER BY 
    i.invoice_id",100000,"select invoices.invoice_id, customers.customer_name, invoices.price, count(contact_name) as contacts_cnt, count(emails.email) as trusted_contacts_cnt from schema_1364.invoices as invoices left outer join schema_1364.customers as customers on invoices.user_id = customers.customer_id left outer join schema_1364.contacts as contacts on invoices.user_id = contacts.user_id left outer join schema_1364.customers as emails on emails.email = contacts.contact_email group by invoices.invoice_id, invoices.price, customers.customer_name order by invoice_id",100000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
864,1378,3,Easy,"SELECT e.unique_id, emp.name AS name 
FROM schema_1378.employees AS emp 
LEFT JOIN schema_1378.employeeuni AS e ON emp.id = e.id;",101906,"select e.unique_id, emp.name as name from schema_1378.employees as emp left outer join schema_1378.employeeuni as e on emp.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
865,1378,4,Easy,"SELECT eu.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu USING (id);",101906,"select eu.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on eu.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
866,1378,5,Easy,"SELECT eu.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu USING (id)",101906,"select eu.unique_id as unique_id, e.name as name from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on e.id = eu.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
867,1378,6,Easy,"SELECT eu.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu USING (id);",101906,"select eu.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on e.id = eu.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
868,1378,8,Easy,"SELECT e.unique_id, em.name 
FROM schema_1378.employees em 
LEFT JOIN schema_1378.employeeuni e ON em.id = e.id",101906,"select employeeuni.unique_id as unique_id, employees.name as name from schema_1378.employees left outer join schema_1378.employeeuni on employees.id = employeeuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
869,1378,9,Easy,"SELECT employeeuni.unique_id, employees.name 
FROM schema_1378.employees 
LEFT JOIN schema_1378.employeeuni ON employees.id = employeeuni.id;",101906,"select employeeuni.unique_id, employees.name from schema_1378.employeeuni right outer join schema_1378.employees on employees.id = employeeuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
870,1378,10,Easy,"SELECT e.unique_id, em.name 
FROM schema_1378.employees em 
LEFT JOIN schema_1378.employeeuni e ON em.id = e.id",101906,"select employeeuni.unique_id, employees.name from schema_1378.employees left outer join schema_1378.employeeuni on employeeuni.id = employees.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
871,1378,11,Easy,"SELECT employeeuni.unique_id, employees.name 
FROM schema_1378.employees 
LEFT JOIN schema_1378.employeeuni USING (id);",101906,"select employeeuni.unique_id, employees.name from schema_1378.employees left outer join schema_1378.employeeuni on employees.id = employeeuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
872,1378,13,Easy,"SELECT e.unique_id, em.name 
FROM schema_1378.employees em 
LEFT JOIN schema_1378.employeeuni e ON em.id = e.id;",101906,"select employeeuni.unique_id, name from schema_1378.employees left outer join schema_1378.employeeuni on employees.id = employeeuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
873,1378,14,Easy,"SELECT e.name, eu.unique_id 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu ON e.id = eu.id",101906,"select employees.name, employeeuni.unique_id from schema_1378.employees left outer join schema_1378.employeeuni on employees.id = employeeuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
874,1378,21,Easy,"SELECT u.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni u USING (id);",101906,"select u.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as u on u.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
875,1378,22,Easy,"SELECT u.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni u ON e.id = u.id",101906,"select u.unique_id, e.name from schema_1378.employeeuni as u right outer join schema_1378.employees as e on u.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
876,1378,23,Easy,"SELECT u.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni u ON e.id = u.id",101906,"select u.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as u on e.id = u.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
877,1378,24,Easy,"SELECT e.unique_id, em.name 
FROM schema_1378.employees em 
LEFT JOIN LATERAL (
    SELECT eu.unique_id 
    FROM schema_1378.employeeuni eu 
    WHERE eu.id = em.id 
    LIMIT 1
) e ON true;",100000,"select unique_id, name from schema_1378.employees left outer join schema_1378.employeeuni on employees.id = employeeuni.id",101906,-1906,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,
878,1378,26,Easy,"SELECT a.name, b.unique_id FROM schema_1378.employees a LEFT JOIN schema_1378.employeeuni b USING (id)",101906,"select a.name, b.unique_id from schema_1378.employees as a left outer join schema_1378.employeeuni as b on a.id = b.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
879,1378,27,Easy,"SELECT a.unique_id, b.name FROM schema_1378.employees b LEFT JOIN schema_1378.employeeuni a ON b.id = a.id",101906,"select a.unique_id, b.name from schema_1378.employeeuni as a right outer join schema_1378.employees as b on a.id = b.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
880,1378,30,Easy,"SELECT b.unique_id, a.name FROM schema_1378.employees a LEFT JOIN schema_1378.employeeuni b USING (id)",101906,"select b.unique_id as unique_id, a.name as name from schema_1378.employees as a left outer join schema_1378.employeeuni as b on a.id = b.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
881,1378,31,Easy,"SELECT b.unique_id, a.name 
FROM schema_1378.employees a 
LEFT JOIN schema_1378.employeeuni b ON a.id = b.id;",101906,"select b.unique_id, a.name from schema_1378.employees as a left outer join schema_1378.employeeuni as b on a.id = b.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
882,1378,32,Easy,"SELECT b.unique_id, a.name 
FROM schema_1378.employees a 
LEFT JOIN schema_1378.employeeuni b ON b.id = a.id;",101906,"select b.unique_id, a.name from schema_1378.employees as a left outer join schema_1378.employeeuni as b on b.id = a.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
883,1378,36,Easy,"SELECT e.name, eu.unique_id FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni eu USING (id)",101906,"select e.name, eu.unique_id from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on e.id = eu.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
884,1378,38,Easy,"SELECT e.name, u.unique_id FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni u ON e.id = u.id;",101906,"select e.name, u.unique_id from schema_1378.employees as e left outer join schema_1378.employeeuni as u on e.id = u.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
885,1378,40,Easy,"SELECT e.name, uni.unique_id FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni uni ON e.id = uni.id;",101906,"select e.name, uni.unique_id from schema_1378.employees as e left outer join schema_1378.employeeuni as uni on e.id = uni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
886,1378,41,Easy,"SELECT e2.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni e2 ON e.id = e2.id",101906,"select e2.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as e2 on e.id = e2.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
887,1378,42,Easy,"SELECT e2.unique_id, e1.name FROM schema_1378.employees e1 LEFT JOIN schema_1378.employeeuni e2 ON e1.id = e2.id",101906,"select e2.unique_id, e1.name from schema_1378.employees as e1 left outer join schema_1378.employeeuni as e2 on e1.id = e2.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
888,1378,43,Easy,"SELECT e2.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni e2 ON e.id = e2.id",101906,"select e2.unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as e2 on e.id = e2.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
889,1378,44,Easy,"SELECT euni.unique_id, emp.name 
FROM schema_1378.employees emp 
LEFT JOIN schema_1378.employeeuni euni ON emp.id = euni.id",101906,"select euni.unique_id, emp.name from schema_1378.employees as emp left outer join schema_1378.employeeuni as euni on emp.id = euni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
890,1378,45,Easy,"SELECT euni.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni euni ON e.id = euni.id;",101906,"select euni.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as euni on e.id = euni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
891,1378,46,Easy,"SELECT e_uni.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni e_uni ON e.id = e_uni.id;",101906,"select e_uni.unique_id, e.name from schema_1378.employeeuni as e_uni right outer join schema_1378.employees as e on e_uni.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
892,1378,48,Easy,"SELECT en.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni en USING (id);",101906,"select en.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as en on e.id = en.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
893,1378,50,Easy,"SELECT eu.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni eu ON e.id = eu.id;",101906,"select eu.unique_id, e.name from schema_1378.employeeuni as eu right outer join schema_1378.employees as e on eu.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
894,1378,55,Easy,"SELECT eu.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu USING (id) 
ORDER BY e.name",101906,"select eu.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on e.id = eu.id order by e.name",101906,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
895,1378,64,Easy,"SELECT eu.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni eu USING (id)",101906,"select eu.unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on e.id = eu.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
896,1378,65,Easy,"SELECT i.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni i ON e.id = i.id;",101906,"select i.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as i on e.id = i.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
897,1378,66,Easy,"SELECT i.unique_id, s.name FROM schema_1378.employees s LEFT JOIN schema_1378.employeeuni i USING (id)",101906,"select i.unique_id, s.name from schema_1378.employees as s left outer join schema_1378.employeeuni as i on s.id = i.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
898,1378,69,Easy,"SELECT e.name, eu.unique_id 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu USING (id);",101906,"select name, unique_id from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on e.id = eu.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
899,1378,70,Easy,"SELECT e.name, eu.unique_id 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu ON e.id = eu.id",101906,"select name, unique_id from schema_1378.employees left outer join schema_1378.employeeuni on employees.id = employeeuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
900,1378,72,Easy,"SELECT t1.unique_id, t2.name 
FROM schema_1378.employees t2 
LEFT JOIN schema_1378.employeeuni t1 ON t1.id = t2.id;",101906,"select t1.unique_id, t2.name from schema_1378.employeeuni as t1 right outer join schema_1378.employees as t2 on t1.id = t2.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
901,1378,73,Easy,"SELECT t2.unique_id, t1.name FROM schema_1378.employees t1 LEFT JOIN schema_1378.employeeuni t2 ON t1.id = t2.id",101906,"select t2.unique_id, t1.name from schema_1378.employees as t1 left outer join schema_1378.employeeuni as t2 on t1.id = t2.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
902,1378,76,Easy,"SELECT u.unique_id, e.name FROM schema_1378.employeeuni AS u RIGHT JOIN schema_1378.employees AS e ON u.id = e.id",101906,"select u.unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as u on u.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
903,1378,78,Easy,"SELECT u.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni u ON e.id = u.id",101906,"select u.unique_id as unique_id, e.name as name from schema_1378.employeeuni as u right outer join schema_1378.employees as e on e.id = u.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
904,1378,79,Easy,"SELECT u.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni u USING (id)",101906,"select u.unique_id as unique_id, e.name as name from schema_1378.employees as e left outer join schema_1378.employeeuni as u on e.id = u.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
905,1378,91,Easy,"SELECT uni.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni uni USING (id);",101906,"select uni.unique_id as unique_id, e.name as name from schema_1378.employees as e left outer join schema_1378.employeeuni as uni on e.id = uni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
906,1378,92,Easy,"SELECT uni.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni uni ON e.id = uni.id;",101906,"select uni.unique_id, e.name from schema_1378.employeeuni as uni right outer join schema_1378.employees as e on uni.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
907,1378,93,Easy,"SELECT uni.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni uni USING (id);",101906,"select uni.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as uni on e.id = uni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
908,1378,95,Easy,"SELECT uni.unique_id, emp.name 
FROM schema_1378.employees emp 
LEFT JOIN schema_1378.employeeuni uni USING (id);",101906,"select uni.unique_id, emp.name from schema_1378.employees as emp left outer join schema_1378.employeeuni as uni on emp.id = uni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
909,1378,96,Easy,"SELECT uni.unique_id, emp.name 
FROM schema_1378.employees emp 
LEFT JOIN schema_1378.employeeuni uni ON emp.id = uni.id;",101906,"select uni.unique_id, emp.name from schema_1378.employeeuni as uni right outer join schema_1378.employees as emp on uni.id = emp.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
910,1378,98,Easy,"SELECT e.id AS unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu ON e.id = eu.id;",101906,"select unique_id, name from (select employees.id, name, employeeuni.unique_id from schema_1378.employees left outer join schema_1378.employeeuni on employees.id = employeeuni.id) as new",101906,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query aliases the employee's own id as unique_id, while the initial query fetches the actual unique_id from the employeeuni table."
911,1378,99,Easy,"SELECT e.unique_id, em.name 
FROM schema_1378.employees em 
LEFT JOIN schema_1378.employeeuni e ON em.id = e.id",101906,"select unique_id, name from schema_1378.employeeuni right outer join schema_1378.employees on employeeuni.id = employees.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
912,1378,100,Easy,"SELECT employeeuni.unique_id, employees.name 
FROM schema_1378.employees 
LEFT JOIN schema_1378.employeeuni ON employees.id = employeeuni.id",101906,"select unique_id, name from schema_1378.employeeuni right outer join schema_1378.employees on employees.id = employeeuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
913,1378,104,Easy,"SELECT e1.unique_id, e2.name 
FROM schema_1378.employees e2 
LEFT JOIN schema_1378.employeeuni e1 ON e2.id = e1.id",101906,"select unique_id, name from schema_1378.employeeuni as e1 right outer join schema_1378.employees as e2 on e1.id = e2.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
914,1378,105,Easy,"SELECT e2.unique_id, e1.name 
FROM schema_1378.employees e1 
LEFT JOIN schema_1378.employeeuni e2 ON e1.id = e2.id",101906,"select unique_id, name from schema_1378.employees as e1 left outer join schema_1378.employeeuni as e2 on e1.id = e2.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
915,1378,106,Easy,"SELECT t2.unique_id, t1.name 
FROM schema_1378.employees t1 
LEFT JOIN schema_1378.employeeuni t2 ON t1.id = t2.id",101906,"select unique_id, name from schema_1378.employees as t1 left outer join schema_1378.employeeuni as t2 on t1.id = t2.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
916,1378,107,Easy,"SELECT e.unique_id, em.name 
FROM schema_1378.employees em 
LEFT JOIN schema_1378.employeeuni e ON em.id = e.id",101906,"select unique_id, name from schema_1378.employees left outer join schema_1378.employeeuni on employeeuni.id = employees.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
917,1378,114,Easy,"SELECT t.unique_id, s.name 
FROM schema_1378.employees s 
LEFT JOIN schema_1378.employeeuni t ON s.id = t.id",101906,"select unique_id, name from schema_1378.employees as s left outer join schema_1378.employeeuni as t on s.id = t.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
918,1378,115,Easy,"SELECT a.id, a.name, b.unique_id 
FROM schema_1378.employees a 
LEFT JOIN schema_1378.employeeuni b USING (id);",101906,"select unique_id, name from schema_1378.employees as a left outer join schema_1378.employeeuni as b on a.id = b.id",101906,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query aliases the employee's own id as unique_id, while the initial query fetches the actual unique_id from the employeeuni table."
919,1378,119,Easy,"SELECT e.id AS unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni ei ON e.id = ei.id",101906,"select unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as ei on e.id = ei.id",101906,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query aliases the employee's own id as unique_id, while the initial query fetches the actual unique_id from the employeeuni table."
920,1378,120,Easy,"SELECT e.id, e.name, eu.unique_id 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu USING (id);",101906,"select unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on e.id = eu.id",101906,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query aliases the employee's own id as unique_id, while the initial query fetches the actual unique_id from the employeeuni table."
921,1378,121,Easy,"SELECT e.id AS unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni i ON e.id = i.id",101906,"select unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as i on e.id = i.id",101906,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query aliases the employee's own id as unique_id, while the initial query fetches the actual unique_id from the employeeuni table."
922,1378,122,Easy,"SELECT u.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni u USING (id)",101906,"select unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as u on e.id = u.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
924,1378,127,Easy,"SELECT emp_uni.unique_id, emp.name 
FROM schema_1378.employees emp 
LEFT JOIN schema_1378.employeeuni emp_uni ON emp.id = emp_uni.id",101906,"select unique_id, name from schema_1378.employees as emp left outer join schema_1378.employeeuni as emp_uni on emp.id = emp_uni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
926,1378,129,Easy,"SELECT eu.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu USING (id) 
ORDER BY e.name",101906,"select unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on e.id = eu.id order by name asc",101906,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
928,1378,144,Easy,"SELECT en.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni en ON e.id = en.id;",101906,"select en.unique_id, e.name from schema_1378.employeeuni as en right outer join schema_1378.employees as e on en.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
929,1378,148,Easy,"SELECT i.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni i ON e.id = i.id;",101906,"select i.unique_id, e.name from schema_1378.employeeuni as i right outer join schema_1378.employees as e on i.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
930,1378,151,Easy,"SELECT u.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni u ON e.id = u.id;",101906,"select unique_id, name from schema_1378.employeeuni as u right outer join schema_1378.employees as e on u.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
931,1378,159,Easy,"SELECT en.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni en ON e.id = en.id;",101906,"select en.unique_id, e.name from schema_1378.employeeuni as en right outer join schema_1378.employees as e on e.id = en.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
932,1378,160,Easy,"SELECT eu.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu USING (id);",101906,"select eu.unique_id as unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on e.id = eu.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
933,1378,163,Easy,"SELECT employeeuni.unique_id, employees.name 
FROM schema_1378.employees 
LEFT JOIN schema_1378.employeeuni ON employees.id = employeeuni.id;",101906,"select employeeuni.unique_id, employees.name from schema_1378.employeeuni right outer join schema_1378.employees on employeeuni.id = employees.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
934,1378,170,Easy,"SELECT employeeunitable.unique_id, employeestable.name 
FROM schema_1378.employees employeestable 
LEFT JOIN schema_1378.employeeuni employeeunitable USING (id);",101906,"select employeeunitable.unique_id as unique_id, employeestable.name from schema_1378.employees as employeestable left outer join schema_1378.employeeuni as employeeunitable on employeestable.id = employeeunitable.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
935,1378,172,Easy,"SELECT eu.unique_id, ey.name 
FROM schema_1378.employees ey 
LEFT JOIN schema_1378.employeeuni eu USING (id);",101906,"select eu.unique_id, ey.name from schema_1378.employees as ey left outer join schema_1378.employeeuni as eu on ey.id = eu.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
936,1378,175,Easy,"SELECT e1.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni e1 ON e.id = e1.id",101906,"select unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as e1 on e.id = e1.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
937,1378,177,Easy,"SELECT a.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni a ON e.id = a.id;",101906,"select a.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as a on e.id = a.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
938,1378,184,Easy,"SELECT a.unique_id, b.name FROM schema_1378.employees b LEFT JOIN schema_1378.employeeuni a ON b.id = a.id;",101906,"select a.unique_id, name from schema_1378.employeeuni as a right outer join schema_1378.employees as b on a.id = b.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
939,1378,188,Easy,"SELECT b.unique_id, a.name FROM schema_1378.employees a LEFT JOIN schema_1378.employeeuni b USING (id)",101906,"select b.unique_id as unique_id, a.name as name from schema_1378.employees as a left outer join schema_1378.employeeuni as b on b.id = a.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
940,1378,189,Easy,"SELECT b.unique_id, a.name FROM schema_1378.employees AS a LEFT JOIN schema_1378.employeeuni AS b ON a.id = b.id;",101906,"select b.unique_id, a.name from schema_1378.employeeuni as b right outer join schema_1378.employees as a on b.id = a.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
941,1378,210,Easy,"SELECT e.name, euni.unique_id FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni euni ON e.id = euni.id",101906,"select e.name, euni.unique_id from schema_1378.employees as e left outer join schema_1378.employeeuni as euni on e.id = euni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
942,1378,211,Easy,"SELECT e.name, u.unique_id FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni u USING (id);",101906,"select e.name, u.unique_id from schema_1378.employees as e left outer join schema_1378.employeeuni as u on u.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
943,1378,212,Easy,"SELECT e.unique_id, s.name 
FROM schema_1378.employees s 
LEFT JOIN schema_1378.employeeuni e USING (id);",101906,"select e.unique_id as unique_id, name from schema_1378.employees as s left outer join schema_1378.employeeuni as e on e.id = s.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
944,1378,213,Easy,"SELECT e.unique_id, e2.name FROM schema_1378.employees e2 LEFT JOIN schema_1378.employeeuni e USING (id)",101906,"select e.unique_id, e2.name from schema_1378.employees as e2 left outer join schema_1378.employeeuni as e on e2.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
945,1378,214,Easy,"SELECT e.unique_id, s.name FROM schema_1378.employees s LEFT JOIN schema_1378.employeeuni e ON s.id = e.id;",101906,"select e.unique_id, s.name from schema_1378.employeeuni as e right outer join schema_1378.employees as s on e.id = s.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
946,1378,216,Easy,"SELECT e2.unique_id, e1.name 
FROM schema_1378.employees e1 
LEFT JOIN schema_1378.employeeuni e2 ON e1.id = e2.id",101906,"select e2.unique_id as unique_id, e1.name from schema_1378.employees as e1 left outer join schema_1378.employeeuni as e2 on e1.id = e2.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
947,1378,224,Easy,"SELECT e.id AS unique_id, e.name AS name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni ee ON e.id = ee.id;",101906,"select ee.unique_id as unique_id, e.name as name from schema_1378.employeeuni as ee right outer join schema_1378.employees as e on ee.id = e.id",101906,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query aliases the employee's own id as unique_id, while the initial query fetches the actual unique_id from the employeeuni table."
948,1378,225,Easy,"SELECT em.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni em USING (id);",101906,"select em.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as em on e.id = em.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
949,1378,227,Easy,"SELECT emp.name, empuni.unique_id FROM schema_1378.employees emp LEFT JOIN schema_1378.employeeuni empuni ON emp.id = empuni.id",101906,"select emp.name, empuni.unique_id from schema_1378.employeeuni as empuni right outer join schema_1378.employees as emp on emp.id = empuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
950,1378,228,Easy,"SELECT emp.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni emp ON e.id = emp.id",101906,"select emp.unique_id, e.name from schema_1378.employeeuni as emp right outer join schema_1378.employees as e on emp.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
951,1378,229,Easy,"SELECT empin.unique_id, emp.name 
FROM schema_1378.employees emp 
LEFT JOIN schema_1378.employeeuni empin ON emp.id = empin.id;",101906,"select empin.unique_id, emp.name from schema_1378.employees as emp left outer join schema_1378.employeeuni as empin on emp.id = empin.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
952,1378,230,Easy,"SELECT employeeuni.unique_id, employees.name 
FROM schema_1378.employees 
LEFT JOIN schema_1378.employeeuni USING (id);",101906,"select employeeuni.unique_id as unique_id, employees.name from schema_1378.employees left outer join schema_1378.employeeuni on employees.id = employeeuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
953,1378,235,Easy,"SELECT emu.unique_id, em.name 
FROM schema_1378.employees em 
LEFT JOIN schema_1378.employeeuni emu USING (id)",101906,"select emu.unique_id, em.name from schema_1378.employees as em left outer join schema_1378.employeeuni as emu on em.id = emu.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
954,1378,237,Easy,"SELECT eni.unique_id, emp.name 
FROM schema_1378.employees emp 
LEFT JOIN schema_1378.employeeuni eni ON emp.id = eni.id",101906,"select eni.unique_id, emp.name from schema_1378.employees as emp left outer join schema_1378.employeeuni as eni on emp.id = eni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
955,1378,249,Easy,"SELECT eu.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni eu ON e.id = eu.id",101906,"select eu.unique_id, e.name from schema_1378.employeeuni as eu right outer join schema_1378.employees as e on e.id = eu.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
956,1378,266,Easy,"SELECT a.name, b.unique_id 
FROM schema_1378.employees a 
LEFT JOIN schema_1378.employeeuni b USING (id);",101906,"select name, unique_id from schema_1378.employees as a left outer join schema_1378.employeeuni as b on a.id = b.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
957,1378,268,Easy,"SELECT e.name, eu.unique_id 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu USING (id);",101906,"select name, unique_id from schema_1378.employees as e left outer join schema_1378.employeeuni as eu on eu.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
958,1378,270,Easy,"SELECT e.name, e1.unique_id 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni e1 ON e.id = e1.id",101906,"select name, unique_id from schema_1378.employees as e left outer join schema_1378.employeeuni as e1 on e.id = e1.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
959,1378,272,Easy,"SELECT e1.name, e2.unique_id 
FROM schema_1378.employees e1 
LEFT JOIN schema_1378.employeeuni e2 ON e1.id = e2.id",101906,"select name, unique_id from schema_1378.employees as e1 left outer join schema_1378.employeeuni as e2 on e1.id = e2.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
960,1378,273,Easy,"SELECT e.name, u.unique_id 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni u USING (id);",101906,"select name, unique_id from schema_1378.employees as e left outer join schema_1378.employeeuni as u on e.id = u.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
961,1378,274,Easy,"SELECT s.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni s USING (id)",101906,"select s.unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as s on e.id = s.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
962,1378,282,Easy,"SELECT u.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni u USING (id);",101906,"select u.unique_id as unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as u on e.id = u.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
963,1378,308,Easy,"SELECT uni.unique_id, e.name FROM schema_1378.employees e LEFT JOIN schema_1378.employeeuni uni ON e.id = uni.id",101906,"select uni.unique_id as unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as uni on e.id = uni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
964,1378,310,Easy,"SELECT empuni.unique_id, emp.name 
FROM schema_1378.employees emp 
LEFT JOIN schema_1378.employeeuni empuni ON emp.id = empuni.id",101906,"select unique_id, name from schema_1378.employees as emp left outer join schema_1378.employeeuni as empuni on emp.id = empuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
965,1378,313,Easy,"SELECT emp.id AS unique_id, emp.name 
FROM schema_1378.employees emp 
LEFT JOIN schema_1378.employeeuni uni ON emp.id = uni.id;",101906,"select unique_id, name from schema_1378.employees as emp left outer join schema_1378.employeeuni as uni on uni.id = emp.id",101906,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query aliases the employee's own id as unique_id, while the initial query fetches the actual unique_id from the employeeuni table."
966,1378,315,Easy,"SELECT e.unique_id, em.name 
FROM schema_1378.employees em 
LEFT JOIN schema_1378.employeeuni e ON em.id = e.id",101906,"select unique_id, employees.name from schema_1378.employeeuni right outer join schema_1378.employees on employees.id = employeeuni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
967,1378,316,Easy,"SELECT e.unique_id, em.name 
FROM schema_1378.employees em 
LEFT JOIN (SELECT id, MIN(unique_id) AS unique_id FROM schema_1378.employeeuni GROUP BY id) e ON em.id = e.id",100000,"select unique_id, employees.name from schema_1378.employees left outer join schema_1378.employeeuni on employees.id = employeeuni.id",101906,-1906,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The initial query returns all matches between employees and their unique IDs, potentially producing multiple rows per employee, while the optimized query returns only one row per employee by selecting the minimum unique_id using aggregation."
968,1378,317,Easy,"SELECT f.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni f USING (id)",101906,"select unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as f on e.id = f.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
969,1378,318,Easy,"SELECT u.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni u USING (id)",101906,"select unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as u on e.id = u.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
970,1378,319,Easy,"SELECT i.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni i USING (id)",101906,"select unique_id, e.name from schema_1378.employees as e left outer join schema_1378.employeeuni as i on e.id = i.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
971,1378,321,Easy,"SELECT empu.unique_id, emp.name 
FROM schema_1378.employees emp 
LEFT JOIN schema_1378.employeeuni empu ON empu.id = emp.id",101906,"select unique_id, emp.name from schema_1378.employees as emp left outer join schema_1378.employeeuni as empu on empu.id = emp.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
972,1378,322,Easy,"SELECT a.unique_id, b.name 
FROM schema_1378.employees b 
LEFT JOIN schema_1378.employeeuni a ON b.id = a.id;",101906,"select unique_id, name from schema_1378.employeeuni as a right outer join schema_1378.employees as b on a.id = b.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
973,1378,323,Easy,"SELECT e.id AS unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni i ON e.id = i.id;",101906,"select unique_id, name from schema_1378.employeeuni as i right outer join schema_1378.employees as e on i.id = e.id",101906,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query aliases the employee's own id as unique_id, while the initial query fetches the actual unique_id from the employeeuni table."
974,1378,324,Easy,"SELECT e.unique_id, u.name 
FROM schema_1378.employees u 
LEFT JOIN schema_1378.employeeuni e ON u.id = e.id",101906,"select unique_id, name from schema_1378.employeeuni as e right outer join schema_1378.employees as u on e.id = u.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
975,1378,325,Easy,"SELECT eu.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu ON e.id = eu.id",101906,"select unique_id, name from schema_1378.employeeuni as eu right outer join schema_1378.employees as e on eu.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
977,1378,331,Easy,"SELECT e.unique_id, u.name 
FROM schema_1378.employees u 
LEFT JOIN schema_1378.employeeuni e ON u.id = e.id;",101906,"select unique_id, name from schema_1378.employees as u left outer join schema_1378.employeeuni as e on u.id = e.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
978,1378,337,Easy,"SELECT e_uni.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni e_uni ON e.id = e_uni.id;",101906,"select unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as e_uni on e.id = e_uni.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
981,1378,346,Easy,"SELECT e2.unique_id, e1.name 
FROM schema_1378.employees e1 
LEFT JOIN schema_1378.employeeuni e2 ON e1.id = e2.id 
ORDER BY e1.name",101906,"select unique_id, name from schema_1378.employees as e1 left outer join schema_1378.employeeuni as e2 on e1.id = e2.id order by name",101906,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
982,1378,354,Easy,"SELECT eu.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni eu ON e.id = eu.id",101906,"select unique_id, name from schema_1378.employeeuni as eu right outer join schema_1378.employees as e on e.id = eu.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
983,1378,361,Easy,"SELECT emp.id AS unique_id, emp.name 
FROM schema_1378.employees emp 
LEFT JOIN schema_1378.employeeuni uni ON emp.id = uni.id",101906,"select unique_id, name from schema_1378.employees as emp left outer join schema_1378.employeeuni as uni on emp.id = uni.id",101906,0,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,Non-equivalent queries,"The optimized query aliases the employee's own id as unique_id, while the initial query fetches the actual unique_id from the employeeuni table."
985,1378,386,Easy,"SELECT ue.unique_id, e.name 
FROM schema_1378.employees e 
LEFT JOIN schema_1378.employeeuni ue ON e.id = ue.id",101906,"select unique_id, name from schema_1378.employees as e left outer join schema_1378.employeeuni as ue on e.id = ue.id",101906,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
986,1495,97,Easy,"SELECT DISTINCT c.title 
FROM schema_1495.content c
WHERE c.content_type = 'Movies' 
AND c.kids_content = 'Y'
AND EXISTS (
    SELECT 1 
    FROM schema_1495.TVProgram t 
    WHERE t.content_id = c.content_id 
    AND t.program_date >= '2020-06-01' 
    AND t.program_date < '2020-07-01'
);",456,select distinct title from schema_1495.TVProgram as t join schema_1495.content as c on t.content_id = c.content_id where (c.content_type = 'Movies' and kids_content = 'Y' and t.program_date >= '2020-06-01 00:00' and t.program_date < '2020-07-01 00:00'),456,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
987,1495,107,Easy,"SELECT t1.title 
FROM schema_1495.content t1 
WHERE t1.content_id IN (
    SELECT t2.content_id 
    FROM schema_1495.TVProgram t2 
    WHERE t2.program_date >= '2020-06-01' 
    AND t2.program_date < '2020-07-01'
) 
AND t1.kids_content = 'Y' 
AND t1.content_type = 'Movies'",1204,select distinct t1.title from schema_1495.content as t1 join schema_1495.TVProgram as t2 on t1.content_id = t2.content_id where (t1.kids_content = 'Y' and t1.content_type = 'Movies' and t2.program_date >= '2020-06-01' and t2.program_date < '2020-07-01'),456,748,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
988,1495,139,Easy,"SELECT c.title
FROM schema_1495.TVProgram t
JOIN schema_1495.content c ON t.content_id = c.content_id
WHERE t.program_date BETWEEN '2020-06-01' AND '2020-06-30'
  AND c.kids_content = 'Y'
  AND c.content_type = 'Movies'
GROUP BY c.title;",456,select distinct c.title as title from schema_1495.TVProgram as t join schema_1495.content as c on t.content_id = c.content_id where (t.program_date >= '2020-06-01' and t.program_date <= '2020-06-30' and c.kids_content = 'Y' and c.content_type = 'Movies'),456,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
989,1495,251,Easy,"SELECT c.title 
FROM schema_1495.content c
WHERE c.content_id IN (
    SELECT t.content_id 
    FROM schema_1495.TVProgram t 
    WHERE t.program_date BETWEEN '2020-06-01' AND '2020-06-30'
)
AND c.kids_content = 'Y' 
AND c.content_type = 'Movies'",1204,select distinct title from schema_1495.content as c join schema_1495.TVProgram as t on c.content_id = t.content_id where (kids_content = 'Y' and content_type = 'Movies' and program_date >= '2020-06-01' and program_date <= '2020-06-30'),456,748,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
990,1495,299,Easy,"SELECT title FROM schema_1495.content WHERE content_id IN (
    SELECT content_id FROM schema_1495.TVProgram 
    WHERE program_date BETWEEN '2020-06-01' AND '2020-06-30'
) AND kids_content = 'Y' AND content_type = 'Movies' GROUP BY title;",456,select distinct title from schema_1495.content as c join schema_1495.TVProgram as t on c.content_id = t.content_id where (program_date >= '2020-06-01' and program_date <= '2020-06-30' and kids_content = 'Y' and content_type = 'Movies'),456,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
991,1532,1,Medium,"SELECT a.name AS customer_name, a.customer_id, b.order_id, b.order_date 
FROM schema_1532.customers a 
JOIN schema_1532.orders b ON a.customer_id = b.customer_id 
WHERE (
    SELECT COUNT(*) 
    FROM schema_1532.orders c 
    WHERE c.customer_id = b.customer_id AND c.order_date >= b.order_date
) <= 3 
ORDER BY a.name ASC, a.customer_id ASC, b.order_date DESC",77847,"select a.name as customer_name, a.customer_id, b.order_id, b.order_date from schema_1532.customers as a join schema_1532.orders as b on a.customer_id = b.customer_id join schema_1532.orders as c on (b.customer_id = c.customer_id and b.order_date <= c.order_date) group by a.name, a.customer_id, b.order_id, b.order_date having count(c.order_date) <= 3 order by a.name asc, a.customer_id asc, b.order_date desc",77847,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
992,1532,15,Medium,"SELECT a.name AS customer_name, a.customer_id, b.order_id, b.order_date 
FROM schema_1532.customers a 
JOIN schema_1532.orders b ON a.customer_id = b.customer_id 
WHERE (
    SELECT COUNT(*) 
    FROM schema_1532.orders c 
    WHERE c.customer_id = b.customer_id AND c.order_date >= b.order_date
) <= 3 
ORDER BY a.name, a.customer_id, b.order_date DESC",77847,"select a.name as customer_name, a.customer_id, b.order_id, b.order_date from schema_1532.customers as a join schema_1532.orders as b on a.customer_id = b.customer_id join schema_1532.orders as c on (b.customer_id = c.customer_id and b.order_date <= c.order_date) group by a.name, a.customer_id, b.order_id, b.order_date having count(c.order_date) <= 3 order by a.name, a.customer_id, b.order_date desc",77847,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
993,1532,25,Medium,"WITH ranked_orders AS (
    SELECT 
        o.customer_id,
        o.order_id,
        o.order_date,
        RANK() OVER (PARTITION BY o.customer_id ORDER BY o.order_date DESC) as rank
    FROM schema_1532.orders o
)
SELECT 
    c.name as customer_name,
    ro.customer_id,
    ro.order_id,
    ro.order_date
FROM ranked_orders ro
JOIN schema_1532.customers c ON ro.customer_id = c.customer_id
WHERE ro.rank <= 3
ORDER BY c.name, ro.customer_id, ro.order_date DESC",77847,"select c.name as customer_name, o1.customer_id, o1.order_id, o1.order_date from schema_1532.orders as o1 join schema_1532.orders as o2 on (o1.customer_id = o2.customer_id and o1.order_date <= o2.order_date) join schema_1532.customers as c on o1.customer_id = c.customer_id group by c.name, o1.customer_id, o1.order_id, o1.order_date having count(o2.order_date) <= 3 order by c.name, o1.customer_id, o1.order_date desc",77847,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
994,1532,27,Medium,"WITH ranked_orders AS (
    SELECT 
        o.customer_id,
        o.order_id,
        o.order_date,
        RANK() OVER (PARTITION BY o.customer_id ORDER BY o.order_date DESC) as rank
    FROM schema_1532.orders o
)
SELECT 
    c.name as customer_name, 
    c.customer_id, 
    ro.order_id, 
    ro.order_date
FROM schema_1532.customers c
JOIN ranked_orders ro ON c.customer_id = ro.customer_id
WHERE ro.rank <= 3
ORDER BY c.name, c.customer_id, ro.order_date DESC",77847,"select c.name as customer_name, c.customer_id, o1.order_id, o1.order_date from schema_1532.customers as c join schema_1532.orders as o1 on c.customer_id = o1.customer_id join schema_1532.orders as o2 on (o1.customer_id = o2.customer_id and o1.order_date <= o2.order_date) group by c.name, c.customer_id, o1.order_id, o1.order_date having count(o2.order_date) <= 3 order by c.name, c.customer_id, o1.order_date desc",77847,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
995,1532,32,Medium,"WITH ranked_orders AS (
    SELECT 
        o.customer_id,
        o.order_id,
        o.order_date,
        DENSE_RANK() OVER (PARTITION BY o.customer_id ORDER BY o.order_date DESC) as rank
    FROM schema_1532.orders o
)
SELECT 
    c.name as customer_name,
    ro.customer_id,
    ro.order_id,
    ro.order_date
FROM ranked_orders ro
JOIN schema_1532.customers c ON ro.customer_id = c.customer_id
WHERE ro.rank <= 3
ORDER BY c.name, ro.customer_id, ro.order_date DESC",77847,"select c.name as customer_name, o1.customer_id, o1.order_id, o1.order_date from schema_1532.orders as o1 left outer join schema_1532.orders as o2 on (o1.customer_id = o2.customer_id and o1.order_date < o2.order_date) join schema_1532.customers as c on o1.customer_id = c.customer_id group by o1.customer_id, c.name, o1.order_id, o1.order_date having count(o2.order_date) <= 2 order by c.name, o1.customer_id, o1.order_date desc",77847,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
996,1677,12,Easy,"SELECT p.name, 
       SUM(i.rest) AS rest, 
       SUM(i.paid) AS paid, 
       SUM(i.canceled) AS canceled, 
       SUM(i.refunded) AS refunded 
FROM schema_1677.invoice i 
JOIN schema_1677.product p ON i.product_id = p.product_id 
GROUP BY p.product_id, p.name 
ORDER BY p.name",10000,"select p.name, sum(i.rest) as rest, sum(i.paid) as paid, sum(i.canceled) as canceled, sum(i.refunded) as refunded from schema_1677.invoice as i join schema_1677.product as p on i.product_id = p.product_id group by p.name order by p.name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
997,1677,191,Easy,"SELECT p.name, 
       SUM(i.rest) AS rest, 
       SUM(i.paid) AS paid, 
       SUM(i.canceled) AS canceled, 
       SUM(i.refunded) AS refunded 
FROM schema_1677.invoice i
JOIN schema_1677.product p ON i.product_id = p.product_id
GROUP BY p.product_id, p.name
ORDER BY p.name",10000,"select name, sum(rest) as rest, sum(paid) as paid, sum(canceled) as canceled, sum(refunded) as refunded from schema_1677.product as p join schema_1677.invoice as i on p.product_id = i.product_id group by p.product_id, name order by name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
998,1677,192,Easy,"SELECT p.name, 
       SUM(i.rest) AS rest, 
       SUM(i.paid) AS paid, 
       SUM(i.canceled) AS canceled, 
       SUM(i.refunded) AS refunded 
FROM schema_1677.product p 
JOIN schema_1677.invoice i ON p.product_id = i.product_id 
GROUP BY p.name 
ORDER BY p.name;",10000,"select name, sum(rest) as rest, sum(paid) as paid, sum(canceled) as canceled, sum(refunded) as refunded from schema_1677.invoice as i join schema_1677.product as p on i.product_id = p.product_id group by name order by name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
999,1677,196,Easy,"SELECT p.name, 
       SUM(i.rest) AS rest, 
       SUM(i.paid) AS paid, 
       SUM(i.canceled) AS canceled, 
       SUM(i.refunded) AS refunded 
FROM schema_1677.invoice AS i 
JOIN schema_1677.product AS p ON p.product_id = i.product_id 
GROUP BY p.name 
ORDER BY p.name",10000,"select name, sum(rest) as rest, sum(paid) as paid, sum(canceled) as canceled, sum(refunded) as refunded from schema_1677.product as p join schema_1677.invoice as i on p.product_id = i.product_id group by name order by name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1000,1677,198,Easy,"SELECT a.name, 
       SUM(b.rest) AS rest, 
       SUM(b.paid) AS paid, 
       SUM(b.canceled) AS canceled, 
       SUM(b.refunded) AS refunded 
FROM schema_1677.invoice b 
JOIN schema_1677.product a ON b.product_id = a.product_id 
GROUP BY a.name 
ORDER BY a.name",10000,"select name, sum(rest) as rest, sum(paid) as paid, sum(canceled) as canceled, sum(refunded) as refunded from schema_1677.product as a join schema_1677.invoice as b on a.product_id = b.product_id group by name order by name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1001,1677,223,Easy,"SELECT p.name, 
       SUM(i.rest) AS rest, 
       SUM(i.paid) AS paid, 
       SUM(i.canceled) AS canceled, 
       SUM(i.refunded) AS refunded 
FROM schema_1677.invoice AS i 
JOIN schema_1677.product AS p ON i.product_id = p.product_id 
GROUP BY p.name 
ORDER BY p.name ASC",10000,"select p.name, sum(i.rest) as rest, sum(i.paid) as paid, sum(i.canceled) as canceled, sum(i.refunded) as refunded from schema_1677.product as p join schema_1677.invoice as i on p.product_id = i.product_id group by p.name order by p.name asc",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1002,1677,224,Easy,"SELECT p.name, 
       SUM(a.rest) AS rest, 
       SUM(a.paid) AS paid, 
       SUM(a.canceled) AS canceled, 
       SUM(a.refunded) AS refunded 
FROM schema_1677.invoice a 
JOIN schema_1677.product p ON a.product_id = p.product_id 
GROUP BY p.name 
ORDER BY p.name",10000,"select p.name, a.rest, a.paid, a.canceled, a.refunded from (select product_id, sum(rest) as rest, sum(paid) as paid, sum(canceled) as canceled, sum(refunded) as refunded from schema_1677.invoice group by product_id) as a join schema_1677.product as p on a.product_id = p.product_id order by p.name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1003,1677,267,Easy,"SELECT p.name, 
       SUM(i.rest) AS rest, 
       SUM(i.paid) AS paid, 
       SUM(i.canceled) AS canceled, 
       SUM(i.refunded) AS refunded 
FROM schema_1677.invoice AS i 
JOIN schema_1677.product AS p ON i.product_id = p.product_id 
GROUP BY p.name 
ORDER BY p.name",10000,"select p.name, sum(i.rest) as rest, sum(i.paid) as paid, sum(i.canceled) as canceled, sum(i.refunded) as refunded from schema_1677.product as p join schema_1677.invoice as i on p.product_id = i.product_id group by p.name order by p.name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1004,1677,269,Easy,"SELECT p.name, 
       SUM(i.rest) AS rest, 
       SUM(i.paid) AS paid, 
       SUM(i.canceled) AS canceled, 
       SUM(i.refunded) AS refunded 
FROM schema_1677.invoice AS i 
LEFT JOIN schema_1677.product AS p ON i.product_id = p.product_id 
GROUP BY p.product_id, p.name 
ORDER BY p.name",10000,"select p.name, sum(i.rest) as rest, sum(i.paid) as paid, sum(i.canceled) as canceled, sum(i.refunded) as refunded from schema_1677.product as p right outer join schema_1677.invoice as i on p.product_id = i.product_id group by p.product_id order by name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1005,1677,270,Easy,"SELECT p.name, 
       SUM(i.rest) AS rest, 
       SUM(i.paid) AS paid, 
       SUM(i.canceled) AS canceled, 
       SUM(i.refunded) AS refunded 
FROM schema_1677.invoice AS i 
JOIN schema_1677.product AS p ON p.product_id = i.product_id 
GROUP BY p.product_id, p.name 
ORDER BY p.name",10000,"select p.name, sum(i.rest) as rest, sum(i.paid) as paid, sum(i.canceled) as canceled, sum(i.refunded) as refunded from schema_1677.product as p join schema_1677.invoice as i on i.product_id = p.product_id group by p.product_id order by p.name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1006,1677,278,Easy,"SELECT p.name, 
       SUM(i.rest) AS rest, 
       SUM(i.paid) AS paid, 
       SUM(i.canceled) AS canceled, 
       SUM(i.refunded) AS refunded 
FROM schema_1677.invoice AS i 
JOIN schema_1677.product AS p ON i.product_id = p.product_id 
GROUP BY p.name 
ORDER BY p.name",10000,"select p.name, sum(i.rest) as rest, sum(i.paid) as paid, sum(i.canceled) as canceled, sum(i.refunded) as refunded from schema_1677.product as p join schema_1677.invoice as i on i.product_id = p.product_id group by p.name order by p.name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1007,1677,282,Easy,"SELECT p.name, 
       SUM(i.rest) AS rest, 
       SUM(i.paid) AS paid, 
       SUM(i.canceled) AS canceled, 
       SUM(i.refunded) AS refunded 
FROM schema_1677.invoice i
JOIN schema_1677.product p ON i.product_id = p.product_id 
GROUP BY p.name 
ORDER BY p.name ASC",10000,"select product.name, sum(invoice.rest) as rest, sum(invoice.paid) as paid, sum(invoice.canceled) as canceled, sum(invoice.refunded) as refunded from schema_1677.invoice join schema_1677.product on invoice.product_id = product.product_id group by product.name order by product.name asc",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1008,1677,283,Easy,"SELECT p.name, 
       COALESCE(SUM(i.rest), 0) AS rest, 
       COALESCE(SUM(i.paid), 0) AS paid, 
       COALESCE(SUM(i.canceled), 0) AS canceled, 
       COALESCE(SUM(i.refunded), 0) AS refunded 
FROM schema_1677.product p 
LEFT JOIN schema_1677.invoice i ON p.product_id = i.product_id 
GROUP BY p.product_id, p.name 
ORDER BY p.name",10000,"select product.name, sum(rest) as rest, sum(paid) as paid, sum(canceled) as canceled, sum(refunded) as refunded from schema_1677.invoice left outer join schema_1677.product on invoice.product_id = product.product_id group by product.product_id order by product.name",10000,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1009,1693,1,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by 1, 2",37843,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1010,1693,3,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name",37843,"select distinct date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by date_id, make_name",37843,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1011,1693,6,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by date_id, make_name",37843,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1012,1693,11,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name 
ORDER BY make_name DESC, date_id DESC",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by date_id, make_name order by make_name desc, date_id desc",37843,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1013,1693,20,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name 
ORDER BY date_id, make_name",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by date_id, make_name order by date_id",37843,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1014,1693,22,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by make_name, date_id",37843,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1015,1693,40,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by 2, 1",37843,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1016,1693,61,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name 
ORDER BY make_name DESC",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by make_name, date_id order by make_name desc",37843,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1017,1693,81,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name 
ORDER BY make_name, date_id",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by make_name, date_id order by make_name",37843,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1018,1693,90,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name",37843,"select distinct date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by 1, 2",37843,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1019,1693,91,Easy,"SELECT 
    date_id, 
    make_name, 
    COUNT(DISTINCT lead_id) AS unique_leads, 
    COUNT(DISTINCT partner_id) AS unique_partners 
FROM 
    schema_1693.dailysales 
GROUP BY 
    date_id, 
    make_name",37843,"select a.date_id, a.make_name, count(distinct a.lead_id) as unique_leads, count(distinct a.partner_id) as unique_partners from schema_1693.dailysales as b left outer join schema_1693.dailysales as a on (a.date_id = b.date_id and a.make_name = b.make_name) group by a.date_id, a.make_name",37843,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1020,1693,92,Easy,"SELECT 
    date_id, 
    make_name, 
    COUNT(DISTINCT lead_id) AS unique_leads, 
    COUNT(DISTINCT partner_id) AS unique_partners 
FROM 
    schema_1693.dailysales
GROUP BY 
    date_id, 
    make_name",37843,"select a.date_id, a.make_name, count(distinct a.lead_id) as unique_leads, count(distinct a.partner_id) as unique_partners from schema_1693.dailysales as b left outer join schema_1693.dailysales as a on (a.date_id = b.date_id and a.make_name = b.make_name) where (b.lead_id <= a.lead_id and b.partner_id <= a.partner_id) group by a.date_id, a.make_name",37843,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1021,1693,95,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name",37843,"select d.date_id, d.make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales as d group by 1, 2",37843,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1022,1693,106,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name",37843,"select date_id as date_id, make_name as make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by 1, 2",37843,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1023,1693,153,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name 
ORDER BY date_id DESC",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by date_id, make_name order by date_id desc",37843,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1024,1693,175,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name 
ORDER BY make_name DESC, date_id",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by date_id, make_name order by make_name desc",37843,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1025,1693,191,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name 
ORDER BY date_id, make_name;",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by date_id, make_name order by date_id, make_name",37843,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1026,1693,192,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name 
ORDER BY date_id DESC, make_name DESC",37843,"select date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by date_id, make_name order by date_id desc, make_name desc",37843,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1027,1693,195,Easy,"SELECT date_id, make_name, 
       COUNT(DISTINCT lead_id) AS unique_leads, 
       COUNT(DISTINCT partner_id) AS unique_partners 
FROM schema_1693.dailysales 
GROUP BY date_id, make_name 
ORDER BY make_name",37843,"select distinct date_id, make_name, count(distinct lead_id) as unique_leads, count(distinct partner_id) as unique_partners from schema_1693.dailysales group by date_id, make_name order by make_name",37843,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1028,1729,1,Easy,"SELECT user_id, COUNT(follower_id) AS followers_count 
FROM schema_1729.followers 
GROUP BY user_id",3162,"select distinct user_id, count(follower_id) over (partition by user_id) as followers_count from schema_1729.followers",3162,0,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,"Equivalent query (Order mismatch, no ORDER BY in initial query)",Sorting problem
1029,1729,2,Easy,"SELECT user_id, COUNT(*) AS followers_count FROM schema_1729.followers GROUP BY user_id ORDER BY user_id",3162,"select distinct user_id, count(user_id) as followers_count from schema_1729.followers group by user_id order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1030,1729,3,Easy,"SELECT user_id, COUNT(*) AS followers_count FROM schema_1729.followers GROUP BY user_id ORDER BY user_id",3162,"select user_id as user_id, count(follower_id) as followers_count from schema_1729.followers group by user_id order by user_id asc",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1031,1729,5,Easy,"SELECT user_id, COUNT(*) AS followers_count 
FROM (SELECT DISTINCT user_id, follower_id FROM schema_1729.followers) AS distinct_followers 
GROUP BY user_id",3162,"select user_id, count(distinct follower_id) as followers_count from schema_1729.followers group by user_id",3162,0,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,"Equivalent query (Order mismatch, no ORDER BY in initial query)",Sorting problem
1032,1729,6,Easy,"SELECT user_id, COUNT(follower_id) AS followers_count 
FROM schema_1729.followers 
GROUP BY user_id;",3162,"select f1.user_id, count(distinct f1.follower_id) as followers_count from schema_1729.followers as f1 join schema_1729.followers as f2 on f1.user_id = f2.user_id group by f1.user_id",3162,0,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,"Equivalent query (Order mismatch, no ORDER BY in initial query)",Sorting problem
1033,1729,7,Easy,"SELECT user_id, COUNT(*) AS followers_count FROM schema_1729.followers GROUP BY user_id ORDER BY user_id ASC",3162,"select user_id, count(follower_id) as followers_count from schema_1729.followers group by user_id order by user_id asc",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1034,1729,17,Easy,"SELECT user_id, COUNT(*) AS followers_count 
FROM (SELECT DISTINCT user_id, follower_id FROM schema_1729.followers) AS distinct_followers 
GROUP BY user_id;",3162,"select user_id, count(distinct follower_id) as followers_count from schema_1729.followers group by 1",3162,0,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,"Equivalent query (Order mismatch, no ORDER BY in initial query)",Sorting problem
1035,1729,21,Easy,"SELECT user_id, COUNT(*) AS followers_count 
FROM (SELECT DISTINCT user_id, follower_id FROM schema_1729.followers) AS distinct_followers 
GROUP BY user_id 
ORDER BY user_id",3162,"select user_id, count(distinct follower_id) as followers_count from schema_1729.followers group by user_id order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1036,1729,28,Easy,"SELECT user_id, COUNT(*) AS followers_count FROM schema_1729.followers GROUP BY user_id ORDER BY user_id",3162,"select user_id, count(follower_id) as followers_count from schema_1729.followers group by user_id order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1037,1729,34,Easy,"SELECT user_id, COUNT(*) AS followers_count FROM schema_1729.followers GROUP BY user_id ORDER BY user_id",3162,"select user_id, count(follower_id) as followers_count from schema_1729.followers as f1 group by user_id order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1038,1729,36,Easy,"SELECT user_id, COUNT(*) AS followers_count FROM schema_1729.followers GROUP BY user_id ORDER BY user_id",3162,"select user_id, count(follower_id) as followers_count from schema_1729.followers group by 1 order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1039,1729,42,Easy,"SELECT user_id, COUNT(*) AS followers_count 
FROM schema_1729.followers 
GROUP BY user_id 
ORDER BY user_id ASC;",3162,"select user_id, count(user_id) as followers_count from schema_1729.followers group by user_id order by user_id asc",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1040,1729,50,Easy,"SELECT user_id, COUNT(*) AS followers_count 
FROM (SELECT DISTINCT user_id, follower_id FROM schema_1729.followers) AS distinct_followers 
GROUP BY user_id 
ORDER BY user_id",3162,"select user_id, count(distinct follower_id) as followers_count from schema_1729.followers group by 1 order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1041,1729,60,Easy,"SELECT user_id, COUNT(*) AS followers_count FROM schema_1729.followers GROUP BY user_id ORDER BY user_id",3162,"select user_id, count(user_id) as followers_count from schema_1729.followers group by user_id order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1042,1729,66,Easy,"SELECT user_id, COUNT(follower_id) AS followers_count 
FROM schema_1729.followers 
GROUP BY user_id 
ORDER BY user_id",3162,"select distinct user_id, count(follower_id) as followers_count from schema_1729.followers group by user_id order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1043,1729,80,Easy,"SELECT user_id, COUNT(follower_id) AS followers_count 
FROM schema_1729.followers 
GROUP BY user_id 
ORDER BY user_id",3162,"select a.user_id, count(b.user_id) as followers_count from schema_1729.followers as a left outer join (select distinct user_id from schema_1729.followers) as b on a.user_id = b.user_id group by a.user_id order by a.user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1044,1729,83,Easy,"SELECT user_id, COUNT(follower_id) AS followers_count 
FROM schema_1729.followers 
GROUP BY user_id 
ORDER BY user_id",3162,"select distinct user_id, count(distinct follower_id) as followers_count from schema_1729.followers group by user_id order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1045,1729,84,Easy,"SELECT user_id, COUNT(follower_id) AS followers_count 
FROM schema_1729.followers 
GROUP BY user_id;",3162,"select distinct user_id, count(distinct follower_id) as followers_count from schema_1729.followers group by 1",3162,0,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,"Equivalent query (Order mismatch, no ORDER BY in initial query)",Sorting problem
1046,1729,91,Easy,"SELECT user_id, COUNT(follower_id) AS followers_count 
FROM schema_1729.followers 
GROUP BY user_id 
ORDER BY user_id;",3162,"select distinct user_id, count(follower_id) over (partition by user_id) as followers_count from schema_1729.followers order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1047,1729,94,Easy,"SELECT user_id, COUNT(*) AS followers_count FROM schema_1729.followers GROUP BY user_id ORDER BY user_id",3162,"select f.user_id, count(follower_id) as followers_count from schema_1729.followers as f group by user_id order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1048,1729,97,Easy,"SELECT user_id, COUNT(*) AS followers_count 
FROM (SELECT DISTINCT user_id, follower_id FROM schema_1729.followers) AS distinct_followers 
GROUP BY user_id",3162,"select user_id, count(distinct follower_id) as followers_count from schema_1729.followers as user_id group by user_id",3162,0,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,"Equivalent query (Order mismatch, no ORDER BY in initial query)",Sorting problem
1049,1729,116,Easy,"SELECT user_id, COUNT(*) AS followers_count 
FROM (SELECT DISTINCT user_id, follower_id FROM schema_1729.followers) AS distinct_followers 
GROUP BY user_id 
ORDER BY user_id;",3162,"select user_id, count(distinct follower_id) as followers_count from schema_1729.followers as f group by user_id order by user_id",3162,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1050,1757,1,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,select distinct product_id from schema_1757.products where (low_fats = 'Y' and recyclable = 'Y'),24802,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1051,1757,3,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,select product_id from schema_1757.products where (low_fats = 'Y' and recyclable = 'Y'),24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1052,1757,6,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,select p.product_id from schema_1757.products as p where (p.low_fats = 'Y' and p.recyclable = 'Y'),24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1053,1757,11,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,select product_id from schema_1757.products as p where (p.low_fats = 'Y' and p.recyclable = 'Y'),24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1054,1757,12,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,select product_id from schema_1757.products as prod where (prod.low_fats = 'Y' and prod.recyclable = 'Y'),24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1055,1757,22,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y' ORDER BY product_id,24802,select product_id from schema_1757.products where (low_fats = 'Y' and recyclable = 'Y') order by product_id,24802,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1056,1757,34,Easy,SELECT product_id FROM schema_1757.products WHERE recyclable = 'Y' AND low_fats = 'Y',24802,select product_id from schema_1757.products where (recyclable = 'Y' and low_fats = 'Y'),24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1057,1757,69,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,select product_id from schema_1757.products as p where (low_fats = 'Y' and recyclable = 'Y'),24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1058,1757,75,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y' ORDER BY product_id DESC,24802,select product_id from schema_1757.products where (low_fats = 'Y' and recyclable = 'Y') order by product_id desc,24802,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1059,1757,87,Easy,SELECT product_id FROM schema_1757.products WHERE recyclable = 'Y' AND low_fats = 'Y',24802,select p.product_id from schema_1757.products as p where (p.recyclable = 'Y' and p.low_fats = 'Y'),24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1060,1757,91,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,select product_id from schema_1757.products where (products.low_fats = 'Y' and products.recyclable = 'Y'),24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1061,1757,94,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,select product_id from schema_1757.products where (low_fats = 'Y' and recyclable = 'Y') group by product_id,24802,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1062,1757,98,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y' ORDER BY product_id,24802,select product_id from schema_1757.products where (low_fats = 'Y' and recyclable = 'Y') order by product_id asc,24802,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1063,1757,122,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,select product_id from schema_1757.products as item where (item.low_fats = 'Y' and item.recyclable = 'Y'),24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1064,1757,125,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,select product_id from schema_1757.products where (1 = 1 and low_fats = 'Y' and recyclable = 'Y'),24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1065,1757,136,Easy,SELECT product_id FROM schema_1757.products WHERE low_fats = 'Y' AND recyclable = 'Y',24802,"select r.product_id from (select product_id, low_fats from schema_1757.products as p1 where recyclable = 'Y') as r where r.low_fats = 'Y'",24802,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1066,1777,2,Easy,"SELECT 
    product_id,
    MAX(CASE WHEN store = 'store1' THEN price END) AS store1,
    MAX(CASE WHEN store = 'store2' THEN price END) AS store2,
    MAX(CASE WHEN store = 'store3' THEN price END) AS store3
FROM 
    schema_1777.products
GROUP BY 
    product_id;",48130,"select distinct p.product_id, a.price as store1, b.price as store2, c.price as store3 from schema_1777.products as p left outer join (select product_id, price from schema_1777.products where store = 'store1') as a on p.product_id = a.product_id left outer join (select product_id, price from schema_1777.products where store = 'store2') as b on b.product_id = p.product_id left outer join (select product_id, price from schema_1777.products where store = 'store3') as c on c.product_id = p.product_id",48130,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1067,1777,6,Easy,"SELECT 
    product_id,
    MAX(CASE WHEN store = 'store1' THEN price END) AS store1,
    MAX(CASE WHEN store = 'store2' THEN price END) AS store2,
    MAX(CASE WHEN store = 'store3' THEN price END) AS store3
FROM 
    schema_1777.products
GROUP BY 
    product_id;",48130,"select p.product_id, store1, store2, store3 from (select distinct product_id from schema_1777.products) as p left outer join (select product_id, price as store1 from schema_1777.products where store = 'store1') as t1 on p.product_id = t1.product_id left outer join (select product_id, price as store2 from schema_1777.products where store = 'store2') as t2 on p.product_id = t2.product_id left outer join (select product_id, price as store3 from schema_1777.products where store = 'store3') as t3 on p.product_id = t3.product_id",48130,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1068,1777,8,Easy,"SELECT 
    product_id,
    MAX(CASE WHEN store = 'store1' THEN price END) AS store1,
    MAX(CASE WHEN store = 'store2' THEN price END) AS store2,
    MAX(CASE WHEN store = 'store3' THEN price END) AS store3
FROM 
    schema_1777.products
GROUP BY 
    product_id",48130,"select distinct a.product_id, b.store1, c.store2, d.store3 from schema_1777.products as a left outer join (select product_id, price as store1 from schema_1777.products where store = 'store1') as b on a.product_id = b.product_id left outer join (select product_id, price as store2 from schema_1777.products where store = 'store2') as c on a.product_id = c.product_id left outer join (select product_id, price as store3 from schema_1777.products where store = 'store3') as d on a.product_id = d.product_id",48130,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1069,1777,81,Easy,"SELECT 
    p.product_id,
    MAX(CASE WHEN p.store = 'store1' THEN p.price END) AS store1,
    MAX(CASE WHEN p.store = 'store2' THEN p.price END) AS store2,
    MAX(CASE WHEN p.store = 'store3' THEN p.price END) AS store3
FROM 
    schema_1777.products p
GROUP BY 
    p.product_id;",48130,"select temp.product_id as product_id, temp1.store1 as store1, temp2.store2 as store2, temp3.store3 as store3 from (select distinct product_id from schema_1777.products) as temp left outer join (select product_id, price as store1 from schema_1777.products where store = 'store1') as temp1 on temp.product_id = temp1.product_id left outer join (select product_id, price as store2 from schema_1777.products where store = 'store2') as temp2 on temp.product_id = temp2.product_id left outer join (select product_id, price as store3 from schema_1777.products where store = 'store3') as temp3 on temp.product_id = temp3.product_id",48130,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1070,1777,102,Easy,"SELECT 
    p.product_id,
    MAX(CASE WHEN p.store = 'store1' THEN p.price END) AS store1,
    MAX(CASE WHEN p.store = 'store2' THEN p.price END) AS store2,
    MAX(CASE WHEN p.store = 'store3' THEN p.price END) AS store3
FROM 
    schema_1777.products p
GROUP BY 
    p.product_id",48130,"select a.product_id, b.price as store1, c.price as store2, d.price as store3 from schema_1777.products as a left outer join schema_1777.products as b on (a.product_id = b.product_id and b.store = 'store1') left outer join schema_1777.products as c on (a.product_id = c.product_id and c.store = 'store2') left outer join schema_1777.products as d on (a.product_id = d.product_id and d.store = 'store3') group by 1, 2, 3, 4",48130,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1071,1777,105,Easy,"SELECT 
    p.product_id,
    MAX(CASE WHEN p1.store = 'store1' THEN p1.price END) AS store1,
    MAX(CASE WHEN p2.store = 'store2' THEN p2.price END) AS store2,
    MAX(CASE WHEN p3.store = 'store3' THEN p3.price END) AS store3
FROM 
    schema_1777.products p
LEFT JOIN 
    schema_1777.products p1 ON p.product_id = p1.product_id AND p1.store = 'store1'
LEFT JOIN 
    schema_1777.products p2 ON p.product_id = p2.product_id AND p2.store = 'store2'
LEFT JOIN 
    schema_1777.products p3 ON p.product_id = p3.product_id AND p3.store = 'store3'
GROUP BY 
    p.product_id",48130,"select distinct p.product_id, p1.price as store1, p2.price as store2, p3.price as store3 from schema_1777.products as p left outer join schema_1777.products as p1 on (p.product_id = p1.product_id and p1.store = 'store1') left outer join schema_1777.products as p2 on (p.product_id = p2.product_id and p2.store = 'store2') left outer join schema_1777.products as p3 on (p.product_id = p3.product_id and p3.store = 'store3')",48130,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1072,1777,106,Easy,"SELECT 
    product_id,
    MAX(CASE WHEN store = 'store1' THEN price END) AS store1,
    MAX(CASE WHEN store = 'store2' THEN price END) AS store2,
    MAX(CASE WHEN store = 'store3' THEN price END) AS store3
FROM 
    schema_1777.products
GROUP BY 
    product_id",48130,"select distinct p.product_id, store1, store2, store3 from schema_1777.products as p left outer join (select product_id, price as store1 from schema_1777.products where store = 'store1') as s1 on p.product_id = s1.product_id left outer join (select product_id, price as store2 from schema_1777.products where store = 'store2') as s2 on p.product_id = s2.product_id left outer join (select product_id, price as store3 from schema_1777.products where store = 'store3') as s3 on p.product_id = s3.product_id",48130,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1073,1777,107,Easy,"SELECT 
    p.product_id,
    MAX(CASE WHEN p.store = 'store1' THEN p.price END) AS store1,
    MAX(CASE WHEN p.store = 'store2' THEN p.price END) AS store2,
    MAX(CASE WHEN p.store = 'store3' THEN p.price END) AS store3
FROM 
    schema_1777.products p
GROUP BY 
    p.product_id;",48130,"select distinct p.product_id, t1.price as store1, t2.price as store2, t3.price as store3 from schema_1777.products as p left outer join (select product_id, price from schema_1777.products where store = 'store1') as t1 on p.product_id = t1.product_id left outer join (select product_id, price from schema_1777.products where store = 'store2') as t2 on p.product_id = t2.product_id left outer join (select product_id, price from schema_1777.products where store = 'store3') as t3 on p.product_id = t3.product_id",48130,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1074,1777,113,Easy,"SELECT 
    product_id,
    MAX(CASE WHEN store = 'store1' THEN price END) AS store1,
    MAX(CASE WHEN store = 'store2' THEN price END) AS store2,
    MAX(CASE WHEN store = 'store3' THEN price END) AS store3
FROM schema_1777.products
GROUP BY product_id",48130,"select distinct x.product_id, a.store1, b.store2, c.store3 from schema_1777.products as x left outer join (select product_id, price as store1 from schema_1777.products where store = 'store1') as a on x.product_id = a.product_id left outer join (select product_id, price as store2 from schema_1777.products where store = 'store2') as b on x.product_id = b.product_id left outer join (select product_id, price as store3 from schema_1777.products where store = 'store3') as c on x.product_id = c.product_id",48130,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1075,1777,225,Easy,"SELECT 
    p.product_id,
    MAX(CASE WHEN p.store = 'store1' THEN p.price END) AS store1,
    MAX(CASE WHEN p.store = 'store2' THEN p.price END) AS store2,
    MAX(CASE WHEN p.store = 'store3' THEN p.price END) AS store3
FROM 
    schema_1777.products p
GROUP BY 
    p.product_id;",48130,"select s0.product_id, s1.price as store1, s2.price as store2, s3.price as store3 from (select distinct product_id from schema_1777.products) as s0 left outer join schema_1777.products as s1 on (s0.product_id = s1.product_id and s1.store = 'store1') left outer join schema_1777.products as s2 on (s0.product_id = s2.product_id and s2.store = 'store2') left outer join schema_1777.products as s3 on (s0.product_id = s3.product_id and s3.store = 'store3')",48130,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1076,1821,1,Easy,"SELECT customer_id 
FROM schema_1821.customers 
WHERE year = 2021 
GROUP BY customer_id 
HAVING SUM(revenue) > 0",2116,"select a.customer_id from (select customer_id, year, sum(revenue) as total from schema_1821.customers group by customer_id, year) as a where (year = '2021' and total > 0)",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1077,1821,2,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where (year = 2021 and revenue > 0),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1078,1821,3,Easy,SELECT DISTINCT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where (year = 2021 and revenue > 0) group by customer_id,2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1079,1821,4,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING sum(revenue) > 0,2116,select customer_id from schema_1821.customers where year = '2021' group by 1 having sum(revenue) > 0,2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1080,1821,6,Easy,SELECT customer_id FROM schema_1821.customers WHERE revenue > 0 AND year = 2021 GROUP BY customer_id,2116,select distinct customer_id from schema_1821.customers where (revenue > 0 and year = 2021),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1081,1821,10,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0 GROUP BY customer_id,2116,select distinct customer_id from schema_1821.customers where (year = '2021' and revenue > 0),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1082,1821,11,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0 GROUP BY customer_id,2116,select distinct customer_id from schema_1821.customers where (year = 2021 and revenue > 0),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1083,1821,16,Easy,SELECT c.customer_id FROM schema_1821.customers c WHERE c.year = 2021 AND c.revenue > 0,2116,select c.customer_id from schema_1821.customers as c where (c.year = 2021 and c.revenue > 0),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1084,1821,17,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,select customer_id from schema_1821.customers as c where c.year = 2021 group by customer_id having sum(revenue) > 0,2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1085,1821,21,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where (1 = 1 and year = 2021 and revenue > 0),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1086,1821,22,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = '2021' AND revenue > 0 GROUP BY customer_id,2116,select customer_id from schema_1821.customers where year = '2021' group by customer_id having sum(revenue) > 0,2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1087,1821,26,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = '2021' AND revenue > 0,2116,select customer_id from schema_1821.customers where (revenue > 0 and year = '2021'),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1088,1821,27,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where (revenue > 0 and year = 2021),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1089,1821,28,Easy,SELECT DISTINCT customer_id FROM schema_1821.customers WHERE revenue > 0 AND year = 2021,2116,select customer_id from schema_1821.customers where (revenue > 0 and year = 2021) group by customer_id,2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1090,1821,35,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where (year = '2021' and revenue > 0),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1091,1821,41,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = '2021' GROUP BY customer_id HAVING sum(revenue) > 0,2116,"select customer_id from schema_1821.customers where year = '2021' group by customer_id, year having sum(revenue) > 0",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1092,1821,47,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,select customer_id from schema_1821.customers where year = 2021 group by customer_id having sum(revenue) > 0,2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1093,1821,49,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING sum(revenue) > 0,2116,"select customer_id from schema_1821.customers where year = 2021 group by customer_id, year having sum(revenue) > 0",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1094,1821,52,Easy,SELECT DISTINCT customer_id FROM schema_1821.customers WHERE year = '2021' AND revenue > 0,2116,select customer_id from schema_1821.customers where year = '2021' group by customer_id having max(revenue) > 0,2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1095,1821,53,Easy,SELECT DISTINCT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where year = '2021' group by customer_id having min(revenue) > 0,2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1096,1821,60,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,select customer_id from schema_1821.customers as c where c.year = 2021 group by 1 having sum(c.revenue) > 0,2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1097,1821,66,Easy,SELECT customer_id FROM schema_1821.customers WHERE revenue > 0 AND year = 2021 ORDER BY customer_id,2116,select customer_id from schema_1821.customers where (revenue > 0 and year = '2021') order by customer_id,2116,0,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,Equivalent query,
1098,1821,71,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0 GROUP BY customer_id,2116,select customer_id from schema_1821.customers where year = 2021 group by 1 having sum(revenue) > 0,2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1099,1821,80,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = '2021' GROUP BY customer_id HAVING SUM(revenue) > 0,2116,"select t.customer_id from (select customer_id, sum(revenue) as revenue from schema_1821.customers where year = '2021' group by customer_id) as t where t.revenue > 0",2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1100,1821,81,Easy,"SELECT customer_id 
FROM schema_1821.customers 
WHERE year = 2021 
GROUP BY customer_id 
HAVING SUM(revenue) > 0;",2116,"select temp.customer_id from (select customer_id, year, sum(revenue) as revenue_sum from schema_1821.customers group by customer_id, year) as temp where (temp.revenue_sum > 0 and year = 2021)",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1101,1821,83,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = '2021' AND revenue > 0,2116,select customer_id from schema_1821.customers where (customers.revenue > 0 and customers.year = '2021'),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1102,1821,89,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where (year = '2021' and revenue > 0) group by customer_id,2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1103,1821,94,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 1,1972,select customer_id from schema_1821.customers where (year = 2021 and revenue > 1),1972,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1104,1821,96,Easy,SELECT customer_id FROM schema_1821.customers WHERE revenue > 0 AND year = 2021,2116,"select customer_id from (select customer_id, year, revenue from schema_1821.customers where (revenue > 0 and year = 2021)) as a",2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1105,1821,98,Easy,SELECT customer_id FROM schema_1821.customers WHERE revenue > 0 AND year = 2021 GROUP BY customer_id,2116,select distinct customer_id from schema_1821.customers where (revenue > 0 and year = '2021'),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1106,1821,106,Easy,"SELECT customer_id 
FROM schema_1821.customers 
WHERE year = 2021 
GROUP BY customer_id 
HAVING SUM(revenue) > 0",2116,select c1.customer_id from schema_1821.customers as c1 join schema_1821.customers as c2 on c1.customer_id = c2.customer_id where c1.year = 2021 group by c1.customer_id having sum(c1.revenue) > 0,2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1107,1821,109,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,"select customer_id from (select customer_id, sum(revenue) as sum from schema_1821.customers where year = 2021 group by customer_id) as a where sum > 0",2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1108,1821,110,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,"select customer_id from (select customer_id, sum(revenue) as total_rev from schema_1821.customers where year = 2021 group by customer_id) as tmp where total_rev > 0",2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1109,1821,113,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,"select customer_id from (select customer_id, revenue from schema_1821.customers where year = 2021) as t group by customer_id having sum(revenue) > 0",2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1110,1821,114,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,"select customer_id from (select customer_id, sum(revenue) as total from schema_1821.customers where year = 2021 group by customer_id) as temp where total > 0",2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1111,1821,116,Easy,"SELECT DISTINCT customer_id 
FROM schema_1821.customers 
WHERE year = 2021 AND revenue > 0",2116,"select customer_id from (select customer_id, sum(revenue) over (partition by customer_id order by year desc) as revenue from schema_1821.customers where (year = '2021' and revenue > 0)) as i",2116,0,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,Equivalent query,
1112,1821,117,Easy,"SELECT customer_id 
FROM schema_1821.customers 
WHERE year = 2021 
GROUP BY customer_id 
HAVING SUM(revenue) > 0;",2116,"select customer_id from (select customer_id, sum(revenue) over (partition by customer_id, year) as s_rev from schema_1821.customers where year = 2021) as a where s_rev > 0",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1113,1821,118,Easy,"SELECT customer_id 
FROM schema_1821.customers 
WHERE year = 2021 
GROUP BY customer_id 
HAVING SUM(revenue) > 0",2116,"select customer_id from (select customer_id, sum(revenue) over (partition by customer_id) as rnk from schema_1821.customers where year = 2021) as tmp where tmp.rnk > 0",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1114,1821,119,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,select customer_id from schema_1821.customers as c where c.year = 2021 group by c.customer_id having sum(revenue) > 0,2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1115,1821,121,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING sum(revenue) > 0,2116,"select customer_id from schema_1821.customers as c group by customer_id, year having (year = 2021 and sum(revenue) > 0)",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1116,1821,122,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING sum(revenue) > 0,2116,"select customer_id from schema_1821.customers group by customer_id, year having (sum(revenue) > 0 and year = '2021')",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1117,1821,123,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING sum(revenue) > 0,2116,"select customer_id from schema_1821.customers group by customer_id, year having (sum(revenue) > 0 and year = 2021)",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1118,1821,124,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING sum(revenue) > 0,2116,"select customer_id from schema_1821.customers group by customer_id, year having (year = 2021 and sum(revenue) > 0)",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1119,1821,126,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where (customers.year = '2021' and revenue > 0),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1120,1821,137,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where (year = '2021' and revenue > '0'),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1121,1821,145,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where (year = 2021 and customers.revenue > 0),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1122,1821,149,Easy,SELECT DISTINCT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers where (year = 2021 and revenue > 0) group by 1,2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1123,1821,168,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 AND revenue > 0,2116,select customer_id from schema_1821.customers as c1 where (c1.revenue > 0 and c1.year = 2021),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1124,1821,170,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING sum(revenue) > 0,2116,select customer_id from schema_1821.customers where customers.year = '2021' group by customer_id having sum(revenue) > 0,2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1125,1821,206,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,"select customer_id from (select customer_id, sum(revenue) as profit from schema_1821.customers where year = 2021 group by customer_id) as a where profit > 0",2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1126,1821,207,Easy,"SELECT customer_id 
FROM schema_1821.customers 
WHERE year = 2021 
GROUP BY customer_id 
HAVING SUM(revenue) > 0",2116,"select customer_id from (select customer_id, sum(revenue) over (partition by customer_id) as r from schema_1821.customers where year = 2021) as tmp where r > 0",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1127,1821,208,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,"select distinct customer_id from (select customer_id, sum(revenue) as revenue from schema_1821.customers where year = 2021 group by customer_id) as a where revenue > 0",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1128,1821,209,Easy,SELECT customer_id FROM schema_1821.customers WHERE revenue > 0 AND year = 2021 GROUP BY customer_id,2116,select distinct customer_id from schema_1821.customers as c where (c.revenue > 0 and year = 2021),2116,0,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1129,1821,215,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = '2021' GROUP BY customer_id HAVING SUM(revenue) > 0,2116,"select distinct customer_id from schema_1821.customers where year = '2021' group by customer_id, revenue having sum(revenue) > 0",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1130,1821,217,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING sum(revenue) > 0,2116,"select distinct customer_id from schema_1821.customers where year = 2021 group by customer_id, year having sum(revenue) > 0",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
1131,1821,228,Easy,SELECT customer_id FROM schema_1821.customers WHERE year = 2021 GROUP BY customer_id HAVING SUM(revenue) > 0,2116,"select distinct temp.customer_id from (select customer_id, year, sum(revenue) as rev_2021 from schema_1821.customers where year = '2021' group by 1, 2) as temp where temp.rev_2021 > 0",2116,0,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,Equivalent query,
